var QUESTION_TYPE_SINGLE=2;var QUESTION_TYPE_MULTIPLE=3;var QUESTION_TYPE_MATRIX_SINGLE=4;var QUESTION_TYPE_MATRIX_MULTIPLE=5;var QUESTION_TYPE_BLANK=6;var QUESTION_TYPE_MATRIX_SCORE=7;var QUESTION_TYPE_BLANK_DROPDOWN=8;var QUESTION_TYPE_SCORE=50;var QUESTION_TYPE_ORDER=60;var QUESTION_TYPE_DESC=70;var QUESTION_TYPE_MULTIPLE_BLANK=95;var QUESTION_TYPE_MATRIX_BLANK=100;var DISP_TYPE_GEOGRAPHICAL='geographical_multiple_blank';var PROJECT_STATUS_CREATED=0;var PROJECT_STATUS_ACTIVATED=1;var PROJECT_STATUS_PAUSED=3;var PROJECT_STATUS_FINISHED=2;var PROJECT_STATUS_DELETED=-2;var PROJECT_STATUS_DELETED_FOREVER=-1;var CONDITION_RELATION_AND=1;var CONDITION_RELATION_OR=2;var CONDITION_OPERATION_TYPE_SELECTED=1;var CONDITION_OPERATION_TYPE_UNSELECTED=2;var CONDITION_OPERATION_TYPE_DISPLAYED=3;var CONDITION_OPERATION_TYPE_NOTDISPLAYED=4;var MOBILE_AUTH_QUESTION_STATUS_NORMAL=1;var MOBILE_AUTH_QUESTION_STATUS_NO_QUOTA=2;var MOBILE_AUTH_QUESTION_STATUS_NEED_GEETEST=3;if(!Array.indexOf)Array.prototype.indexOf=function(obj){for(var i=0;i<this.length;i++)if(this[i]==obj)return i;return -1;};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"");};Array.prototype.shuffle=function(){for(var j,x,i=this.length;i;j=parseInt(Math.random()*i),x=this[--i],this[i]=this[j],this[j]=x);return this;};Array.prototype.sum=function(){var sum=0;for(var i=0;i<this.length;i++)sum+=this[i];;return sum;};String.prototype.strip=function(){return this.replace(/^\s*(.*?)\s*$/,"$1");};function isNotEmpty(obj){if(typeof obj=="undefined"||null==obj)return false;if(typeof obj=="function")return true;if(obj.constructor==Number)if(obj)return true;else return false;else if(typeof obj=="string")if(obj!="")return true;else return false;else{for(var prop in obj)if(obj.hasOwnProperty(prop))return true;return false;}};Overload=function(fn_objs){var is_match=function(x,y){if(x==y)return true;if(x.indexOf("*")==-1)return false;var x_arr=x.split(","),y_arr=y.split(",");if(x_arr.length!=y_arr.length)return false;while(x_arr.length){var x_first=x_arr.shift(),y_first=y_arr.shift();if(x_first!="*"&&x_first!=y_first)return false;}return true;};var ret=function(){var args=arguments,args_len=args.length,args_types=[],args_type,fn_objs=args.callee._fn_objs,match_fn=function(){};for(var i=0;i<args_len;i++){var type=typeof args[i];type=="object"&&(args[i].length>-1)&&(type="array");args_types.push(type);}args_type=args_types.join(",");for(var k in fn_objs)if(is_match(k,args_type)){match_fn=fn_objs[k];break;}return match_fn.apply(this,args);};ret._fn_objs=fn_objs;return ret;};String.prototype.format=Overload({"array":function(params){var reg=/{(\d+)}/gm;return this.replace(reg,function(match,name){return params[~~name];});},"object":function(param){var reg=/{([^{}]+)}/gm;return this.replace(reg,function(match,name){return param[name];});}});function load_path(path){if(!path||path.length===0)throw new Error('argument "path" is required !');var head=document.getElementsByTagName('head')[0];var script=document.createElement('script');script.src=path;script.type='text/javascript';head.appendChild(script);}function check_in(obj,seq){return $.inArray(obj,seq)!=-1;}function is_equal(obj1,obj2){if(obj1.constructor!==obj2.constructor)return false;var aMemberCount=0;for(var a in obj1){if(!obj1.hasOwnProperty(a))continue;if(typeof obj1[a]==='object'&&typeof obj2[a]==='object'?!obj1[a].equals(obj2[a]):obj1[a]!==obj2[a])return false;++aMemberCount;}for(var a in obj2)if(obj2.hasOwnProperty(a))--aMemberCount;return aMemberCount?false:true;}function copy_obj(obj){if(obj.constructor==Array){var new_obj_list=[];for(var i=0;i<obj.length;i++){var item=obj[i];new_obj_list.push(copy_obj(item));}return new_obj_list;}else if(obj.constructor==Number||obj.constructor==String){var num=obj;return num;}else return $.extend(true,{},obj);};function get_parent(obj,parent_type){var $parent=$(obj).parent();while($parent.length>0&&$parent[0].nodeName!=parent_type.toUpperCase())$parent=$parent.parent();return $parent;}function ajaxGet(obj){var url=$(obj).attr("href");var target=$(obj).attr("rel");$.ajax({url:url,type:"GET",success:function(html_code){$("#"+target).html(html_code);}});}function ajaxPost(url,data,callback,fail_callback){var secure_key=$.cookie("_xsrf")||"";if(isNotEmpty(secure_key))data._xsrf=secure_key;var is_edit=url.indexOf("edit/ajax")!=-1?true:false;if(is_edit)if(typeof client_uuid!=="undefined"){loadMack({off:'on',Limg:1,text:'加载中...',set:0});data.client_uuid=client_uuid;SavePrompt();}isNotEmpty(fail_callback)?fail_callback=fail_callback:fail_callback=function(){};$.ajax({url:url,data:data,dataType:"JSON",type:"POST",timeout:60000,error:fail_callback,success:function(ret){if(ret.status=="200"){if(ret.hasOwnProperty("edit_valid"))if(!ret.edit_valid){edit_lock_alert();return;}if(isNotEmpty(callback))callback(ret);if(is_edit&&!ret.err_msg){SavePrompt(true);$('.loadCon,.loadMack').remove();}}}});}function syncPost(url,data,callback){var secure_key=$.cookie("_xsrf");if(isNotEmpty(secure_key))data._xsrf=secure_key;var is_edit=url.indexOf("edit/ajax")!=-1?true:false;if(is_edit){data.client_uuid=client_uuid;SavePrompt();}$.ajax({url:url,data:data,dataType:"JSON",type:"POST",async:false,success:function(ret){if(ret.status=="200"){if(ret.hasOwnProperty("edit_valid"))if(!ret.edit_valid){edit_lock_alert();return;}if(isNotEmpty(callback))callback(ret);}if(is_edit)SavePrompt(true);}});}function ajaxSubmit(obj){var url=$(obj).attr("action")||window.location.href;var callback_name=$(obj).attr("callback");var callback=null;eval("callback = "+callback_name+"");var data={};$.map($(obj).serializeArray(),function(item){data[item.name]=item.value;});$.ajax({url:url,type:"POST",data:data,dataType:"JSON",success:function(ret){if(ret.status=="200"){if(isNotEmpty(callback))callback(ret);}else if(ret.status==null)alert("status is not defined in server response!");}});}function ajaxGetSubmit(obj){var url=$(obj).attr("action")||window.location.href;var callback_name=$(obj).attr("callback");var callback=null;eval("callback = "+callback_name+"");var data={};$.map($(obj).serializeArray(),function(item){data[item.name]=item.value;});$.ajax({url:url,type:"GET",data:data,dataType:"JSON",success:function(ret){if(ret.status=="200"){if(isNotEmpty(callback))callback(ret);}else if(ret.status==null)alert("status is not defined in server response!");}});}function get_oid(obj){if(obj.hasOwnProperty("_id"))return obj._id.$oid;return "";}function set_active_head1(idx){$('.main-nav li:eq('+idx+')').addClass('active');}function set_active_head_v2(idx){$('.left_Menu li a').removeClass('active');$('.left_Menu li:eq('+idx+') a').addClass('active');}function scroll_to(obj){var is_iframe=(self.frameElement&&self.frameElement.tagName=="IFRAME")?true:false;var top=$(obj).offset().top;if(is_iframe)get_iframe_height(obj);else $('body, html').animate({scrollTop:top},'fast');}Array.prototype.remove=function(from,to){var rest=this.slice((to||from)+1||this.length);this.length=from<0?this.length+from:from;return this.push.apply(this,rest);};function jsConfirm(Obj){var onlyid=Obj.onlyid||"maptss";Tinfo={title:Obj.title||"提示",content:Obj.content||"<span style='color:#ef6262;'>确定要删除吗？</span>",conw:Obj.conw||300,obj:Obj.obj||false,Param:Obj.Param||'',obj_text:Obj.obj_text||'确定',close_obj:Obj.close_obj||false,close_Param:Obj.close_Param||'',close_text:Obj.close_text||'取消',is_zhifu:false};var qr='<div class="WJButton wj_blue tcQz">'+Tinfo.obj_text+'</div>';var qx='<div class="WJButton wj_blue uniteC">'+Tinfo.close_text+'</div>';var con='<div class="tccCon">'+'<div class="tccCon_t">'+Tinfo.content+'</div><div class="tccCon_a">'+qr+qx+'</div></div>';var wb=new jsbox({onlyid:onlyid,title:Tinfo.title,conw:Tinfo.conw,content:con,range:true,mack:true}).show();$('.tcQz').die().live('click',function(){var isReturn=Tinfo.obj(Tinfo.Param);if(isReturn==undefined||isReturn==null){$('.jsbox_close').click();setTimeout(function(){$('.zon_edit').remove();},100);}});$('.uniteC').one('click',function(){if(Tinfo.close_obj)Tinfo.close_obj(Tinfo.close_Param);$('.jsbox_close').click();});$('.jsbox_close').one('mousedown',function(){if(Tinfo.close_obj)Tinfo.close_obj(Tinfo.close_Param);$('.jsbox_close').click();return false;});}function jsCropConfirm(Obj){Tinfo={title:Obj.title||"提示",content:Obj.content||"确定要删除吗？",conw:Obj.conw||300,obj:Obj.obj||false,Param:Obj.Param||'',obj_text:Obj.obj_text||'确定',close_obj:Obj.close_obj||false,close_Param:Obj.close_Param||'',close_text:Obj.close_text||'取消'};var qr='<div class="WJButton wj_blue tcQz">'+Tinfo.obj_text+'</div>';var qx='<div class="WJButton wj_blue c_close">'+Tinfo.close_text+'</div>';var con='<div class="tccCon">'+'<div class="tccCon_t">'+Tinfo.content+'</div><div class="tccCon_a">'+qr+qx+'</div></div>';var wb=new jsbox({onlyid:"maptss",title:Tinfo.title,conw:Tinfo.conw,content:con,range:true,mack:true}).show();$('.tcQz').die().live('click',function(){var isReturn=Tinfo.obj(Tinfo.Param);if(isReturn==undefined||isReturn==null){$('.jsbox_close').click();setTimeout(function(){$('.zon_edit').remove();},100);}});$('.c_close').bind('click',function(){if(Tinfo.close_obj)Tinfo.close_obj(Tinfo.close_Param);$('.jsbox_close').click();});$('.jsbox_close').one('mousedown',function(){$('.jsbox_close').click();return false;});}function sleep(delay){var start=new Date().getTime();while(new Date().getTime()<start+delay);}if(!Array.prototype.filter)Array.prototype.filter=function(fun){"use strict";if(this==null)throw new TypeError();var t=Object(this);var len=t.length>>>0;if(typeof fun!="function")throw new TypeError();var res=[];var thisp=arguments[1];for(var i=0;i<len;i++)if(i in t){var val=t[i];if(fun.call(thisp,val,i,t))res.push(val);}return res;};Array.prototype.unique=function(){var n=[];for(var i=0;i<this.length;i++)if(n.indexOf(this[i])==-1)n.push(this[i]);return n;};function jsAlert(Obj){var onlyid=Obj.onlyid||"maptss";Tinfo={title:Obj.title||"提示",content:Obj.content||"确定要删除吗？",conw:Obj.conw||300,obj:Obj.obj||false,Param:Obj.Param||'',obj_text:Obj.obj_text||'确定'};var qr='<div class="WJButton wj_blue tcQz">'+Tinfo.obj_text+'</div>';var con='<div class="tccCon">'+'<div class="tccCon_t">'+Tinfo.content+'</div><div class="tccCon_a">'+qr+'</div></div>';var wb=new jsbox({onlyid:onlyid,title:Tinfo.title,conw:Tinfo.conw,content:con,Close:false,range:true,mack:true}).show();$('.tcQz').die().live('click',function(){if(Tinfo.obj){var isReturn=Tinfo.obj(Tinfo.Param);if(isReturn==undefined||isReturn==null)$('.jsbox_close','#'+onlyid).click();}else $('.jsbox_close','#'+onlyid).click();});}function NewMessage(off){if(off!==undefined){clearInterval(message);$('.NewMessage a').removeClass('xsa');return;}message=setInterval(function(){var Class=$('.NewMessage a').attr('class');if(Class=="")$('.NewMessage a').addClass('xsa');else $('.NewMessage a').removeClass('xsa');},800);}

eval(
function(p,a,c,k,e,d){e=function(c){return c.toString(36);};if(!''.replace(/^/,String)){while(c--)d[c.toString(a)]=k[c]||c.toString(a);k=[function(e){return d[e];}];e=function(){return '\\w+';};c=1;};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p;}('4 8(a,b){1 d,e,c="";5(d=0;d<a.7/b;d++)e=a.g(d*b),c+=e;3 c}4 h(9,6){1 f=k;3 i("f = j"+6),f(9)}4 l(a){1 c,b="";5(c=0;c<a.7;c++)b+=8(a[c],2);3 m(b)}',23,23,'|var||return|function|for|v|length|slice_str|sa|||||||charAt|et|eval|ef|null|ef1|hex_md5'.split('|'),0,{})
);

function InterceptString(str,length,length1){if(str.length>length){if(length1==0)length1=length;if(str.length>=length1){var str_left=str.substr(0,length1);var str_right=str.substr(length1);var banjiao=0;var quanjiao=0;var strCode;for(var i=0;i<str_left.length;i++){strCode=str.charCodeAt(i);if(strCode>=33&&strCode<=126)banjiao++;else quanjiao++;}if((quanjiao+banjiao/2)>length||(quanjiao+banjiao/2)-length==0.5){str_left=str_left.substr(0,str_left.length-1);return str_left;}else if((quanjiao+banjiao/2)-length!=0)if(length1+1<=str.length)str_left=InterceptString(str,length,length1+1);return str_left;}}}function getDaysInOneMonth(year,month){var d=new Date(year,month,0);return d.getDate();}var developer="CC,JJ,PP,SF";function get_iframe_height(obj){if(isNotEmpty(obj)&&obj==-2)var top=-2;else if(!isNotEmpty(obj))var top=-1;else var top=$(obj).offset().top;var body_height=$('body').height()+30;var postObj=body_height+","+top;if(typeof postMessage!='undefined')window.parent.postMessage(postObj,'*');}function Appload(Obj){var url=Obj.url||"/";if(url.indexOf('?')==-1)url=url+"?rd="+new Date().getTime();else url=url+"&rd="+new Date().getTime();var Tinfo={obj:Obj.obj||$('body'),url:url,data:Obj.data||"",limg:Obj.limg||false,callback:Obj.callback||function(){}};Tinfo.obj.load(Tinfo.url,Tinfo.data,function(){Tinfo.callback();});}function tabularize(arr,cols){var ret=[];for(var i=0;i<parseInt(arr.length/cols)+1;i++){var item=arr.slice(cols*i,cols*(i+1));if(item.length<cols)for(var k=0;k<(cols-item.length);k++)item.push(null);ret.push(item);}return ret;}String.prototype.replaceAll=function(stringToFind,stringToReplace){var temp=this;var index=temp.indexOf(stringToFind);while(index!=-1){temp=temp.replace(stringToFind,stringToReplace);index=temp.indexOf(stringToFind);}return temp;};function edit_lock_alert(){$('.loadCon,.loadMack').remove();jsConfirm({content:"问卷内容刚在其它浏览器窗口被修改， 是否重新加载进行编辑？",title:"提示",obj_text:"是",close_text:"否",obj:get_edit_lock,close_obj:close_window});}var split;split=split||function(undef){var nativeSplit=String.prototype.split,compliantExecNpcg=/()??/.exec("")[1]===undef,self;self=function(str,separator,limit){if(Object.prototype.toString.call(separator)!=="[object RegExp]")return nativeSplit.call(str,separator,limit);var output=[],flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.extended?"x":"")+(separator.sticky?"y":""),lastLastIndex=0,separator=new RegExp(separator.source,flags+"g"),separator2,match,lastIndex,lastLength;str+="";if(!compliantExecNpcg)separator2=new RegExp("^"+separator.source+"$(?!\\s)",flags);limit=limit===undef?-1>>>0:limit>>>0;while(match=separator.exec(str)){lastIndex=match.index+match[0].length;if(lastIndex>lastLastIndex){output.push(str.slice(lastLastIndex,match.index));if(!compliantExecNpcg&&match.length>1)match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++)if(arguments[i]===undef)match[i]=undef;});if(match.length>1&&match.index<str.length)Array.prototype.push.apply(output,match.slice(1));lastLength=match[0].length;lastLastIndex=lastIndex;if(output.length>=limit)break;}if(separator.lastIndex===match.index)separator.lastIndex++;}if(lastLastIndex===str.length){if(lastLength||!separator.test(""))output.push("");}else output.push(str.slice(lastLastIndex));return output.length>limit?output.slice(0,limit):output;};String.prototype.split=function(separator,limit){return self(this,separator,limit);};return self;}();function getQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null;}function SavePrompt(isOff,message){var message1='已实时保存';var message2='正实时保存';if(message)message1=message2=message;var Sav=$('.SavePrompt');if(!isOff)var isOff=false;if(isOff){$('.SavePrompt').text(message1);setTimeout(function(){Sav.fadeOut("slow");setTimeout(function(){Sav.remove();},600);},800);}else if(Sav.length<1&&!$('.jsbox').is(':visible'))$('body').append('<div class="SavePrompt">正实时保存</div>');}function file_upload_custom(f,obj,url,success_callback,fail_callback){if(!success_callback)success_callback=function(){};;if(!fail_callback)fail_callback=function(){};;var xhr=new XMLHttpRequest();xhr.open('POST',url,true);var formData;formData=new FormData();formData.append('file',f);for(var key in obj)formData.append(key,obj[key]);xhr.onreadystatechange=function(response){if(xhr.readyState==4&&xhr.status==200&&xhr.responseText!=""){var ret=JSON.parse(xhr.responseText);success_callback(ret,qid);}else if(xhr.status!=200&&xhr.responseText){var ret=JSON.parse(xhr.responseText);fail_callback(ret,qid);}};xhr.send(formData);};function strip_tags(dirtyString){var container=document.createElement('div');container.innerHTML=dirtyString;return container.textContent||container.innerText;}function foot_address(){var winH=$(window).height();var bodyH=$('body').height();if($('.cq_footer').css('position')!='static')if(bodyH>winH-$('.cq_footer').outerHeight())$('.cq_footer').css({'position':'static'});else $('.cq_footer').css({'position':'absolute','bottom':0,'left':0});else if(bodyH>winH)$('.cq_footer').css({'position':'static'});else $('.cq_footer').css({'position':'absolute','bottom':0,'left':0});}$(function(){foot_address();});$(window).load(function(){foot_address();$('.cq_footer').show();});function GetQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null;}if('function'!==typeof Array.prototype.reduce)Array.prototype.reduce=function(callback,opt_initialValue){'use strict';if(null===this||'undefined'===typeof this)throw new TypeError('Array.prototype.reduce called on null or undefined');if('function'!==typeof callback)throw new TypeError(callback+' is not a function');var index,value,length=this.length>>>0,isValueSet=false;if(1<arguments.length){value=opt_initialValue;isValueSet=true;}for(index=0;length>index;++index)if(this.hasOwnProperty(index))if(isValueSet)value=callback(value,this[index],index,this);else{value=this[index];isValueSet=true;}if(!isValueSet)throw new TypeError('Reduce of empty array with no initial value');return value;};function escape_html(s){return s?jQuery("<p>").text(s).html():"";}if(!Object.keys)Object.keys=function(o){if(o!==Object(o))throw new TypeError('Object.keys called on a non-object');var k=[],p;for(p in o)if(Object.prototype.hasOwnProperty.call(o,p))k.push(p);return k;};var projectPublishFun={init:function(pid,option){this.bState=true;this.setting={pid:pid,type:'问卷',surveyTitle:'',showShare:true,page:'',isPublish:true,publishCancelFun:function(){}};$.extend(this.setting,option);this.validateFun(pid);},validateFun:function(pid){var _this=this;$.ajax({url:'/enterprise/check_member_permission/?permission_type=edit&project_id='+pid,type:'GET',dataType:'json',success:function(ret){if(ret.status==200){if(ret.code==1)if(!_this.setting.isPublish)_this.checkPconvertForm(pid);else if(_this.setting.page==='surveyEdit'||_this.setting.page==='formEdit'){$(".question").each(function(){verify_question_option.hide($(this).attr("oid"));});_this.publishCheckFun(pid);}else if(_this.setting.page==='assessEdit'){if(is_validate_all())_this.publishCheckFun(pid);}else _this.publishCheckFun(pid);else if(ret.code==2){loadMack({off:'on',Limg:1,text:'您没有权限使用，请联系项目所有者',set:1000});_this.setting.publishCancelFun();}}else{check_permission=false;loadMack({off:'on',Limg:1,text:'请稍后再试',set:1000});_this.setting.publishCancelFun();}}});},publishCheckFun:function(pid){var _this=this;$.ajax({url:'/edit/ajax/publish_check/'+pid+'/',dataType:'JSON',success:function(ret){if(ret.invalid_qid_list.length===0)if(_this.setting.hasMobile)_this.publishFun(pid,ret.super_account,ret.ad_switch);else _this.showBindMobileFun(pid,ret.super_account,ret.ad_switch);else if(_this.setting.page==='surveyEdit'||_this.setting.page==='formEdit'||_this.setting.page==='assessEdit'){for(var i=0;i<ret.invalid_qid_list.length;i++){var qid=ret.invalid_qid_list[i];var qmodel=get_qmodel(qid);qmodel.show_edit_error_msg();};scroll_to($('.question[oid='+ret.invalid_qid_list[0]+']'));}else jsAlert({title:'提示',content:'<p>该'+_this.setting.type+'包含未编辑完成的题目，暂时无法发布，请先前往编辑页面完成编辑。</p>',conw:380,obj:_this.setting.publishCancelFun});}});},publishFun:function(pid,is_super,is_on){var _this=this;var content='';if(_this.setting.isPublish)if(_this.setting.surveyTitle)content='<p>你要发布'+_this.setting.type+'<span>《'+_this.setting.surveyTitle+'》</span>吗？</p>';else content='<p>是否发布'+_this.setting.type+'？</p>';if(is_super)content+='<div class="luckdraw_temp"><label><input style="margin-right:2px !important;" type="checkbox" id="luckdraw_selector" '+(is_on=="on"?"checked":"")+'/> 启用默认抽奖游戏，提高收集效率</label></div>';if(_this.setting.showShare&&_this.setting.isPublish){var shareUnChecked=localStorage.getItem('share_unchecked_'+pid);if(shareUnChecked)content+='<label><input style="vertical-align:middle;margin: 3px;" type="checkbox" id="checkbox_selector"/>共享到模板库</label><i class="tips" title="选中该选项，本'+_this.setting.type+'经审核合格后会添加到模板库中，供其他会员制作'+_this.setting.type+'时参考。"></i>';else content+='<label><input style="vertical-align:middle;margin: 3px;" type="checkbox" checked id="checkbox_selector"/>共享到模板库</label><i class="tips" title="选中该选项，本'+_this.setting.type+'经审核合格后会添加到模板库中，供其他会员制作'+_this.setting.type+'时参考。"></i>';}var confirmPopupObj={'title':'发布确认','content':content,'obj':_this.setting.publishSaveFun||_this.publishSaveFun,'Param':_this.setting,'close_obj':_this.setting.publishCancelFun};jsConfirm(confirmPopupObj);},showBindMobileFun:function(pid,is_super,is_on){var _this=this;var shareContent='';var luckdrawContent='';if(_this.setting.showShare&&_this.setting.isPublish){var shareUnChecked=localStorage.getItem('share_unchecked_'+pid);if(shareUnChecked)shareContent='<div class="share_temp"><label><input type="checkbox" id="checkbox_selector" />'+_this.setting.type+'共享到模版库</label></div>';else shareContent='<div class="share_temp"><label><input type="checkbox" id="checkbox_selector" checked />'+_this.setting.type+'共享到模版库</label></div>';if(is_super)luckdrawContent='<div class="luckdraw_temp"><label><input style="margin-right:2px !important;" type="checkbox" id="luckdraw_selector" '+(is_on=="on"?"checked":"")+'/> 启用默认抽奖游戏，提高收集效率</label></div>';}var bindMobileHtml=''+'<div class="bind_mobile_wrap">'+'<div class="bind_mobile_form">'+'<div class="form_item_wrap">'+'<div class="form_item form_mobile"><label for=""><input type="text" placeholder="手机号" name="mobile" class="mobile" /></label></div>'+'<div class="form_error">据网信办规定，发布'+_this.setting.type+'需绑定手机</div>'+'</div>'+'<div class="form_item_wrap">'+'<div class="form_item form_vcode"><label for=""><input type="text" placeholder="验证码" name="vcode" class="vcode" /></label><a class="btn_get_vcode">获取验证码</a></div>'+'<div class="form_error"></div>'+'</div>'+'</div>'+luckdrawContent+shareContent+'<div class="btn_wrap"><a class="btn_publish btn_disable">确定并发布'+_this.setting.type+'</a></div>'+'</div>';var bindMobilePopup=new jsbox({onlyid:'publish_bind_mobile',title:'绑定手机号',content:bindMobileHtml,conw:600,range:true,mack:true}).show();$('#publish_bind_mobile .jsbox_close').one('click',function(){if(_this.setting.publishCancelFun)_this.setting.publishCancelFun();});$('#publish_bind_mobile input[name=mobile]').keyup(function(e){var $this=$(this);var mobile=$this.val().replace(/\D/g,'');var $mobileError=$this.parents('.form_item_wrap').find('.form_error');mobile=mobile.substr(0,11);$this.val(mobile);if(mobile!==''){$mobileError.text('').hide();if(mobile.length===11)_this.validateMobileAndVcode($this);}else $mobileError.show().text('据网信办规定，发布'+_this.setting.type+'需绑定手机');});$('#publish_bind_mobile input[name=vcode]').keyup(function(e){var $this=$(this);var vcode=$this.val();var $vcodeError=$this.parents('.form_item_wrap').find('.form_error');if(vcode.length>=6)vcode=vcode.substr(0,6);$this.val(vcode);if(vcode!==''){$vcodeError.text('').hide();if(vcode.length===6)_this.validateMobileAndVcode($this);}else $vcodeError.show().text('请输入验证码');});$('#publish_bind_mobile .btn_get_vcode').click(function(e){if($(this).hasClass('btn_disabled'))return;var $this=$(this),$mobile=$this.parents('.bind_mobile_form').find('input[name=mobile]');mobile=$mobile.val();$mobileError=$mobile.parents('.form_item_wrap').find('.form_error');if(mobile==''){$mobileError.text('据网信办规定，发布'+_this.setting.type+'需绑定手机').show();return false;}else if(!/^(1[0-9])\d{9}$/.test(mobile)){$mobileError.text('请输入正确的手机号码').show();return false;}else $mobileError.text('').hide();;if(_this.bState)ajaxPost('/register/auth_mobile_validatecode/',{'mobile':mobile},function(response){if(response.error_msg)if(response.error_msg=='该手机号已被使用'){$('.jsbox_close').click();var bindedHtml=''+'<div class="have_bind">'+'<div class="has_bind">'+'<p>如您想继续绑定，可按如下操作：</p>'+'<p>1.在电脑上退出当前账号。</p>'+'<p>2.使用此手机号登录旧账号。</p>'+'<p>3.进入后台-我的账号-解绑并退出旧账号。</p>'+'<p>4.重新登录当前账号，重新绑定。</p>'+'</div>'+'<div class="btn_wrap"> '+'<div class="third_logout"><a href="/logout">退出当前账号</a></div>'+'<div class="third_close">谢谢提醒</div>'+'</div>'+'</div>';var bindMobilePopup=new jsbox({onlyid:'havebind_mobile',title:'我们检测到您的手机已绑定其他问卷网账号',content:bindedHtml,conw:600,range:true,mack:true}).show();}else $mobileError.text(response.error_msg).show();else{loadMack({off:'on',Limg:0,text:' 验证码已发送，请查收',set:2000});_this.getMobileCode($this);}});;});$('.third_close').live('click',function(){$('.jsbox_close').click();});$('#publish_bind_mobile .btn_publish').click(function(e){var $this=$(this);if(!$this.hasClass('btn_disable')){var $bindMobileForm=$this.parents('.bind_mobile_wrap'),$mobile=$bindMobileForm.find('input[name=mobile]');mobile=$mobile.val(),$mobileError=$mobile.parents('.form_item_wrap').find('.form_error'),$vcode=$bindMobileForm.find('input[name=vcode]'),vcode=$vcode.val(),$vcodeError=$vcode.parents('.form_item_wrap').find('.form_error'),is_shared=$("#checkbox_selector").attr("checked");if($("#luckdraw_selector").length==0)ad_switch='on';else ad_switch=$("#luckdraw_selector").attr("checked")?'on':'off';if(mobile==''){$mobileError.text('据网信办规定，发布'+_this.setting.type+'需绑定手机').show();return false;}else if(!/^(1[0-9])\d{9}$/.test(mobile)){$mobileError.text('请输入正确的手机号码').show();return false;}else $mobileError.text('').hide();;if(vcode==''){$vcodeError.text('请输入验证码').show();return false;}else $vcodeError.text('').hide();;if(!is_shared)localStorage.setItem('share_unchecked_'+pid,true);else localStorage.removeItem('share_unchecked_'+pid);var data={'mobile':mobile,'vcode':vcode,'proj_id':pid,'status':1,'is_shared':is_shared,'ad_switch':ad_switch};loadMack({off:'on',text:'发布中',set:10000});ajaxPost('/edit/ajax/bind_mobile_update_project_status/',data,function(response){if(response.error_msg)if(response.error_msg.indexOf('手机号')!=-1){$mobileError.text(response.error_msg).show();$vcodeError.text('').hide();}else{$mobileError.text('').hide();$vcodeError.text(response.error_msg).show();}else _this.publishSuccessFun(pid,response);});}});},validateMobileAndVcode:function(obj){var $bindMobileForm=obj.parents('.bind_mobile_wrap'),$mobile=$bindMobileForm.find('input[name=mobile]');mobile=$mobile.val(),$mobileError=$mobile.parents('.form_item_wrap').find('.form_error'),$vcode=$bindMobileForm.find('input[name=vcode]'),vcode=$vcode.val(),$vcodeError=$vcode.parents('.form_item_wrap').find('.form_error'),$btnPublish=$bindMobileForm.find('.btn_publish'),$share=$bindMobileForm.find('.share_temp');$luckdraw=$bindMobileForm.find('.luckdraw_temp');console.log($luckdraw);if(mobile.length===11&&vcode.length===6){var data={'mobile':mobile,'vcode':vcode,'_xsrf':$.cookie('_xsrf')};$.ajax({url:'/register/mobile_validate/',data:data,dataType:'JSON',type:'POST',timeout:60000,success:function(response){if(response.status=='200')if(response.error_msg){if(response.error_msg.indexOf('手机号')!=-1){$mobileError.text(response.error_msg).show();$vcodeError.text('').hide();}else{$mobileError.text('').hide();$vcodeError.text(response.error_msg).show();}$btnPublish.addClass('btn_disable');if($share)$share.hide();if($luckdraw)$luckdraw.hide();}else{$btnPublish.removeClass('btn_disable');if($share)$share.show();if($luckdraw)$luckdraw.show();}}});}else{$btnPublish.addClass('btn_disable');if($share)$share.hide();if($luckdraw)$luckdraw.hide();}},publishSaveFun:function(){var param=this.Param,pid=param.pid,is_shared=$("#checkbox_selector").attr("checked");if($("#luckdraw_selector").length==0)ad_switch='on';else ad_switch=$("#luckdraw_selector").attr("checked")?'on':'off';if(!is_shared)localStorage.setItem('share_unchecked_'+pid,true);else localStorage.removeItem('share_unchecked_'+pid);var data={'proj_id':pid,'status':1,'is_shared':is_shared,'_xsrf':$.cookie("_xsrf"),'ad_switch':ad_switch};loadMack({off:'on',text:'发布中',set:10000});$.ajax({url:'/edit/ajax/update_project_status/',data:data,dataType:'JSON',type:'POST',timeout:60000,success:function(response){if(response.status=="200")if(response.error_msg){$('.loadCon,.loadMack').remove();loadMack({off:'on',Limg:0,text:response.error_msg,set:2000});}else projectPublishFun.publishSuccessFun(pid,response);}});},publishSuccessFun:function(pid,info){var _this=this;try{if(change_project_status_callback&&typeof change_project_status_callback=="function")change_project_status_callback(info);}catch(e){}if(_this.setting.page=='report'||_this.setting.page=='assessReport'){$('.loadCon,.loadMack,#publish_bind_mobile,.publish_bind_mobile_lightBox').remove();_this.setting.obj.html('停止收集').addClass('cq_stop_btn');}else if(_this.setting.page=='collect')window.location.href='/collect/'+_this.setting.pagename+'/'+_this.setting.pid+'/';else if(_this.setting.page=='list'){$('.loadCon,.loadMack,#publish_bind_mobile,.publish_bind_mobile_lightBox').remove();var $obj=_this.setting.obj,$tr=$obj.parents('.tr');if($obj.find('option:selected').val()==2){$tr.find('.editor').addClass('end').attr("href",'javascript:;');$tr.find('.editor').attr("onclick",'');}else{var pid=$obj.attr('pid');$tr.find('.editor,.collect_a').removeClass('end').attr("href",'/collect/urllink/'+pid);$tr.find('.editor').attr("onclick",'project_design_confirm(this);return false;');}}else if(_this.setting.page=='overview')location.reload();},getMobileCode:function(obj){var _this=this;var sendMobileTimer=null;var iCountDownNum=59;if(_this.bState){_this.bState=false;sendMobileTimer=setInterval(function(){if(iCountDownNum<=0){clearInterval(sendMobileTimer);iCountDownNum=59;obj.html('获取验证码').removeClass('btn_disabled');_this.bState=true;}else{iCountDownNum--;obj.html(iCountDownNum+'秒后重新获取').addClass('btn_disabled');}},1000);}},checkPconvertForm:function(pid){var _this=this;ajaxPost('/edit/ajax/get_rspd_count/',{'proj_id':pid},function(response){if(response.error_msg)loadMack({off:'on',text:response.error_msg,set:10000});else if(response.pc_count!=0){var confirmPopupObj={'title':'修改确认','content':'<img style="display: block; margin: 10px auto 25px;" src="/static/images/exclamation_mark.png" />停止收集你的有偿收集订单也将被<span style="color:#cd4444;">取消</span>！你想再收集时可至“<span style="color:#cd4444;">收集数据→有偿收集</span>”重新下订单。','obj':_this.stopCollectFun,'Param':_this.setting,'conw':400,'close_obj':_this.setting.publishCancelFun};jsConfirm(confirmPopupObj);}else{var confirmPopupObj={'title':'停止确认','content':'<p>确认停止收集<span>《'+_this.setting.surveyTitle+'》</span>吗？</p><p>该'+_this.setting.type+'所有数据收集将被停止，答题链接将无法收集数据</p>','obj':_this.stopCollectFun,'Param':_this.setting,'conw':400,'close_obj':_this.setting.publishCancelFun};jsConfirm(confirmPopupObj);}});},stopCollectFun:function(){var param=this.Param;var data={'proj_id':param.pid,'status':0,'_xsrf':$.cookie("_xsrf")};$.ajax({url:'/edit/ajax/update_project_status/',data:data,dataType:'JSON',type:'POST',timeout:60000,success:function(response){if(response.status=="200")if(response.error_msg){$('.loadCon,.loadMack').remove();loadMack({off:'on',Limg:0,text:response.error_msg,set:2000});}else if(param.page=='report'||param.page=='assessReport')param.obj.html('开始收集').removeClass('cq_stop_btn');else if(param.page=='collect')window.location.href='/collect/'+param.pagename+'/'+param.pid+'/';}});}};var projectPublishMobileFun={init:function(pid,option){this.bState=true;this.setting={pid:pid,type:'问卷'};$.extend(this.setting,option);this.showBindMobileFun(pid);},showBindMobileFun:function(pid){var _this=this;$('#bindMobileHtml').remove();var bindMobileHtml=''+'<div id="publish_bind_mobile">'+'<div class="bind_mobile_wrap">'+'<a class="btn_close_bind_mobile"></a>'+'<div class="title">绑定手机号</div>'+'<div class="bind_mobile_form">'+'<div class="form_item_wrap">'+'<div class="form_item form_mobile"><label for=""><input type="text" placeholder="手机号" name="mobile" class="mobile" /></label></div>'+'<div class="form_error">据网信办规定，发布'+_this.setting.type+'需绑定手机</div>'+'</div>'+'<div class="form_item_wrap">'+'<div class="form_item form_vcode"><label for=""><input type="text" placeholder="验证码" name="vcode" class="vcode" /></label><a class="btn_get_vcode">获取验证码</a></div>'+'<div class="form_error"></div>'+'</div>'+'</div>'+'<div class="btn_wrap"><a class="btn_publish btn_disable">确定并发布'+_this.setting.type+'</a></div>'+'</div>'+'</div>';$('body').append(bindMobileHtml);$('#publish_bind_mobile .btn_close_bind_mobile').one('click',function(){$('#publish_bind_mobile').remove();});$('#publish_bind_mobile input[name=mobile]').keyup(function(e){var $this=$(this);var mobile=$this.val().replace(/\D/g,'');var $mobileError=$this.parents('.form_item_wrap').find('.form_error');mobile=mobile.substr(0,11);$this.val(mobile);if(mobile!==''){$mobileError.text('').hide();if(mobile.length===11)projectPublishFun.validateMobileAndVcode($this);}else $mobileError.show().text('据网信办规定，发布'+_this.setting.type+'需绑定手机');});$('#publish_bind_mobile input[name=vcode]').keyup(function(e){var $this=$(this);var vcode=$this.val();var $vcodeError=$this.parents('.form_item_wrap').find('.form_error');if(vcode.length>=6)vcode=vcode.substr(0,6);$this.val(vcode);if(vcode!==''){$vcodeError.text('').hide();if(vcode.length===6)projectPublishFun.validateMobileAndVcode($this);}else $vcodeError.show().text('请输入验证码');});$('#publish_bind_mobile .btn_get_vcode').click(function(e){if($(this).hasClass('btn_disabled'))return;var $this=$(this),$mobile=$this.parents('.bind_mobile_form').find('input[name=mobile]');mobile=$mobile.val();$mobileError=$mobile.parents('.form_item_wrap').find('.form_error');if(mobile==''){$mobileError.text('据网信办规定，发布'+_this.setting.type+'需绑定手机').show();return false;}else if(!/^(1[0-9])\d{9}$/.test(mobile)){$mobileError.text('请输入正确的手机号码').show();return false;}else $mobileError.text('').hide();;if(_this.bState)ajaxPost('/register/auth_mobile_validatecode/',{'mobile':mobile},function(response){if(response.error_msg)if(response.error_msg=='该手机号已被使用'){$('#publish_bind_mobile').remove();var bindedHtml=''+'<div id="bind_mobile_repeat"><div class="have_bind">'+'<a class="close_bind_mobile"></a>'+'<div class="title">该手机号已被绑定</div>'+'<div class="has_bind">'+'<p>如您想继续绑定，可按如下操作：</p>'+'<p>1.在电脑上退出当前账号。</p>'+'<p>2.使用此手机号登录旧账号。</p>'+'<p>3.进入后台-我的账号-解绑并退出旧账号。</p>'+'<p>4.重新登录当前账号，重新绑定。</p>'+'</div>'+'<div class="btn_wrap"> '+'<div class="third_logout"><a href="/logout">退出当前账号</a></div>'+'<div class="third_close">谢谢提醒</div>'+'</div>'+'</div></div>';$('body').append(bindedHtml);}else $mobileError.text(response.error_msg).show();else{loadMack({off:'on',Limg:0,text:' 验证码已发送，请查收',set:2000});_this.getMobileCode($this);}});;});$('body').on('click','#bind_mobile_repeat .close_bind_mobile',function(){$('#bind_mobile_repeat').remove();});$('body').on('click','.third_close',function(){$('#bind_mobile_repeat').remove();});$('#publish_bind_mobile .btn_publish').click(function(e){var $this=$(this);if(!$this.hasClass('btn_disable')){var $bindMobileForm=$this.parents('.bind_mobile_wrap'),$mobile=$bindMobileForm.find('input[name=mobile]');mobile=$mobile.val(),$mobileError=$mobile.parents('.form_item_wrap').find('.form_error'),$vcode=$bindMobileForm.find('input[name=vcode]'),vcode=$vcode.val(),$vcodeError=$vcode.parents('.form_item_wrap').find('.form_error');if(mobile==''){$mobileError.text('据网信办规定，发布'+_this.setting.type+'需绑定手机').show();return false;}else if(!/^(1[0-9])\d{9}$/.test(mobile)){$mobileError.text('请输入正确的手机号码').show();return false;}else $mobileError.text('').hide();;if(vcode==''){$vcodeError.text('请输入验证码').show();return false;}else $vcodeError.text('').hide();;var data={'mobile':mobile,'vcode':vcode,'proj_id':pid,'status':1};loadMack({off:'on',text:'发布中',set:10000});ajaxPost('/edit/ajax/bind_mobile_update_project_status/',data,function(response){if(response.error_msg)if(response.error_msg.indexOf('手机号')!=-1){$mobileError.text(response.error_msg).show();$vcodeError.text('').hide();return false;}else{$mobileError.text('').hide();$vcodeError.text(response.error_msg).show();return false;}else if(_this.setting.page=='list'){surePub=true;$('.sr_share[pidname='+pid+']').triggerHandler("tapone");}else if(_this.setting.page=='edit')window.location.href=_this.setting.getSurveyUrl+'?own=1';});}});},getMobileCode:function(obj){var _this=this;var sendMobileTimer=null;var iCountDownNum=59;if(_this.bState){_this.bState=false;sendMobileTimer=setInterval(function(){if(iCountDownNum<=0){clearInterval(sendMobileTimer);iCountDownNum=59;obj.html('获取验证码').removeClass('btn_disabled');_this.bState=true;}else{iCountDownNum--;obj.html(iCountDownNum+'秒后重新获取').addClass('btn_disabled');}},1000);}}};function isSessionStorageNameSupported(){var testKey='test',storage=window.sessionStorage;try{storage.setItem(testKey,'1');storage.removeItem(testKey);return true;}catch(error){return false;}}function setSessionStorage(name,value,expiredays){if(isSessionStorageNameSupported())sessionStorage.setItem(name,value);else setCookie(name,value,expiredays);}function getSessionStorage(name){if(isSessionStorageNameSupported())return sessionStorage.getItem(name);else return getCookie(name);}var QUESTION_DICT={};var QUESTIONPAGE_DICT={};var QMODEL_DICT={};var JUMPCONSTRIANT_DICT={};var DISPLAYCONSTRIANT_DICT={};var AUTOREPLACE_SOURCE_Q_DICT={};var AUTOREPLACE_OBJ_ID_DICT={};var total_answers={};var JUMPCONSTRAINT_SOURCE_Q_DICT={};var DISPLAYCONSTRAINT_SOURCE_Q_DICT={};var RELATED_QUESTION_DICT={};var DISPLAYCONSTRIANT_DEST_QID_LIST=[];var answer_path=[];var curr_time_cost=0;var site_url=window.location.protocol+"//"+window.location.host;var mobile_auth_queston_status;var selected_related_questions=[];function add_question(question){QUESTION_DICT[get_oid(question)]=question;}function remove_question(qid){delete QUESTION_DICT[qid];}if(isNotEmpty(project)){for(var i=0;i<project.questionpage_list.length;i++){var page=project.questionpage_list[i];QUESTIONPAGE_DICT[get_oid(page)]=page;for(var k=0;k<page.question_list.length;k++){var question=page.question_list[k];if(question.matrixrow_id_list&&question.matrixrow_id_list.length===0)question.matrixrow_list=[];QUESTION_DICT[get_oid(question)]=question;}}if(project.hasOwnProperty("jumpconstraint_list"))for(var i=0;i<project.jumpconstraint_list.length;i++){var jumpconstraint=project.jumpconstraint_list[i];JUMPCONSTRIANT_DICT[jumpconstraint.id]=jumpconstraint;if(JUMPCONSTRAINT_SOURCE_Q_DICT[jumpconstraint.question_id])JUMPCONSTRAINT_SOURCE_Q_DICT[jumpconstraint.question_id].push(jumpconstraint);else JUMPCONSTRAINT_SOURCE_Q_DICT[jumpconstraint.question_id]=[jumpconstraint];}if(project.hasOwnProperty("displayconstraint_list"))for(var i=0;i<project.displayconstraint_list.length;i++){var displayconstraint=project.displayconstraint_list[i];DISPLAYCONSTRIANT_DICT[displayconstraint.id]=displayconstraint;if(DISPLAYCONSTRAINT_SOURCE_Q_DICT[displayconstraint.question_id])DISPLAYCONSTRAINT_SOURCE_Q_DICT[displayconstraint.question_id].push(displayconstraint);else DISPLAYCONSTRAINT_SOURCE_Q_DICT[displayconstraint.question_id]=[displayconstraint];for(var j=0;j<displayconstraint.condition.condition_item_list.length;j++)DISPLAYCONSTRIANT_DEST_QID_LIST.push(displayconstraint.condition.condition_item_list[j].question_id);}if(project.hasOwnProperty("question_relation_list"))for(var i=0;i<project.question_relation_list.length;i++){var question_relation=project.question_relation_list[i];if(question_relation.from_qid in RELATED_QUESTION_DICT)RELATED_QUESTION_DICT[question_relation.from_qid].push(question_relation);else RELATED_QUESTION_DICT[question_relation.from_qid]=[question_relation];}if(project.hasOwnProperty("autoreplace_list"))for(var i=0;i<project.autoreplace_list.length;i++){var autoreplace=project.autoreplace_list[i];var source_items=AUTOREPLACE_SOURCE_Q_DICT[autoreplace.source_qid];var obj_items=AUTOREPLACE_OBJ_ID_DICT[autoreplace.obj_id];if(isNotEmpty(source_items)){source_items.push(autoreplace);AUTOREPLACE_SOURCE_Q_DICT[autoreplace.source_qid]=source_items;}else AUTOREPLACE_SOURCE_Q_DICT[autoreplace.source_qid]=[autoreplace];if(isNotEmpty(obj_items)){obj_items.push(autoreplace);AUTOREPLACE_OBJ_ID_DICT[autoreplace.obj_id]=obj_items;}else AUTOREPLACE_OBJ_ID_DICT[autoreplace.obj_id]=[autoreplace];}}function inputcheck_number(value){return !isNaN(value);}function inputcheck_english(value){var reg=/^[a-zA-Z\ \,\.\?\:\\\/\*\#\@\$\&\^\(\)\[\]\{\}\<\>\;\'\"\!\-\=\_\+\|\t]+$/;return reg.test(value);}function inputcheck_chinese(value){var trim_value=value.replace(/\s+/g,"");var reg=/^[\u4E00-\u9FA5\u3002\uff1b\uff0c\uff1a\u201c\u201d\uff08\uff09\u3001\uff1f\u300a\u300b,\.;\-_\?]*$/;if(reg.test(trim_value))return true;return false;}function inputcheck_mobile(str){var reg=/^(((13)|(15)|(18)|(17)|(14)|(19)|(16))+\d{9})$/;if(reg.test(str))return true;return false;}function inputcheck_email(str){var reg=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(reg.test(str))return true;return false;}function inputcheck_none(str){return true;}var checkmethod_factory={get_method:function(check_type){if(check_type=="")return inputcheck_none;var method_map={"number":inputcheck_number,"alphabet":inputcheck_english,"chinese":inputcheck_chinese,"email":inputcheck_email,"mobile":inputcheck_mobile};return method_map[check_type];},get_err_msg:function(check_type){var err_msg_map={"number":"输入有误，请输入数字","alphabet":"输入有误，请输入字母","chinese":"输入有误，请输入中文","email":"输入有误，请输入Email","mobile":"输入有误，请输入手机号码"};return err_msg_map[check_type];},get_input_msg:function(check_type){var msg_map={"number":"请输入数字","alphabet":"请输入字母","chinese":"请输入中文","email":"请输入Email","mobile":"请输入手机号码"};return msg_map[check_type];}};function get_question(qid_or_qcid){for(var key in QUESTION_DICT)if(get_oid(QUESTION_DICT[key])==qid_or_qcid||QUESTION_DICT[key].cid==qid_or_qcid)return QUESTION_DICT[key];return null;}function get_option(qid,option_id_or_list){var question=get_question(qid);if(!isNotEmpty(question))return null;if(option_id_or_list.constructor==Array){var option_list=[];for(var i=0;i<question.option_list.length;i++){var option=question.option_list[i];if(check_in(get_oid(option),option_id_or_list))option_list.push(option);}return option_list;}else{for(var i=0;i<question.option_list.length;i++){var option=question.option_list[i];if(get_oid(option)==option_id_or_list)return option;}for(var i=0;i<question.related_question_list.length;i++)for(var j=0;j<question.related_question_list[i].option_list.length;j++){var option=question.related_question_list[i].option_list[j];if(get_oid(option)==option_id_or_list)return option;}}return null;}function get_matrixrow(qid,row_id_or_list){var question=get_question(qid);if(!isNotEmpty(question)||!isNotEmpty(question.matrixrow_list))return null;if(row_id_or_list.constructor==String){for(var i=0;i<question.matrixrow_list.length;i++){var matrixrow=question.matrixrow_list[i];if(get_oid(matrixrow)==row_id_or_list)return matrixrow;}}else{var row_list=[];for(var i=0;i<question.matrixrow_list.length;i++){var matrixrow=question.matrixrow_list[i];if(check_in(get_oid(matrixrow),row_id_or_list))row_list.push(matrixrow);}return row_list;}return null;}function get_qmodel(qid_or_qcid_or_question){var question=null;if(qid_or_qcid_or_question.constructor==String)question=get_question(qid_or_qcid_or_question);else question=qid_or_qcid_or_question;if(isNotEmpty(question))if(isNotEmpty(QMODEL_DICT[get_oid(question)]))return QMODEL_DICT[get_oid(question)];else{var qmodel=QModelFactory.getQModel(question);QMODEL_DICT[get_oid(question)]=qmodel;return qmodel;}else return null;}function get_questionpage(page_id){return QUESTIONPAGE_DICT[page_id];}function get_question_list_by_page(oid_or_page){var page=null;if(oid_or_page.constructor==String)page=get_questionpage(oid_or_page);else page=oid_or_page;return $.map(page.question_id_list,get_question);}function update_question(question){QUESTION_DICT[get_oid(question)]=question;QMODEL_DICT[get_oid(question)]=null;update_question_relation_option(question._id.$oid);}function check_hide_for_question(qid){var css_str=$("#question_"+qid).css("display");var is_hide_by_logic=isNotEmpty($("#question_"+qid).attr("hideByLogic"))?true:false;if((!isNotEmpty(css_str)||css_str=="none")&&is_hide_by_logic)return true;return false;}function Process_title_p(id){var title_html=$('#'+id+' .topic_title p:eq(0)').html();$('#'+id+' .topic_title p:eq(0)').replaceWith("<span>"+title_html+"</span>");}function check_answer_integrity(){var is_intact=true;return is_intact;for(var page_id in question_visible_map){var visible_qid_list=question_visible_map[page_id];for(var i=0;i<visible_qid_list.length;i++){var question_id=visible_qid_list[i];if(!(question_id in total_answers)){var question=get_question(question_id);if('allow_null' in question.custom_attr||question.question_type===QUESTION_TYPE_DESC){}else if(check_in(question.question_type,[QUESTION_TYPE_BLANK,QUESTION_TYPE_MULTIPLE_BLANK])){for(var i=0;i<question.option_list.length;i++){var option=question.option_list[i];if('allow_null' in option.custom_attr){}else{is_intact=false;break;}};}else{is_intact=false;break;}}};}return is_intact;}var verify_question_option={show:function(qid,errorTxt){$('#question_box').children('li').each(function(){if($(this).attr('oid')==qid)$('<div class="topic_type_error" style="padding:8px 15px; background:#fcecec; color:#f2395b;">'+errorTxt+'</div>').insertBefore($(this).find('.topic_type'));;});},hide:function(qid){$('#question_box').children('li').each(function(){if($(this).attr('oid')==qid)$(this).find('.topic_type_error').remove();;});}};function check_answer_unique(qmodels){var answers={};var result=null;for(var i=0;i<qmodels.length;i++){var qmodel=qmodels[i];var get_answer_func=qmodel.get_getanswer_function();var answer=get_answer_func(qmodel);if(isNotEmpty(answer))answers[qmodel.qid]=answer;}if(isNotEmpty(answers)){result=send_check_unique_request(answers);if(isNotEmpty(result)){is_unique=false;for(var qid in result){var option_id_list=result[qid];for(var i=0;i<option_id_list.length;i++){var option_id=option_id_list[i];$("#"+option_id).addClass("invalid");$("#tip_"+option_id).show();}}}}return result;}function send_check_unique_request(answers){var data={answer_str:toJSONString(answers)};var duplicate_answer={};syncPost("/f/unique_check/",data,function(ret){duplicate_answer=ret.duplicate_answer;});return duplicate_answer;}function is_blank(question){return check_in(question.question_type,[QUESTION_TYPE_BLANK,QUESTION_TYPE_MULTIPLE_BLANK]);}var touchFun=function(obj,fn,type){var pos={startX:0,startY:0,endX:0,endY:0,referenceX:5,referenceY:5};var startTime=0,endTime=0;obj.addEventListener('touchstart',function(ev){var fingerLen=ev.targetTouches.length;if(fingerLen===1){startTime=new Date().getTime();var touchFinger=ev.touches[0];pos.endX=pos.startX=touchFinger.pageX;pos.endY=pos.startY=touchFinger.pageY;}});obj.addEventListener('touchmove',function(ev){ev.stopPropagation();var fingerLen=ev.targetTouches.length;if(fingerLen===1){var touchFinger=ev.touches[0];pos.endX=touchFinger.pageX;pos.endY=touchFinger.pageY;}});obj.addEventListener('touchend',function(){var changeX=pos.startX-pos.endX;var changeY=pos.startY-pos.endY;if(Math.abs(changeX)>Math.abs(changeY)){if(changeX>0){if(type=='left')fn();}else if(type=='right')fn();}else if(Math.abs(changeX)<Math.abs(changeY)){if(changeY>0){if(type=='top')fn();}else if(type=='down')fn();}else if(Math.abs(changeX)<pos.referenceX&&Math.abs(changeY)<pos.referenceY){endTime=new Date().getTime();if(endTime-startTime>300){if(type=='3Dtouch')fn();}else if(type=='click'||!type)fn();}});};function listenerCoverBackdropHandler(obj){var pos={startX:0,startY:0,endX:0,endY:0,referenceX:2,referenceY:2};var startTime=0,endTime=0,loadContent=false,loadCover=false,bodyDom=document.body,scrollFirst=true,$coverWrap=$(".cover_wrap"),$coverBackdropDom=$coverWrap.find(".cover_backdrop"),$phoneContentWrap=$(".phone_content_wrap"),$body=$("body"),winH=$(window).height(),$win=$(window);bodyDom.addEventListener('touchstart',function(ev){var fingerLen=ev.targetTouches.length;if(fingerLen===1){startTime=new Date().getTime();var touchFinger=ev.touches[0];pos.endX=pos.startX=touchFinger.pageX;pos.endY=pos.startY=touchFinger.pageY;}});$coverWrap[0].addEventListener('touchmove',function(ev){var fingerLen=ev.targetTouches.length;if(fingerLen===1){var coverWrapH=$coverWrap.height();var touchFinger=ev.touches[0];var changeX=pos.startX-touchFinger.pageX;var changeY=pos.startY-touchFinger.pageY;if(Math.abs(changeX)<Math.abs(changeY)&&changeY>0)if($win.scrollTop()>0)if($win.scrollTop()>(coverWrapH-winH+1))loadContent=true;}});$coverWrap[0].addEventListener('touchend',function(ev){if(loadContent){var coverWrapH=$coverWrap.height();loadContent=false;$phoneContentWrap.show();var scrollTop=coverWrapH-winH;$("html, body").animate({scrollTop:coverWrapH});}});$coverBackdropDom.on('click',function(ev){ev.stopPropagation();var coverWrapH=$coverWrap.height();$phoneContentWrap.show();var scrollTop=coverWrapH-winH;$("html, body").animate({scrollTop:coverWrapH});});}var errorTipAnimation={show:function(obj,txt){if(obj.text()==txt&&obj.is(':visible'))return;obj.velocity("stop",true);obj.text(txt).css({"height":0,"marginLeft":"50%","opacity":0,"display":"block"}).velocity({"height":"0.22rem"},{delay:200,duration:100,easing:[0.17,0.67,0.83,0.67]}).velocity({"marginLeft":"-0.1rem","opacity":1},{duration:200,easing:[0.17,0.67,0.83,0.67]}).velocity({"marginLeft":"0"},{duration:120,easing:[0.17,0.67,0.83,0.67]});},hide:function(obj){if(!obj.is(':visible'))return;obj.velocity("stop",true);obj.velocity({"marginLeft":"-100%","opacity":0},{duration:300,easing:[0.17,0.67,0.83,0.67]}).velocity({"height":0},{duration:100,easing:[0.17,0.67,0.83,0.67],complete:function(){obj.text("").css({"display":"none"});}});},hideAll:function(qid){var $qdiv=$("#question_"+qid);var $qtip=$qdiv.find("#tip_"+qid);if($qtip.is(':visible'))errorTipAnimation.hide($qtip);var $optionTip=$qdiv.find(".option_tip");$optionTip.each(function(){var $this=$(this);if($this.is(':visible'))errorTipAnimation.hide($this);});}};function isWeiXin(){var ua=window.navigator.userAgent.toLowerCase();if(ua.match(/MicroMessenger/i)=='micromessenger')return true;else return false;}function isIOS(){var u=navigator.userAgent;var isIOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return isIOS;}function set_advertising_cookie(rid,seq){var $wjAdvertising=$('#wj_rspd_advertising');var imgUrl=$wjAdvertising.attr('src');var urlReg=/(\w+:\/\/[^/:|//]+)?(.*\/[^#|\?|\n]+)?(#.*)?(\?.*)?/i;if($wjAdvertising.length>0&&urlReg.test(imgUrl)){var urlArr=imgUrl.match(urlReg);var urlOrigin=urlArr[1];var urlPath=urlArr[2];var urlSearch=urlArr[4]?urlArr[4].substr(1):'';var urlParamArr=[];var keyArr=['mid','mtc','project_id','token','rid','seq'];for(var i=0;i<keyArr.length;i++){var value='';if(keyArr[i]=='rid')value=rid;else if(keyArr[i]=='seq')value=seq;else value=getUrlStrQuery(urlSearch,keyArr[i]);if(value)urlParamArr.push(keyArr[i]+'='+value);}var newImgSrc=urlOrigin+urlPath+'?'+urlParamArr.join('&');$wjAdvertising.attr({'src':newImgSrc});}}function getUrlStrQuery(url,name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=url.match(reg);if(r!=null)return r[2];return null;}var remainingTime;function mobileLeaveTip(){var qCount=project.question_count;var finshCount=0;$('.question').each(function(i){if($(this).find('.checked').length>0)finshCount++;else if($(this).find('.topic_input').attr('has-value'))finshCount++;else if($(this).find('.selected').length>0)finshCount++;});remainingTime=Math.ceil((qCount-finshCount)*2);remainingTime>3?remainingTime:remainingTime=3;}function pcLeaveTip(){var qCount=project.question_count;var finshCount=0;$('.question').each(function(i){if($(this).find('.jqTransformChecked').length>0)finshCount++;else if($(this).find('.blank').val())finshCount++;else if($(this).find('.ui-sortable label').length)finshCount++;else if($(this).find('.active').length>0)finshCount++;else if($(this).find('.back_n').length>0&&!$(this).find('.back_n').attr('score_v'))finshCount++;});remainingTime=Math.ceil((qCount-finshCount)*2);remainingTime>3?remainingTime:remainingTime=3;}function show_end_create_btn(){var reg=new RegExp("(^|&)"+'button'+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);var btn_index=r?r[2]:null;var random_index=Math.random()*1000;var random=r?btn_index:random_index;var key;if(random<=8)key=1;else if(random>8&&random<=16){key=2;$('.end_create_btn_down').addClass('end_create_btn_hide');$('.create_btn_box').removeClass('end_create_btn_hide');$('.wjtext').addClass('end_create_btn_hide');}else if(random>16&&random<=24)key=3;else if(random>24&&random<=32)key=4;else if(random>32&&random<=40)key=5;else if(random>40&&random<=48){key=6;$('.end_create_btn_up').removeClass('end_create_btn_hide');$('.end_create_btn_down').addClass('end_create_btn_hide');}else key=7;$('body').attr('btn_style',key);if(is_luck_draw_ad_open())_hmt.push(['_trackPageview','/s/end_create_btn_'+key]);}function validate_answer_qsingle(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var disp_type=qmodel.question.custom_attr.disp_type||'vertical';if("dropdown" in qmodel.question.custom_attr||disp_type=='dropdown'){var select_val=qdiv.find("select").val();if(isNotEmpty(select_val)){qtip.html("");return true;}else{if("allow_null" in qmodel.question.custom_attr){qtip.html("");return true;}qtip.html("请选择一个选项");scroll_to(qdiv);return false;}}else if(qdiv.find(".option:checked").length==0)if(qdiv.attr("allow_null")){qtip.html("");return true;}else{qtip.html("请选择一个选项");scroll_to(qdiv);return false;}else{qdiv.find('.red').text("");if(qdiv.find('.option_open').length>0)qdiv.find('.option_open').removeClass('invalid');var radio=qdiv.find(".option:checked");var option_id=radio.val().split("_")[0];var option=get_option(qmodel.qid,option_id);if(option.is_open){var open_input=qdiv.find("#option_open_"+get_oid(option));if(open_input.length==0)open_input=qdiv.find("#"+qmodel.qid+"_related_option_open_"+get_oid(option));var open_tip=open_input.next();if(open_input.val()==""){if(!option.custom_attr.hasOwnProperty("allow_null")){open_input.addClass('invalid');qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}else{if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(open_input.val())){open_input.removeClass('invalid');open_tip.text("");}else{open_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));open_input.addClass('invalid');qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}}if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(open_input.val().length>parseInt(option.custom_attr.char_count)){qmodel.show_option_msg(open_input.attr("id"),"已超出{0}个字".format([open_input.val().length-parseInt(char_count)]));scroll_to(qdiv);return false;}else qmodel.clear_option_msg(open_input.attr("id"));}else{open_input.removeClass('invalid');open_tip.text("");qtip.text("");return true;}}}qtip.html("");return true;}}function get_answer_qsingle(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer=[];var disp_type=qmodel.question.custom_attr.disp_type||'vertical';if("dropdown" in qmodel.question.custom_attr||disp_type=='dropdown'){var select_val=qdiv.find("select").val();if(isNotEmpty(select_val))answer.push(select_val);}else{var checked_radio=qdiv.find(".option:checked");if(checked_radio.closest('div').css('display')=='none')return answer;if(checked_radio.length>0){var option_id=checked_radio.val().split("_")[0];answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(isNotEmpty(option))if(option.is_open){var option_input=qdiv.find("#option_open_"+option_id);if(option_input.length==0)option_input=qdiv.find("#"+qmodel.qid+"_related_option_open_"+get_oid(option));if(isNotEmpty(option_input))answer.push(option_input.val());}}}return answer;}function bind_event_qsingle(qmodel){inputVal("#question_"+qmodel.qid+" .option_open");}function bind_event_qsinglevote(qmodel){var qid=qmodel.qid;inputVal("#question_"+qid+" .option_open");if('data_show' in qmodel.question.custom_attr)qFontVoteHandle(qid);}function validate_answer_qmultiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var custom_attr=qmodel.question.custom_attr;var checked_count=qdiv.find(".option:checked").length;if(checked_count==0){if("allow_null" in qmodel.question.custom_attr)return true;qtip.text("请选择选项");scroll_to(qdiv);return false;}var min_answer_num=0;var max_answer_num=0;if(qmodel.question.custom_attr.hasOwnProperty("min_answer_num"))min_answer_num=parseInt(qmodel.question.custom_attr.min_answer_num);if(qmodel.question.custom_attr.hasOwnProperty("max_answer_num"))max_answer_num=parseInt(qmodel.question.custom_attr.max_answer_num);if(min_answer_num>checked_count&&min_answer_num!=0){qtip.text("请至少选择{0}个选项".format([min_answer_num]));scroll_to(qdiv);return false;}else if(max_answer_num<checked_count&&max_answer_num!=0){qtip.text("最多只能选择{0}个选项".format([max_answer_num]));scroll_to(qdiv);return false;}var open_valid=true;qdiv.find('.red').text("");qdiv.find('.option_open').removeClass('invalid');qdiv.find(".option:checked").each(function(){var option_id=$(this).attr("id").replace("option_","").replace(qmodel.qid+"_related_","");var option=get_option(qmodel.qid,option_id);if(option.is_open){var open_input=qdiv.find("#option_open_"+get_oid(option));if(open_input.length==0)open_input=qdiv.find("#"+qmodel.qid+"_related_option_open_"+get_oid(option));var open_tip=open_input.next();if(open_input.val()==""&&!option.custom_attr.hasOwnProperty("allow_null")){open_input.addClass('invalid');qtip.text("请检查该题目的答案");open_valid=false;}else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(open_input.val().length>parseInt(char_count)){qmodel.show_option_msg(open_input.attr("id"),"已超出{0}个字".format([open_input.val().length-parseInt(char_count)]));scroll_to(qdiv);open_valid=false;}else qmodel.clear_option_msg(open_input.attr("id"));}else open_input.removeClass('invalid');if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(open_input.val())){if(open_valid){open_input.removeClass('invalid');open_tip.text("");}}else{open_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));open_input.addClass('invalid');qtip.text("请检查该题目的答案");open_valid=false;}}}}}});if(open_valid)qtip.text("");else scroll_to(qdiv);return open_valid;}function get_answer_qmultiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer=[];qdiv.find(".option:checked").each(function(){var option_answer=[];var option_id=$(this).attr("id").replace("option_","").replace(qmodel.qid+"_related_","");option_answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(option.is_open){var open_input=qdiv.find("#option_open_"+get_oid(option));if(open_input.length==0)open_input=qdiv.find("#"+qmodel.qid+"_related_option_open_"+get_oid(option));if(isNotEmpty(open_input.val()))option_answer.push(open_input.val());}answer.push(option_answer);});return answer;}function bind_event_qmultiple(qmodel){var qid=qmodel.qid;option_exclusive_multiple(qid);inputVal("#question_"+qid+" .option_open");}function option_exclusive_multiple(qid){var qmodel=get_qmodel(qid);var qdiv=$("#question_"+qmodel.qid);qdiv.find(".option").on("change",function(){if($(this).attr("exclusive")){if(this.checked)qdiv.find(".option").not(this).each(function(){if(this.checked)$(this).prev().click();});}else if(this.checked)qdiv.find(".option[exclusive=1]").each(function(){if(this.checked)$(this).prev().click();});});}function bind_event_qmultiplevote(qmodel){var qid=qmodel.qid;option_exclusive_multiple(qid);inputVal("#question_"+qid+" .option_open");if('data_show' in qmodel.question.custom_attr)qFontVoteHandle(qid);}var test20170216=1;function validate_answer_qblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var qtipCode=$("#tip_code_"+qmodel.qid);var input_val=$.trim(qdiv.find(".option").val());var option_id=qdiv.find(".option").attr("id");var option=get_option(qmodel.qid,option_id);var is_valid=true;if(!isNotEmpty(input_val))if("allow_null" in qmodel.question.custom_attr||"allow_null" in option.custom_attr)qtip.text("");else{qtip.text("请输入内容");scroll_to(qdiv);is_valid=false;}else{if(option.custom_attr.checkmethod!="mobile"&&'char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;var char_count_min=option.custom_attr.char_count_min;if(char_count&&char_count_min){if(parseInt(char_count)==parseInt(char_count_min)){if(input_val.length!=parseInt(char_count)){qmodel.show_option_msg(option_id,"请输入{0}个字".format([parseInt(char_count)]));scroll_to(qdiv);is_valid=false;}}else if(input_val.length<parseInt(char_count_min)||input_val.length>parseInt(char_count)){qmodel.show_option_msg(option_id,"请输入{0}~{1}个字".format([char_count_min,char_count]));scroll_to(qdiv);is_valid=false;}}else if(char_count&&input_val.length>parseInt(char_count)){qmodel.show_option_msg(option_id,"请至多输入{0}个字".format([parseInt(char_count)]));scroll_to(qdiv);is_valid=false;}else if(char_count_min&&input_val.length<parseInt(char_count_min)){qmodel.show_option_msg(option_id,"请至少输入{0}个字".format([parseInt(char_count_min)]));scroll_to(qdiv);is_valid=false;}else qmodel.clear_option_msg(option_id);}if(option.custom_attr.checkmethod=="mobile"&&option.custom_attr.sms_auth=="on")question_captcha_map[qmodel.qid]=false;if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(input_val)){if(option.custom_attr.sms_auth=='on'&&mobile_auth_queston_status!=MOBILE_AUTH_QUESTION_STATUS_NO_QUOTA)if(!qdiv.find('.sms_yzm input').val()){qtip.text('');qtipCode.text('请输入验证码');scroll_to(qdiv);is_valid=false;}else{var captcha=qdiv.find('.sms_yzm input').val();$.ajax({url:'/mobile_auth_question_captcha_validation',type:'POST',async:false,dataType:'JSON',data:{mobile:input_val,captcha:captcha,_xsrf:$.cookie('_xsrf')},success:function(ret){if(ret.result!=200){qtip.text('');qtipCode.text(ret.error_msg);scroll_to(qdiv);is_valid=false;}else{qtip.text('');qtipCode.text('');question_captcha_map[qmodel.qid]={mobile:input_val,captcha:captcha};}}});}}else{qtip.text(checkmethod_factory.get_err_msg(checkmethod_type));scroll_to(qdiv);is_valid=false;}}}}if(is_valid){qtip.text("");qtipCode.text("");}return is_valid;}function get_answer_qblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var input=qdiv.find(".option");var input_val=input.val();var answer={};if(isNotEmpty(input_val))answer[input.attr("id")+"_open"]=input_val;return answer;}function CreateTimeOption(id,sel){if(!sel)sel=[];var hour=createOption(24,sel[0]);var minute=createOption(60,sel[1]);function createOption(m,s){var v,selected='';for(var i=0;i<m;i++){if(s==i)selected='selected="selected"';v+='<option '+selected+' value="'+i+'">'+i+'</option>';selected='';}return v;}$('#'+id+' .Time_con').html('<select class="Time_Hour"><option value="-1">小时</option>'+hour+'</select><span> : </span><select class="Time_Minute"><option value="-1">分钟</option>'+minute+'</select>');}function bind_event_qblank(qmodel){var qid=qmodel.qid;inputVal("#question_"+qid+" .option");if(qmodel.option_list[0].custom_attr.checkmethod=="mobile"&&qmodel.option_list[0].custom_attr.sms_auth=="on"){var mobileElement="#question_"+qid+" .option";var captchaElement="#captcha_"+qmodel.option_list[0]._id.$oid;if(mobile_auth_queston_status==MOBILE_AUTH_QUESTION_STATUS_NEED_GEETEST)initGeetest(captchaElement,qid,"#question_"+qid+" .btn_send_code",mobileElement);$("#question_"+qid).on("click",".btn_send_code",function(){var mobile=$("#question_"+qid+" .option").val();var $tip=$("#tip_"+qid);var $tipCode=$("#tip_code_"+qid);if(mobile=="")$tip.text("请输入手机号码");else if(!inputcheck_mobile(mobile))$tip.text("请填写正确的手机号码");else{$tip.text("");var isExistence=false;for(var k in sendCodeTimer)if(k==qid)isExistence=true;if(!isExistence)getValidateMobileCode(qid,$(this),mobile,captchaElement);else if(sendCodeTimer[qid].state)getValidateMobileCode(qid,$(this),mobile,captchaElement);}});}}function validate_answer_qblank_dropdown(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null='allow_null' in qmodel.question.custom_attr;qdiv.find(".option").each(function(){if(this.value=="")if(!allow_null)valid=false;});if(!valid){qtip.text("请确保答案完整");scroll_to(qdiv);}else qtip.text("");return valid;}function get_answer_qblank_dropdown(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".option").each(function(){answer[$(this).attr("id")+"_open"]=this.value;});return answer;}function bind_event_qblank_dropdown(qmodel){var qid=qmodel.qid;var question=qmodel.question;setTimeout(function(){qmodel.bind_drop();},20);if(question.custom_attr.drop_type==='address')inputVal("#"+question.option_list[3]._id.$oid);}function sortable_height(qid){var Px_height=[];$("#"+qid+" .Sorting li").sortable({connectWith:"#"+qid+" .pxlist tr td",receive:function(event,ui){$("#"+qid+" .Sorting li label").attr('site','').removeClass('pt_on');},stop:function(event,ui){$("#"+qid+" .pxlist tr td").each(function(index,element){var i=index+1;var l=$(this).find('label').length;if(l>1){var mbobj=$(this).find('.pt_on');var m=mbobj.attr('name')-1;$("#"+qid+" .Sorting li:eq("+m+")").append(mbobj);}$(this).find('label').attr('site',i).addClass('pt_on');});$("#"+qid+" .Sorting li label").attr('site','').removeClass('pt_on');}}).disableSelection();$("#"+qid+" .pxlist tr td").sortable({connectWith:"#"+qid+" .pxlist tr td",over:function(event,ui){ui.placeholder.parent().addClass('jda');},out:function(event,ui){ui.placeholder.parent().removeClass('jda');},start:function(event,ui){ui.item.removeClass('pt_on');},update:function(event,ui){$("#"+qid+" .pxlist tr td").removeClass('jda');},beforeStop:function(event,ui){var obj=ui.placeholder.parent();var m=ui.item.attr('site')-1;var o=obj.find('.pt_on');var l=obj.find('label').length;if(l>2)$("#"+qid+" .pxlist tr td:eq("+m+")").append(o);var name=obj.attr('name');ui.item.attr('site',name);},stop:function(event,ui){$("#"+qid+" .pxlist tr td").each(function(index,element){var i=index+1;var l=$(this).find('label').length;if(l>1){var mbobj=$(this).find('.pt_on');var m=mbobj.attr('name')-1;$("#"+qid+" .Sorting li:eq("+m+")").append(mbobj);}$(this).find('label').attr('site',i).addClass('pt_on');});$("#"+qid+" .Sorting li label").attr('site','').removeClass('pt_on');}}).disableSelection();if($('#'+qid).css('display')!='none'){$("#"+qid+" .Sorting label").each(function(index,element){var w=$(this).height();if(w<23)w=23;Px_height.push(w);});Px_height.sort(conmpare);$("#"+qid+" .Sorting label").height(Px_height[0]);$("#"+qid+" .Sorting li,.pxlist tr td").height(Px_height[0]+2);var h=Px_height.length*(Px_height[0]+18);}}function conmpare(value1,value2){if(value1>value2)return -1;else if(value1<value2)return 1;else return 0;}function validate_answer_qsort(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;qdiv.find(".pxlist tr td").each(function(){if($(this).find("label").length==0)if("allow_null" in qmodel.question.custom_attr){}else{valid=false;return;}});if(!valid){qtip.text("请对所有选项进行排序");scroll_to(qdiv);}else qtip.text("");return valid;}function get_answer_qsort(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};var sort_tr=qdiv.find(".pxlist tr");for(var i=0;i<sort_tr.length;i++){var tr=sort_tr[i];var la=$(tr).find(".pxla");if(la.length>0){var option_id=$(la).attr("id");answer[option_id]=[i+1];}}return answer;}function bind_event_qsort(qmodel){setTimeout(function(){sortable_height("question_"+qmodel.qid);},1000);}function pt_score(qid){this.mb=$("#"+qid);this.obj={};var score_title=this.mb.find(".score_title");var table_score=this.mb.find(".table_score_v2");var minnum=parseInt(this.mb.attr("minnum"));var maxnum=parseInt(this.mb.attr("maxnum"));var option_num=maxnum-minnum+1;var score_display=this.mb.attr("score_display");var table_score_width=table_score.width();if(score_display=="op_slider"){this.mb.find(".s_tag_m").css("width",50/(option_num-1)+"%");this.mb.find(".s_tag_c").css("width",100/(option_num-1)+"%");this.mb.find(".score_slider").slider({min:minnum*500,max:maxnum*500,range:"min",create:function(event,ui){$(this).find(".ui-slider-handle").append('<span class="num"></span><div class="score_widget_tc disp_none"></div>');},slide:function(event,ui){var ui_state_default=$(this).find(".ui-state-default");ui_state_default.addClass("slider_def");ui_state_default.find(".num").text("");var abLeft=ui_state_default[0].style.left;if(!abLeft)abLeft="0%";var val=Math.round(ui.value/500);if(val>maxnum)val=maxnum;$(this).find(".score_widget_tc").removeClass("disp_none").text(val);$(this).parents(".score_row").find(".score").text(val);},stop:function(event,ui){var score=$(this).parents(".score_row").find(".score").text();var ui_state_default=$(this).find(".ui-state-default");if(score!=""){ui_state_default.removeClass("slider_def").removeClass("slider_def_gray").addClass("slider_def_blue");$(this).parent().find(".score_widget_tc").addClass("disp_none");ui_state_default.find(".num").text(score);}var q_id=qid.replace("question_","");answer_question_logic_event(q_id);}});this.mb.find(".score_slider .ui-state-default").addClass("slider_def").addClass("slider_def_gray");}else{var icon_width=this.mb.find(".div_float:first .score_i:first").width();var margin_width=table_score_width/option_num-icon_width;var score_title_width=table_score_width-margin_width;table_score.find("td").css("width",100/option_num+"%");score_title.css({"width":score_title_width,"margin-left":margin_width/2});this.event=function(){var _this=this;$(".table_score .div_float",_this.mb).off().on({mouseenter:function(){_this.select($(this));},click:function(){var parents=$(this).parents(".table_score");$(".div_float",parents).off('mouseenter');$(this).addClass('active').siblings().removeClass('active');_this.select($(this));}});$(".table_score",_this.mb).off().on('mouseleave',function(){var parents=$(this);var history_obj=parents.parent().parent().find(".active");if(history_obj.length>0)$(".div_float",parents).removeClass('back_max');else{parents.parent().parent().find('.score').text('');$(".div_float",parents).removeClass('back_n').removeClass('back_max');}});};this.select=function(obj){var Parent=obj.parents('.table_score');var dx=$(".div_float",Parent);var m=dx.index(obj);Parent.parent().parent().find('.score').text(obj.attr("score_v"));dx.removeClass('back_n').removeClass("back_max");dx.each(function(index,element){if(index>m)return false;$(this).addClass('back_n');if(index==m)$(this).addClass('back_max');});};this.history=function(obj){var Parent=obj.parents('.table_score');var dx=$(".div_float",Parent);var m=dx.index(obj);Parent.parent().parent().find('.score').text(obj.attr("score_v"));dx.removeClass('back_n').removeClass("back_max");dx.each(function(index,element){if(index>m)return false;$(this).addClass('back_n');});};return this.event();}}function validate_answer_qscore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;qdiv.find(".data_row .score").each(function(){var score=$(this).text();if(score=="")if("allow_null" in qmodel.question.custom_attr){}else valid=false;if(isNaN(score))valid=false;});if(!valid){qtip.text("请为所有选项打分");scroll_to(qdiv);}else qtip.text("");return valid;}function get_answer_qscore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".data_row .score").each(function(){var score=$(this).text();var option_answer=[];var option_id=this.id.replace("option_","");option_answer.push(score);answer[option_id]=option_answer;});return answer;}function bind_event_qscore(qmodel){new pt_score("question_"+qmodel.qid);}function validate_answer_qmatrixsingle(qmodel){if("is_swap" in qmodel.question.custom_attr)return validate_swap_qmatrixsingle(qmodel);return validate_default_qmatrixsingle(qmodel);}function validate_default_qmatrixsingle(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;qdiv.find('.option_tip').text("");qdiv.find(".data_row").each(function(){var radio=$(this).find("input:radio:checked");if(radio.length==0)if("allow_null" in qmodel.question.custom_attr)return true;else{valid=false;$(this).find("td").addClass("invalid");}else{$(this).find("span.option_tip").text("");var option_id=radio.attr("id").split("_")[2];var option=get_option(qmodel.qid,option_id);var input=get_parent(radio,"td").find("input:text");var option_tip=input.parent().find(".option_tip");if(option.is_open){if(input.val()==""&&!option.custom_attr.hasOwnProperty("allow_null")){valid=false;$(this).find("td").addClass("invalid");}else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(input.val().length>char_count){qmodel.show_option_msg(input.attr('id'),"已超出{0}个字".format([input.val().length-parseInt(char_count)]));valid=false;}else qmodel.clear_option_msg(input.attr('id'));}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(input.val())){if(valid){option_tip.text("");$(this).find("td").removeClass("invalid");}}else{option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));valid=false;$(this).find("td").addClass("invalid");}}}}}else{option_tip.text("");$(this).find("td").removeClass("invalid");}}});if(valid){qtip.text("");return true;}else{qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}function validate_swap_qmatrixsingle(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;for(var i=0;i<qmodel.question.matrixrow_list.length;i++){var radio=qdiv.find(".matrix_table td:nth-child("+(i+2)+") input:radio:checked");if(radio.length==0)if("allow_null" in qmodel.question.custom_attr)continue;else{valid=false;qdiv.find(".matrix_table td:nth-child("+(i+2)+")").addClass("invalid");}else{qdiv.find(".matrix_table td:nth-child("+(i+2)+")").find("span.option_tip").text("");var option_id=radio.attr("id").split("_")[2];var option=get_option(qmodel.qid,option_id);var input=get_parent(radio,"td").find("input:text");var option_tip=input.parent().find(".option_tip");if(option.is_open){if(input.val()==""&&!option.custom_attr.hasOwnProperty("allow_null")){option_tip.text("请输入填空项的内容");valid=false;qdiv.find(".matrix_table td:nth-child("+(i+2)+")").addClass("invalid");}else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(input.val().length>char_count){qmodel.show_option_msg(input.attr('id'),"已超出{0}个字".format([input.val().length-parseInt(char_count)]));valid=false;}else qmodel.clear_option_msg(input.attr('id'));}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(input.val())){if(valid){option_tip.text("");qdiv.find(".matrix_table td:nth-child("+(i+2)+")").removeClass("invalid");}}else{option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));valid=false;qdiv.find(".matrix_table td:nth-child("+(i+2)+")").addClass("invalid");}}}}}else{option_tip.text("");qdiv.find(".matrix_table td:nth-child("+(i+2)+")").removeClass("invalid");}}}if(valid){qtip.text("");return true;}else{qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}function get_answer_qmatrixsingle(qmodel){if("is_swap" in qmodel.question.custom_attr)return get_answer_swap_qmatrixsingle(qmodel);return get_answer_default_qmatrixsingle(qmodel);}function get_answer_default_qmatrixsingle(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".data_row").each(function(){var option_answer=[];var radio=$(this).find("input:radio:checked");if(radio.length==0)return;var row_id=radio.attr("id").split("_")[1];var option_id=radio.attr("id").split("_")[2];option_answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(option.is_open){var input=get_parent(radio,"td").find("input:text");if(isNotEmpty(input.val()))option_answer.push(input.val());}answer[row_id]=option_answer;});return answer;}function get_answer_swap_qmatrixsingle(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};for(var i=0;i<qmodel.question.matrixrow_list.length;i++){var option_answer=[];var radio=qdiv.find(".matrix_table td:nth-child("+(i+2)+") input:radio:checked");if(radio.length==0)continue;var row_id=radio.attr("id").split("_")[1];var option_id=radio.attr("id").split("_")[2];option_answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(option.is_open){var input=get_parent(radio,"td").find("input:text");if(isNotEmpty(input.val()))option_answer.push(input.val());}answer[row_id]=option_answer;}return answer;}function bind_event_qmatrixsingle(qmodel){var qid=qmodel.qid;inputVal("#question_"+qid+" .option_open");$("#question_"+qid+" .data_row td").mouseup(function(){$(this).find(".jqTransformRadioWrapper a").click();});}function validate_answer_qmatrixmultiple(qmodel){if("is_swap" in qmodel.question.custom_attr)return validate_swap_qmatrixmultiple(qmodel);return validate_default_qmatrixmultiple(qmodel);}function validate_default_qmatrixmultiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null="allow_null" in qmodel.question.custom_attr;var min_answer_num=0;var max_answer_num=0;if(qmodel.question.custom_attr.hasOwnProperty("min_answer_num"))min_answer_num=parseInt(qmodel.question.custom_attr.min_answer_num);if(qmodel.question.custom_attr.hasOwnProperty("max_answer_num"))max_answer_num=parseInt(qmodel.question.custom_attr.max_answer_num);qdiv.find('.option_tip').text("");qdiv.find(".data_row").each(function(){var boxes=$(this).find("input:checkbox:checked");if(boxes.length==0)if(!allow_null){valid=false;$(this).find("td").addClass("invalid");}else return true;else{var row_valid=true;$(this).find("span.option_tip").text("");boxes.each(function(){var option_id=$(this).attr("id").split("_")[2];var option=get_option(qmodel.qid,option_id);if(option.is_open){var input=get_parent($(this),"td").find("input:text");var option_tip=input.parent().find(".option_tip");var input_val=input.val();if(input_val==""&&!option.custom_attr.hasOwnProperty("allow_null"))row_valid=false;else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(input.val().length>char_count){qmodel.show_option_msg(input.attr('id'),"已超出{0}个字".format([input_val.length-parseInt(char_count)]));row_valid=false;}else qmodel.clear_option_msg(input.attr('id'));}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(input_val)){}else{row_valid=false;option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));}}}}}});if(min_answer_num>boxes.length&&min_answer_num!=0){qtip.text("每行至少选择{0}个选项".format([min_answer_num]));row_valid=false;}else if(max_answer_num<boxes.length&&max_answer_num!=0){qtip.text("每行最多选择{0}个选项".format(max_answer_num));row_valid=false;}if(row_valid)$(this).find("td").removeClass("invalid");else{valid=false;$(this).find("td").addClass("invalid");}}});if(valid){qtip.text("");return true;}else{qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}function validate_swap_qmatrixmultiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null="allow_null" in qmodel.question.custom_attr;var min_answer_num=0;var max_answer_num=0;if(qmodel.question.custom_attr.hasOwnProperty("min_answer_num"))min_answer_num=parseInt(qmodel.question.custom_attr.min_answer_num);if(qmodel.question.custom_attr.hasOwnProperty("max_answer_num"))max_answer_num=parseInt(qmodel.question.custom_attr.max_answer_num);for(var i=0;i<qmodel.matrixrow_list.length;i++){var column=qdiv.find(".matrix_table td:nth-child("+(i+2)+")");var boxes=column.find("input:checkbox:checked");if(boxes.length==0)if(!allow_null){valid=false;column.addClass("invalid");}else return true;else{var row_valid=true;column.find("span.option_tip").text("");boxes.each(function(){var option_id=$(this).attr("id").split("_")[2];var option=get_option(qmodel.qid,option_id);if(option.is_open){var input=get_parent($(this),"td").find("input:text");var option_tip=input.parent().find(".option_tip");var input_val=input.val();if(input_val==""&&!option.custom_attr.hasOwnProperty("allow_null")){row_valid=false;option_tip.text("请输入填空项的内容");}else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(input.val().length>char_count){qmodel.show_option_msg(input.attr('id'),"已超出{0}个字".format([input_val.length-parseInt(char_count)]));row_valid=false;}else qmodel.clear_option_msg(input.attr('id'));}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(input_val)){}else{row_valid=false;option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));}}}}}});if(min_answer_num>boxes.length&&min_answer_num!=0){qtip.text("每列至少选择{0}个选项".format([min_answer_num]));row_valid=false;}else if(max_answer_num<boxes.length&&max_answer_num!=0){qtip.text("每列最多选择{0}个选项".format([max_answer_num]));row_valid=false;}if(row_valid)column.removeClass("invalid");else{valid=false;column.addClass("invalid");}}}if(valid){qtip.text("");return true;}else{qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}function get_answer_qmatrixmultiple(qmodel){if("is_swap" in qmodel.question.custom_attr)return get_answer_swap_qmatrixmultple(qmodel);return get_answer_default_qmatrixmultiple(qmodel);}function get_answer_default_qmatrixmultiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".data_row").each(function(){var row_answer=[];var boxes=$(this).find("input:checkbox:checked");if(boxes.length==0)return;var row_id=this.id;boxes.each(function(){var option_answer=[];var option_id=this.id.split("_")[2];option_answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(option.is_open){var input=get_parent($(this),"td").find("input:text");if(isNotEmpty(input.val()))option_answer.push(input.val());}row_answer.push(option_answer);});answer[row_id]=row_answer;});return answer;}function get_answer_swap_qmatrixmultple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};for(var i=0;i<qmodel.matrixrow_list.length;i++){var column=qdiv.find(".matrix_table td:nth-child("+(i+2)+")");var row_answer=[];var boxes=column.find("input:checkbox:checked");if(boxes.length==0)return;var row_id="";boxes.each(function(){var option_answer=[];var option_id=this.id.split("_")[2];row_id=this.id.split("_")[1];option_answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(option.is_open){var input=get_parent($(this),"td").find("input:text");if(isNotEmpty(input.val()))option_answer.push(input.val());}row_answer.push(option_answer);});answer[row_id]=row_answer;}return answer;}function bind_event_qmatrixmultple(qmodel){var qid=qmodel.qid;option_exclusive_qmatrixmultiple(qid);inputVal("#question_"+qid+" .option_open");$("#question_"+qid+" .data_row td").mousedown(function(){$(this).find(".jqTransformCheckboxWrapper a").click();});}function option_exclusive_qmatrixmultiple(qid){var qmodel=get_qmodel(qid);var qdiv=$("#question_"+qmodel.qid);if("is_swap" in qmodel.question.custom_attr){for(var i=0;i<qmodel.question.matrixrow_list.length;i++)qdiv.find(".matrix_table td:nth-child("+(i+2)+") input:checkbox.option").on("change",function(){var tr=get_parent(this,"tr");var td=get_parent(this,"td");var index=tr.find(".data_td").index(td);var column=qdiv.find(".matrix_table td:nth-child("+(index+1)+")");if($(this).attr("exclusive")){if(this.checked)column.find(".option").not(this).each(function(){if(this.checked)$(this).prev().click();});}else if(this.checked)column.find(".option[exclusive=1]").each(function(){if(this.checked)$(this).prev().click();});});}else qdiv.find(".data_row").each(function(){var data_row=$(this);$(this).find(".option").on("change",function(){if($(this).attr("exclusive")){if(this.checked)data_row.find(".option").not(this).each(function(){if(this.checked)$(this).prev().click();});}else if(this.checked)data_row.find(".option[exclusive=1]").each(function(){if(this.checked)$(this).prev().click();});});});}function validate_answer_qmatrixblank(qmodel){if("is_swap" in qmodel.question.custom_attr)return validate_swap_qmatrixblank(qmodel);return validate_default_qmatrixblank(qmodel);}function validate_default_qmatrixblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null="allow_null" in qmodel.question.custom_attr;qdiv.find('.option_tip').text("");qdiv.find(".data_row").each(function(){var texts=$(this).find("textarea");var row_valid=true;texts.each(function(){var option_id=this.id.split("_")[2];var option=get_option(qmodel.qid,option_id);var option_tip=get_parent(this,"td").find(".option_tip");if(this.value=="")if(allow_null||"allow_null" in option.custom_attr)return true;else row_valid=false;else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(this.value.length>parseInt(char_count)){qmodel.show_option_msg(this.id,"已超出{0}个字".format([this.value.length-parseInt(char_count)]));row_valid=false;}else qmodel.clear_option_msg(this.id);}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(this.value)){if(row_valid)option_tip.text("");}else{option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));row_valid=false;}}}}});if(row_valid)$(this).find("td").removeClass("invalid");else{$(this).find("td").addClass("invalid");valid=false;}});if(valid)qtip.text("");else{scroll_to(qdiv);qtip.text("请检查该题目的答案");}return valid;}function validate_swap_qmatrixblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null="allow_null" in qmodel.question.custom_attr;for(var i=0;i<qmodel.matrixrow_list.length;i++){var column=qdiv.find(".matrix_table td:nth-child("+(i+2)+")");var texts=column.find("textarea");var row_valid=true;texts.each(function(){var option_tip=get_parent(this,"td").find(".option_tip");var option_id=this.id.split("_")[2];var option=get_option(qmodel.qid,option_id);if(this.value=="")if(allow_null||"allow_null" in option.custom_attr)return true;else row_valid=false;else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(this.value.length>parseInt(char_count)){qmodel.show_option_msg(this.id,"已超出{0}个字".format([this.value.length-parseInt(char_count)]));row_valid=false;}else qmodel.clear_option_msg(this.id);}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(this.value)){if(row_valid)option_tip.text("");}else{option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));row_valid=false;}}}});if(row_valid)column.removeClass("invalid");else{column.addClass("invalid");valid=false;}}if(valid)qtip.text("");else qtip.text("请检查该题目的答案");return valid;}function get_answer_qmatrixblank(qmodel){if("is_swap" in qmodel.question.custom_attr)return get_answer_swap_qmatrixblank(qmodel);return get_answer_default_qmatrixblank(qmodel);}function get_answer_default_qmatrixblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".data_row").each(function(){var row_answer={};var row_id=null;$(this).find("textarea").each(function(){row_id=this.id.split("_")[1];var option_id=this.id.split("_")[2];row_answer[option_id]=this.value;});answer[row_id]=row_answer;});return answer;}function get_answer_swap_qmatrixblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};for(var i=0;i<qmodel.matrixrow_list.length;i++){var column=qdiv.find(".matrix_table td:nth-child("+(i+2)+")");var row_answer={};var row_id=null;column.find("textarea").each(function(){row_id=this.id.split("_")[1];var option_id=this.id.split("_")[2];row_answer[option_id]=this.value;});answer[row_id]=row_answer;}return answer;}function bind_event_qmatrixblank(qmodel){inputVal("#question_"+qmodel.qid+" .option_open");}function matrix_score(qid){$('#'+qid+' .matrix_score').on('click',function(){var parent=$(this).parent().parent();var m=$('.matrix_score',parent).index($(this));$('.matrix_score',parent).attr('src',star_off).attr("stat","off");$('.matrix_score',parent).each(function(index,element){if(index>m)return false;$(this).attr('src',star_on).attr("stat","on");});});}function validate_answer_qmatrixscore(qmodel){if("is_swap" in qmodel.question.custom_attr)return validate_swap_qmatrixscore(qmodel);return validate_default_qmatrixscore(qmodel);}function validate_default_qmatrixscore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null="allow_null" in qmodel.question.custom_attr;qdiv.find(".data_row").each(function(){var row_valid=true;$(this).find(".score_td").each(function(){if($(this).find("img[stat=on]").length==0)if(allow_null)return true;else row_valid=false;});if(!row_valid){$(this).find("td").addClass("invalid");valid=false;}else $(this).find("td").removeClass("invalid");});if(valid)qtip.text("");else{qtip.text("请为所有选项打分");scroll_to(qdiv);}return valid;}function validate_swap_qmatrixscore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var allow_null="allow_null" in qmodel.question.custom_attr;for(var i=0;i<qmodel.matrixrow_list.length;i++){var column=qdiv.find(".matrix_table td.score_td:nth-child("+(i+2)+")");var row_valid=true;column.each(function(){if($(this).find("img[stat=on]").length==0)if(allow_null)return;else row_valid=false;});if(!row_valid){column.addClass("invalid");valid=false;}else column.removeClass("invalid");}if(valid)qtip.text("");else{scroll_to(qdiv);qtip.text("请为所有选项打分");}return valid;}function get_answer_qmatrixscore(qmodel){if("is_swap" in qmodel.question.custom_attr)return get_answer_swap_qmatrixscore(qmodel);return get_answer_default_qmatrixscore(qmodel);}function get_answer_default_qmatrixscore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".data_row").each(function(){var row_answer={};var row_id=null;$(this).find(".score_td").each(function(){row_id=this.id.split("_")[1];var option_id=this.id.split("_")[2];var score=$(this).find("img[stat=on]").length+"";row_answer[option_id]=score;});answer[row_id]=row_answer;});return answer;}function get_answer_swap_qmatrixscore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};for(var i=0;i<qmodel.matrixrow_list.length;i++){var column=qdiv.find(".matrix_table td.score_td:nth-child("+(i+2)+")");var row_answer={};var row_id=null;column.each(function(){row_id=this.id.split("_")[1];var option_id=this.id.split("_")[2];var score=$(this).find("img[stat=on]").length+"";row_answer[option_id]=score;});answer[row_id]=row_answer;}return answer;}function bind_event_qmatrixscore(qmodel){matrix_score("question_"+qmodel.qid);}function validate_answer_qmultipleblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;qdiv.find(".option").each(function(){var input_val=$.trim($(this).val());var option_tip=$(this).next();var option_id=this.id.replace("option_","");var option=get_option(qmodel.qid,option_id);var row_valid=true;if(!isNotEmpty(input_val))if("allow_null" in qmodel.question.custom_attr||"allow_null" in option.custom_attr)option_tip.text("");else{option_tip.text("请输入内容");row_valid=false;}else{if('char_count_limit' in option.custom_attr){var char_count=option.custom_attr.char_count;if(input_val.length>parseInt(char_count)){qmodel.show_option_msg(this.id,"已超出{0}个字".format([input_val.length-parseInt(char_count)]));row_valid=false;}else qmodel.clear_option_msg(this.id);}if("checkmethod" in option.custom_attr){var checkmethod_type=option.custom_attr.checkmethod;if(isNotEmpty(checkmethod_type)){var checkmethod=checkmethod_factory.get_method(checkmethod_type);if(checkmethod(input_val)){}else{option_tip.text(checkmethod_factory.get_err_msg(checkmethod_type));row_valid=false;}}}}if(!row_valid)valid=false;else option_tip.text("");});if(valid){qtip.text("");return true;}else{qtip.text("请检查该题目的答案");scroll_to(qdiv);return false;}}function get_answer_qmultipleblank(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".option").each(function(){var option_id=this.id.replace("option_","");if(isNotEmpty($(this).val()))answer[option_id+"_open"]=$(this).val();});return answer;}function bind_event_qmultipleblank(qmodel){inputVal("#question_"+qmodel.qid+" .option");}var bigImg={showImg:function(obj,url){_hmt.push(['_trackEvent','image_select_question','click','zoomIn']);var _this=$(obj);_this.parent().find('.help_paly').hide();if(url=='undefined'||url==null||url==" ")url=obj.src;this.img=new Image();var ImgParent=_this.parent();ImgParent.css({'position':'relative'});var loadimgT=_this.height()/2-8;var loadimgL=_this.width()/2-8;var Loadimg=$('<img style="position:absolute;width:16px;height:16px" src="/static/images/loading.gif"/>').css({'left':''+loadimgL+'px','top':''+loadimgT+'px'}).appendTo(ImgParent);var imgobj=this;imgobj.img.onload=function(){Loadimg.remove();$('.help_paly').show();var Nimgw=imgobj.img.width;var Nimgh=imgobj.img.height;var Wz=document.documentElement.clientWidth||document.body.clientWidth;var Hz=document.documentElement.clientHeight||document.body.clientHeight;if(Nimgh>Hz-30&&Nimgw<Wz-30){Nimgh=Hz-30;Nimgw=(Hz-30)/imgobj.img.height*Nimgw;}else if(Nimgw>Wz-30){Nimgw=Wz-30;Nimgh=(Wz-30)/imgobj.img.width*Nimgh;}var wc=Nimgw/2;var hc=Nimgh/2;var tccL=Wz/2-wc;var tccT=Hz/2-hc;var pic_cancel=$('<div class="pic_cancel"></div>').appendTo('body');var NewImg=$('<img src="'+imgobj.img.src+'"></img>').appendTo('body');if(window.top.length==0){var offsetT=_this.offset().top;var offsetL=_this.offset().left;}else{var offsetL=tccL;var offsetT=-100;}NewImg.css({'position':'absolute','z-index':'4000','top':''+offsetT+'px','left':''+offsetL+'px','width':''+_this.width()+'px','height':''+_this.height()+'px'});pic_cancel.css({'z-index':'4100','top':''+(offsetT-18)+'px','left':''+(offsetL+_this.width()-18)+'px'});var makObj=$('<div style="position:fixed; display:block;left:0px; top:0px; width:100%; height: 100%; z-index:3000; "><div style="position:absolute;left:0px; top:0px; width:100%; height: 100%; opacity:0; display: block; background:#0E1011;" class="mak"></div></div>').appendTo('body');makObj.find('.mak').animate({opacity:0.6},'slow');var collt=$(document).scrollTop();setTimeout(function(){NewImg.animate({left:''+tccL+'',top:''+(tccT+collt)+'',width:''+Nimgw+'',height:''+Nimgh+''},'slow');pic_cancel.animate({left:''+(Nimgw+tccL-18)+'',top:''+(tccT+collt-18)+''},'slow');},250);pic_cancel.click(function(){makObj.click();});makObj.click(function(){var _this=$(this);_this.animate({opacity:'0'},650);setTimeout(function(){_this.remove();},650);NewImg.remove();pic_cancel.remove();this.img=false;});$('.jsbox_close').live('click',function(){bigImg.img.onload=false;});};this.img.src=url;}};function validate_answer_for_q_image_single(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);if(qdiv.find(".option:checked").length==0)if(qdiv.attr("allow_null")){qtip.html("");return true;}else{qtip.html("请选择一个选项");scroll_to(qdiv);return false;}else{var radio=qdiv.find(".option:checked");var option_id=radio.attr("id").replace("option_","");var option=get_option(qmodel.qid,option_id);if(option.is_open){var open_input=qdiv.find("#option_open_"+get_oid(option));var open_tip=open_input.next();if(open_input.val()==""){open_tip.text("请输入内容");qtip.text("请检查该题目的内容");scroll_to(qdiv);return false;}else if("checkmethod" in option.custom_attr){var checkmethod=checkmethod_factory.get_method(option.custom_attr.checkmethod);if(checkmethod(open_input.val()))open_tip.text("");else{open_tip.text("输入格式有误, 请输入正确内容");qtip.text("请检查填空项输入内容");scroll_to(qdiv);return false;}}else{open_tip.text("");qtip.text("");return true;}}qtip.html("");return true;}}function get_answer_q_image_single(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer=[];var checked_radio=qdiv.find(".option:checked");if(checked_radio.length>0){var option_id=checked_radio.val().split("_")[0];answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(isNotEmpty(option))if(option.is_open){var option_input=qdiv.find("#option_open_"+option_id);answer.push(option_input.val());}}return answer;}function bind_event_qimagevote_single(qmodel){if('data_show' in qmodel.question.custom_attr)qImageVoteHandle(qmodel.qid);}function validate_answer_q_image_multiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var custom_attr=qmodel.question.custom_attr;var checked_count=qdiv.find(".option:checked").length;if(checked_count==0){if("allow_null" in qmodel.question.custom_attr)return true;qtip.text("请选择选项");scroll_to(qdiv);return false;}var min_answer_num=0;var max_answer_num=0;if(qmodel.question.custom_attr.hasOwnProperty("min_answer_num"))min_answer_num=parseInt(qmodel.question.custom_attr.min_answer_num);if(qmodel.question.custom_attr.hasOwnProperty("max_answer_num"))max_answer_num=parseInt(qmodel.question.custom_attr.max_answer_num);if(min_answer_num>checked_count&&min_answer_num!=0){qtip.text("请至少选择{0}个选项".format([min_answer_num]));scroll_to(qdiv);return false;}else if(max_answer_num<checked_count&&max_answer_num!=0){qtip.text("最多只能选择{0}个选项".format([max_answer_num]));scroll_to(qdiv);return false;}var open_valid=true;qdiv.find(".option:checked").each(function(){var option_id=$(this).attr("id").replace("option_","");var option=get_option(qmodel.qid,option_id);if(option.is_open){var open_input=qdiv.find("#option_open_"+get_oid(option));var open_tip=open_input.next();if(open_input.val()==""){open_tip.text("请选择一个选项");qtip.text("请检查该题目的内容");open_valid=false;}else if("checkmethod" in option.custom_attr){var checkmethod=checkmethod_factory.get_method(option.custom_attr.checkmethod);if(checkmethod(open_input.val()))open_tip.text("");else{open_tip.text("输入格式有误, 请输入正确内容");qtip.text("输入内容格式有误");open_valid=false;}}}});if(open_valid)qtip.text("");else scroll_to(qdiv);return open_valid;}function get_answer_q_image_multiple(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer=[];qdiv.find(".option:checked").each(function(){var option_answer=[];var option_id=$(this).attr("id").replace("option_","");option_answer.push(option_id);var option=get_option(qmodel.qid,option_id);if(option.is_open){var open_input=qdiv.find("#option_open_"+get_oid(option));option_answer.push(open_input.val());}answer.push(option_answer);});return answer;}function bind_event_q_image_multiple(qmodel){option_exclusive_multiple(qmodel.qid);}function bind_event_qimagevote_multiple(qmodel){var qid=qmodel.qid;option_exclusive_multiple(qid);if('data_show' in qmodel.question.custom_attr)qImageVoteHandle(qid);}function validate_answer_qblank_date(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var input_val=qdiv.find("input:text").val();if(!isNotEmpty(input_val))if("allow_null" in qmodel.question.custom_attr){qtip.text("");return true;}else{qtip.text("请选择日期");scroll_to(qdiv);return false;}else{qtip.text("");return true;}}function get_answer_qblank_date(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var input=qdiv.find(".option");var input_val=input.val();var answer={};answer[input.attr("id")+"_open"]=input_val;return answer;}function bind_event_qblank_date(qmodel){var question=qmodel.question;$("#"+question.option_id_list[0]).Zebra_DatePicker({show_week_number:"周"});}function validate_answer_qblank_time(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var is_valid=true;qdiv.find(".option").each(function(){var input_val=$(this).val();if(!isNotEmpty(input_val))if("allow_null" in qmodel.question.custom_attr)qtip.text("");else{qtip.text("请对小时和分钟都进行选择");is_valid=false;}});if(is_valid)qtip.text("");else scroll_to(qdiv);return is_valid;}function get_answer_qblank_time(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".option").each(function(){var option_id=this.id.replace("option_","");answer[option_id+"_open"]=$(this).val();});return answer;}function bind_event_qblank_time(qmodel){}function get_answer_qblank_geographical(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".option").each(function(){var option_id=this.id.replace("option_","");answer[option_id+"_open"]=$(this).val();});return answer;}function bind_event_qblank_geographical(qmodel){new pt_geographical_multiple_blank("question_"+qmodel.qid);}function validate_answer_qblank_geographical(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var is_valid=true;qdiv.find(".option").each(function(){var input_val=$(this).val();if(!isNotEmpty(input_val))if("allow_null" in qmodel.question.custom_attr)qtip.text("");else{qtip.text("请点击获取地理位置");is_valid=false;}});if(is_valid)qtip.text("");else scroll_to(qdiv);return is_valid;}function pt_geographical_multiple_blank(qid){this.mb=$("#"+qid);this.obj={};var not_allow_modify_position=false;if("not_allow_modify_position" in get_question(qid.replace('question_','')).custom_attr){not_allow_modify_position=true;this.mb.find(".geographical_input").hide();}this.event=function(){var _this=this;$(".map_a,.current_location_btn",_this.mb).off().on({click:function(){if($(this).hasClass("map_a"))$(this).hide();$(this).next().removeClass('disp_none');if(!_this.map)_this.map=new AMap.Map("map_"+qid.replace('question_',''),{resizeEnable:true});if(!not_allow_modify_position)_this.map.on("click",function(e){_this.getGeoAddress(e);});_this.map.plugin('AMap.Geolocation',function(){geolocation=new AMap.Geolocation({enableHighAccuracy:true,timeout:10000,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:true,buttonPosition:'RB'});_this.map.addControl(geolocation);geolocation.getCurrentPosition();AMap.event.addListener(geolocation,'complete',onComplete);AMap.event.addListener(geolocation,'error',onError);});function onComplete(data){var address=data.formattedAddress;var lng=data.position.getLng();var lat=data.position.getLat();_this.mb.find(".geographical_address").text(address);_this.mb.find(".geographical_coord").text('经度：'+lng+'、纬度：'+lat);$("#"+qid+' .address').val(address);$("#"+qid+' .longitude').val(lng);$("#"+qid+' .latitude').val(lat);}function onError(data){_this.map.plugin('AMap.CitySearch',function(){var citysearch=new AMap.CitySearch();citysearch.getLocalCity(function(status,result){if(status==='complete'&&result.info==='OK'){if(result&&result.city&&result.bounds){var lng=(result.bounds.northeast.lng+result.bounds.southwest.lng)/2;var lat=(result.bounds.northeast.lat+result.bounds.southwest.lat)/2;_this.geoAddress(lng,lat);}}else alert("定位失败");});});}if(window.self!=window.top){var iframeObj=$(".formIframe",parent.document);iframeObj.css({"height":$(document).outerHeight()});}}});$(".geographical_clear_btn",_this.mb).off().on("click",function(){_this.mb.find(".map_a").show();_this.mb.find(".geographical_content").addClass('disp_none');$("#"+qid+' .address').val('');$("#"+qid+' .longitude').val('');$("#"+qid+' .latitude').val('');if(window.self!=window.top){var iframeObj=$(".formIframe",parent.document);iframeObj.css({"height":$("body").outerHeight()+10});}});$(".geographical_search_btn",_this.mb).off().on("click",function(){var select_val=_this.mb.find('input.search_input').val();var $this=$(this);if($.trim(select_val)==""||$this.hasClass("disabled"))return;$this.addClass("disabled");_this.map.clearMap();AMap.service(["AMap.PlaceSearch"],function(){var placeSearch=new AMap.PlaceSearch({});placeSearch.search(select_val,function(status,result){if(status==='complete'&&result.info==='OK')placeSearch_CallBack(result);});function placeSearch_CallBack(result){var data=result.poiList.pois[0];var address=data.address;var lng=data.location.lng;var lat=data.location.lat;var marker=new AMap.Marker({map:_this.map,position:data.location});_this.map.setCenter(marker.getPosition());_this.mb.find(".geographical_address").text(address);_this.mb.find(".geographical_coord").text('经度：'+lng+'、纬度：'+lat);$("#"+qid+' .address').val(address);$("#"+qid+' .longitude').val(lng);$("#"+qid+' .latitude').val(lat);}});$this.removeClass("disabled");});};this.getGeoAddress=function(point){var _this=this;var lng=point.lnglat.getLng();var lat=point.lnglat.getLat();_this.geoAddress(lng,lat);};this.geoAddress=function(lng,lat){var _this=this;_this.map.clearMap();var lnglatXY=[lng,lat];function regeocoder(){var geocoder=new AMap.Geocoder({radius:1000,extensions:"all"});geocoder.getAddress(lnglatXY,function(status,result){if(status==='complete'&&result.info==='OK')geocoder_CallBack(result);});var marker=new AMap.Marker({map:_this.map,position:lnglatXY});_this.map.setFitView();}function geocoder_CallBack(data){var address=data.regeocode.formattedAddress;_this.mb.find(".geographical_address").text(address);_this.mb.find(".geographical_coord").text('经度：'+lng+'、纬度：'+lat);$("#"+qid+' .address').val(address);$("#"+qid+' .longitude').val(lng);$("#"+qid+' .latitude').val(lat);}regeocoder();};return this.event();}var sendCodeTimer={};function getValidateMobileCode(qid,obj,mobile,captchaElement){if(mobile_auth_queston_status==MOBILE_AUTH_QUESTION_STATUS_NEED_GEETEST){var captchaResp=$(captchaElement).parent().find('[name=luotest_response]').val();if(!captchaResp)$("#tip_"+qid).text('请完成下方人机验证');else sendValidateMobileCode(qid,obj,mobile,captchaResp);}else sendValidateMobileCode(qid,obj,mobile);}function sendValidateMobileCode(qid,obj,mobile,captchaResp){var qmodel=get_qmodel(qid);var get_answer_func=qmodel.get_getanswer_function();var answer=toJSONString(get_answer_func(qmodel));sendCodeTimer[qid]={"timer":null,"state":false};var data={mobile:mobile,answer:answer,_xsrf:$.cookie('_xsrf'),qid:qid};if(captchaResp)data.lsm_resp=captchaResp;$.ajax({url:'/mobile_auth_question_captcha/'+project.short_id,type:'POST',dataType:'JSON',data:data,success:function(ret){if(ret.result!=200){setTimeout(function(){sendCodeTimer[qid].state=true;},1000);if(ret.result==1)$("#tip_"+qid).text(ret.error_msg);else if(ret.result==2)$("#tip_code_"+qid).text(ret.error_msg);else if(ret.result==3)loadMack({off:'on',Limg:0,text:ret.error_msg,set:1500});else if(ret.result==4){$('#question_'+qid+' .sms_yzm').hide();mobile_auth_queston_status=MOBILE_AUTH_QUESTION_STATUS_NO_QUOTA;}}else{$("#tip_code_"+qid).text('');var iCountDownNum=59;sendCodeTimer[qid].timer=setInterval(function(){if(iCountDownNum<=0){clearInterval(sendCodeTimer[qid].timer);sendCodeTimer[qid]={"timer":null,"state":true};obj.removeClass('btn_disabled').html('发送短信验证码');}else{iCountDownNum--;obj.addClass('btn_disabled').html('重新发送'+iCountDownNum);}},1000);}},error:function(err){setTimeout(function(){sendCodeTimer[qid].state=true;},1000);}});}function initGeetest(captchaDiv,qid,captchaElement,mobileElement){$(captchaDiv).after('<div class="l-captcha" data-site-key="0a9fb0634a5d21c3764386c05bd1ed9b" style="margin-top: 10px;"></div><script src="//captcha.luosimao.com/static/dist/api.js"></script>');}function inputcheck_mobile(str){var reg=/^(((13)|(15)|(18)|(17)|(14)|(19)|(16))+\d{9})$/;if(reg.test(str))return true;return false;}function validate_answer_qblank_upload_file(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var input_val=$.trim(qdiv.find(".option").val());if(!isNotEmpty(input_val))if("allow_null" in qmodel.question.custom_attr){qtip.text("");return true;}else{qtip.text("请上传文件");scroll_to(qdiv);return false;}return true;}function get_answer_qblank_upload_file(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var input=qdiv.find(".option");var input_val=input.val();var answer={};if(isNotEmpty(input_val))answer[input.attr("id")+"_open"]=input_val;return answer;}function bind_event_qblank_upload_file(qmodel){var qid=qmodel.qid;var question=qmodel.question;$("#file_"+qid).change(function(){if(typeof ($(this)[0].files)!="undefined"){var filename=$(this)[0].files[0].name;if(test_mode){$("#filename_"+qid).text(filename).show();return false;}var forbiddenLetter="|";if(filename.indexOf(forbiddenLetter)!=-1){alert("文件名中请勿包含“|”");return false;}else{var maxsize=10*1024*1024;var filesize=0;try{if(typeof ($(this)[0].files[0].size)!="undefined")filesize=$(this)[0].files[0].size;else{var obj_img=document.getElementsByClassName("tempImg")[0];obj_img.dynsrc=$(this)[0].files[0].value;filesize=obj_img.size;}}catch(e){filesize=0;}if(filesize>maxsize){$("#tip_"+qid).text("上传文件超过10M").show();return false;}}}else if(test_mode){var filePath=$(this).val();$("#filename_"+qid).text(filePath).show();return false;}upload_file(this.id,question.project_id,qid,uuid);});}var source_qsingle='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix">{@if qmodel.option_list.length == 0 && qmodel.question.related_question_list && qmodel.question.related_question_list.length > 0}<div class="related-tip">此题选项来源于前面题目，请先回答前面题目</div>{@else}<div class="related-tip"></div>{@/if}<div id="tip_${qmodel.qid}" class="red"></div>{@each qmodel.question.related_question_list as related_question}{@each related_question.option_list as option}<div style="display:none;" related-id="related_${related_question._id.$oid}_${option._id.$oid}" class="icheckbox_div {@if disp_type === \'transverse\' || disp_type === \'column\'}cols_li{@/if}" style="{@if disp_type === \'column\'}width:${col_width}{@/if}"><input type="radio" name="question_${qmodel.qid}" value="${option._id.$oid}" id="${qmodel.qid}_related_option_${option._id.$oid}" class="option"/><label for="${qmodel.qid}_related_option_${option._id.$oid}" class="option_label label_${option._id.$oid}" >$${option.title}</label>{@if option.is_open}<input type="text" name="" id="${qmodel.qid}_related_option_open_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><span class="red" id="option_tip"></span>{@/if}</div>{@/each}{@/each}{@each qmodel.option_list as option}<div class="icheckbox_div {@if disp_type === \'transverse\' || disp_type === \'column\'}cols_li{@/if}" style="{@if disp_type === \'column\'}width:${col_width}{@/if}"><input type="radio" name="question_${qmodel.qid}" value="${option._id.$oid}" id="option_${option._id.$oid}" class="option"/><label for="option_${option._id.$oid}" class="option_label label_${option._id.$oid}" >$${option.title}</label>{@if option.is_open}<input type="text" name="" id="option_open_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><span class="red" id="option_tip"></span>{@/if}</div>{@/each}</div></div>';var source_qsinglevote='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix vote"><div id="tip_${qmodel.qid}" class="red"></div>{@each qmodel.option_list as option}<div class="icheckbox_div {@if disp_type === \'transverse\' || disp_type === \'column\'}cols_li{@/if}" style="{@if disp_type === \'column\'}width:${col_width}{@/if}"><input type="radio" name="question_${qmodel.qid}" value="${option._id.$oid}" id="option_${option._id.$oid}" class="option"/><label for="option_${option._id.$oid}" class="option_label label_${option._id.$oid}" >$${option.title}</label>{@if option.is_open}<input type="text" name="" id="option_open_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><span class="red" id="option_tip"></span>{@/if}<div class="fontVoteProgressBox"><div class="progressBox"><div class="progress_vote"></div></div><ul class="progress_info"><li class="percentage"></li><li class="vote_N"></li></ul></div></div>{@/each}</div></div>';var source_qsingle_dropdown='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if}><div class="title">$${qmodel.title}</div><div class="matrix">{@if qmodel.option_list.length == 0 && qmodel.question.related_question_list && qmodel.question.related_question_list.length > 0}<div class="related-tip">此题选项来源于前面题目，请先回答前面题目</div>{@else}<div class="related-tip"></div>{@/if}<div id="tip_${qmodel.qid}" style="color:red;"></div>{@if qmodel.option_list.length == 0 && qmodel.question.related_question_list && qmodel.question.related_question_list.length > 0}<select class="matrix_sel" rel="question_${qmodel.qid}" style="display: none;">{@else}<select class="matrix_sel" rel="question_${qmodel.qid}">{@/if}<option value="">--请选择一个选项--</option>{@each qmodel.option_list as option}<option value="${option._id.$oid}">$${option.title}</option>{@/each}</select>{@if qmodel.question.related_question_list && qmodel.question.related_question_list.length > 0}<div class="select-source">{@each qmodel.question.related_question_list as related_question}{@each related_question.option_list as option}<span class="option-hide" related-id="related_${related_question._id.$oid}_${option._id.$oid}" data-value="${option._id.$oid}">$${option.title}</span>{@/each}{@/each}{@each qmodel.option_list as option}<span data-value="${option._id.$oid}">$${option.title}</span>{@/each}</div>{@/if}</div></div>';var source_qmultiple='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix">{@if qmodel.option_list.length == 0 && qmodel.question.related_question_list && qmodel.question.related_question_list.length > 0}<div class="related-tip">此题选项来源于前面题目，请先回答前面题目</div>{@else}<div class="related-tip"></div>{@/if}<div id="tip_${qmodel.qid}" class="red"></div>{@each qmodel.question.related_question_list as related_question}{@each related_question.option_list as option}<div style="display:none;" related-id="related_${related_question._id.$oid}_${option._id.$oid}"  class="icheckbox_div {@if disp_type === \'transverse\' || disp_type === \'column\'}cols_li{@/if}" style="{@if disp_type === \'column\'}width:${col_width}{@/if}"><input type="checkbox" name="question_${qmodel.qid}" id="${qmodel.qid}_related_option_${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if}/><label class="option_label label_${option._id.$oid}">$${option.title}</label>{@if option.is_open}<input type="text" name=""  id="${qmodel.qid}_related_option_open_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><span class="red" id="option_tip"></span>{@/if}</div>{@/each}{@/each}{@each qmodel.option_list as option}<div class="icheckbox_div {@if disp_type === \'transverse\' || disp_type === \'column\'}cols_li{@/if}" style="{@if disp_type === \'column\'}width:${col_width}{@/if}"><input type="checkbox" name="question_${qmodel.qid}" id="option_${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if}/><label class="option_label label_${option._id.$oid}">$${option.title}</label>{@if option.is_open}<input type="text" name=""  id="option_open_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><span class="red" id="option_tip"></span>{@/if}</div>{@/each}</div></div>';var source_qmultiplevote='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix vote"><div id="tip_${qmodel.qid}" class="red"></div>{@each qmodel.option_list as option}<div class="icheckbox_div {@if disp_type === \'transverse\' || disp_type === \'column\'}cols_li{@/if}" style="{@if disp_type === \'column\'}width:${col_width}{@/if}"><input type="checkbox" name="question_${qmodel.qid}" id="option_${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if}/><label class="option_label label_${option._id.$oid}">$${option.title}</label>{@if option.is_open}<input type="text" name=""  id="option_open_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><span class="red" id="option_tip"></span>{@/if}<div class="fontVoteProgressBox"><div class="progressBox"><div class="progress_vote"></div></div><ul class="progress_info"><li class="percentage"></li><li class="vote_N"></li></ul></div></div>{@/each}</div></div>';var source_qblank='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div>{@if question.custom_attr.blank_type === "single"}<input class="blank option" id="${qmodel.option_list[0]._id.$oid}" type="text" style="width: ${parseInt(question.option_list[0].custom_attr.text_col) * 15}px;" option_id="${qmodel.option_list[0]._id.$oid}" />{@else}<textarea type="text" value="" class="blank option" id="${qmodel.option_list[0]._id.$oid}" cols="${parseInt(qmodel.option_list[0].custom_attr.text_col) * 2}" rows="${qmodel.option_list[0].custom_attr.text_row}" option_id="${qmodel.option_list[0]._id.$oid}"></textarea>{@/if}<div id="tip_${qmodel.qid}" class="red"></div>{@if qmodel.option_list[0].custom_attr.checkmethod == "mobile" && qmodel.option_list[0].custom_attr.sms_auth == "on" }<div class="sms_yzm" style="padding-left: 0px;"><input type="text" class="code" /><p class="hq"><a href="javascript:;" class="btn_send_code">发送短信验证码</a></p><div id="tip_code_${qmodel.qid}" class="red"></div><span class="yz">验证成功</span><div id="captcha_${qmodel.option_list[0]._id.$oid}"></div><input type="hidden" id="lc-captcha-response" name="luotest_response" value=""></div>{@/if}<span class="red unique_tip" style="display:none;" id="tip_${qmodel.option_list[0]._id.$oid}">{@if qmodel.option_list[0].custom_attr.checkmethod == "mobile"}填写的手机号已经存在{@else}填写的内容已存在{@/if}</span></div></div></div>';var source_qblank_dropdown='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div id="tip_${qmodel.qid}" class="red"></div>{@if question.custom_attr.drop_type === \'address\'}<div class="selectTransverse">{@each i in range(0, qmodel.option_list.length-1)}<select id="${qmodel.option_list[i]._id.$oid}" class="option" rel="${qmodel.qid}"><option value="">请选择${qmodel.option_list[i].title}</option></select>{@/each}<br><textarea style="margin:10px 0 0 0;width: 355px;" class="option" name="" id="${qmodel.option_list[3]._id.$oid}" placeholder="街道信息"></textarea></div>{@else}<div class="selectTransverse">{@each qmodel.option_list as option}<select id="${option._id.$oid}" class="option" rel="${qmodel.qid}"><option value="">请选择${option.title}</option></select>{@/each}</div>{@/if}</div></div>';var source_qscore='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}" minnum="${question.custom_attr.min_answer_num}" maxnum="${question.custom_attr.max_answer_num}" score_display="{@if question.custom_attr.score_display}op_${question.custom_attr.score_display}{@else}op_star{@/if}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="overflow:visible;"><table class="QScorelist" width=100% border=0 cellpadding=0 cellspacing=0><tr><td></td><td><table class="tip_table score_title" style="width:462px;" border=0 cellspacing=0 cellpadding=0><tr><td align="left" style="width:33.33%;">$${question.custom_attr.desc_left}</td><td align="center" style="width:33.33%">$${question.custom_attr.desc_middle}</td><td align="right" style="width:33.33%">$${question.custom_attr.desc_right}</td></tr></table></td><td></td></tr>{@each qmodel.option_list as option}<tr><td class="option_label label_${option._id.$oid}" style="padding-right: 20px;">$${option.title}</td><td><table class="data_row" border=0 cellspacing=0 cellpadding=0 style="border:solid 0px gray;overfloat:hidden;font-size:12px;width:396px;"><tr class="score_row"><td><table border=0 cellspacing=0 cellpadding=1 class="table_score table_score_v2"><tr>{@if question.custom_attr.score_display == "slider" }<td class="div_float score_slider_box"><div class="score_slider">{@each i in range(parseInt(question.custom_attr.min_answer_num), parseInt(question.custom_attr.max_answer_num) + 1)}{@if i == parseInt(question.custom_attr.min_answer_num)}<div class="s_tag s_tag_first s_tag_m">{@else if i == parseInt(question.custom_attr.max_answer_num)}<div class="s_tag s_tag_last s_tag_m">{@else}<div class="s_tag s_tag_c">{@/if}<span class="tag_i"></span></div>{@/each}</div></td>{@else}{@each i in range(parseInt(question.custom_attr.min_answer_num), parseInt(question.custom_attr.max_answer_num) + 1)}<td class="div_float" score_v="${i}"><i class="score_i {@if question.custom_attr.score_display}op_${question.custom_attr.score_display}{@else}op_star{@/if}"></i></td>{@/each}{@/if}</tr></table></td><td class="score disp_none" width="50px" align="center" id="option_${option._id.$oid}"></td><td width="30px">&nbsp;</td></tr></table></td><td>&nbsp;</td></tr>{@/each}</table></div></div>';var source_qsort='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="overflow:inherit;"><div class="pxul"><ul class="unstyled Sorting">{@each qmodel.option_list as option,index}<li class="option"><label id="${option._id.$oid}" name="${parseInt(index)+1}" class="pxla option_label label_${option._id.$oid}">$${option.title}</label></li>{@/each}</ul><div class="sort-right"><table class="table2 pxlist" cellpadding="0" cellspacing="0"><tbody>{@if question.custom_attr.limit_sort_count}{@each i in range(1, parseInt(question.custom_attr.limit_sort_count) + 1)}<tr><th class="w28">${i}</th><td></td></tr>{@/each}{@else}{@each i in range(1, qmodel.option_list.length + 1)}<tr><th class="w28">${i}</th><td></td></tr>{@/each}{@/if}</tbody></table></div></div><div class="tip">请将左面的项拖放到右面的框完成排序</div></div></div>';var source_qmultiple_blank='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix"><table><tbody>{@each qmodel.option_list as option}<tr><td name="option" align="right" class="T_edit_td option_label label_${option._id.$oid}">$${option.title}</td><td><div class="grade_text"><textarea class="blank option" name="option_${option._id.$oid}" id="option_${option._id.$oid}" cols="${parseInt(option.custom_attr.text_col) * 2}" rows="${option.custom_attr.text_row}" option_id="${option._id.$oid}"></textarea><span class="red" id="option_tip" style="display: inline-block;"></span></div></td></tr><tr><td colspan="2"><span class="red unique_tip" style="display:none;" id="tip_${option._id.$oid}">填写的内容已存在</span></td></tr>{@/each}</tbody></table></div></div>';var source_qmatrix_single='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><div class="PR15"><table class="wjtable" cellspacing="0" cellpadding="0"><tr class="head_row"><td width="15%">&nbsp;</td>{@each qmodel.option_list as option}<td class="option_label label_${option._id.$oid}">$${option.title}</td>{@/each}</tr>{@each qmodel.matrixrow_list as row}<tr class="data_row"><td class="option_label label_${row._id.$oid}" style="text-align:left;">$${row.title}</td>{@each qmodel.option_list as option}<td><input type="radio" name="row_${row._id.$oid}" id="option_${row._id.$oid}_${option._id.$oid}" />{@if option.is_open}<input type="text" id="open_${row._id.$oid}_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><br><span class="red option_tip"></span>{@/if}</td>{@/each}</tr>{@/each}</table></div></div></div>';var source_qmatrix_single_swap='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><table class="wjtable matrix_table" cellspacing="0" cellpadding="0"><tr class="head_row"><td width="15%">&nbsp;</td>{@each qmodel.matrixrow_list as row}<td class="option_label label_${row._id.$oid}">$${row.title}</td>{@/each}</tr>{@each qmodel.option_list as option}<tr class="data_row"><td class="option_label label_${option._id.$oid}" style="text-align:left;">$${option.title}</td>{@each qmodel.matrixrow_list as row}<td><input type="radio" name="row_${row._id.$oid}" id="option_${row._id.$oid}_${option._id.$oid}" />{@if option.is_open}<input type="text" id="open_${row._id.$oid}_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><br/><span class="red option_tip"></span>{@/if}</td>{@/each}</tr>{@/each}</table></div></div>';var source_qmatrix_multiple='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><div class="PR15"><table class="wjtable" cellspacing="0" cellpadding="0"><tbody><tr><td width="15%">&nbsp;</td>{@each qmodel.option_list as option}<td name="option" menutype="col" class="option_label label_${option._id.$oid}">$${option.title}</td>{@/each}</tr>{@each qmodel.matrixrow_list as row}<tr class="data_row" id="${row._id.$oid}"><td name="row" menutype="row" class="option_label label_${row._id.$oid}" style="text-align:left;">$${row.title}</td>{@each qmodel.option_list as option}<td><input type="checkbox" name="row_${row._id.$oid}" id="option_${row._id.$oid}_${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if}/>{@if option.is_open}<input type="text" id="open_${row._id.$oid}_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><br/><span class="red option_tip"></span>{@/if}</td>{@/each}</tr>{@/each}</tbody></table></div></div></div>';var source_qmatrix_multiple_swap='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><div class="PR15"><table class="wjtable matrix_table" cellspacing="0" cellpadding="0"><tbody><tr><td width="15%">&nbsp;</td>{@each qmodel.matrixrow_list as row}<td name="row" menutype="col" class="option_label label_${row._id.$oid}">$${row.title}</td>{@/each}</tr>{@each qmodel.option_list as option}<tr class="data_row"><td class="data_td option_label label_${option._id.$oid}" style="text-align:left;">$${option.title}</td>{@each qmodel.matrixrow_list as row}<td class="data_td"><input type="checkbox" name="row_${row._id.$oid}" id="option_${row._id.$oid}_${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if}/>{@if option.is_open}<input type="text" id="open_${row._id.$oid}_${option._id.$oid}" class="option_open" option_id="${option._id.$oid}"><br/><span class="red option_tip"></span>{@/if}</td>{@/each}</tr>{@/each}</tbody></table></div></div></div>';var source_qmatrix_blank='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><div class="PR15"><table class="wjtable matrix_table" cellspacing="0" cellpadding="0"><tbody><tr><td width="15%">&nbsp;</td>{@each qmodel.option_list as option}<td class="option_label label_${option._id.$oid}">$${option.title}</td>{@/each}</tr>{@each qmodel.matrixrow_list as row}<tr class="data_row"><td class="option_label label_${row._id.$oid}" style="text-align:left;">$${row.title}</td>{@each qmodel.option_list as option}<td><textarea id="open_${row._id.$oid}_${option._id.$oid}" cols="${parseInt(option.custom_attr.text_col) * 2}" rows="${option.custom_attr.text_row}" class="option_open" option_id="${option._id.$oid}"></textarea><br><span class="red option_tip"></span></td>{@/each}</tr>{@/each}</tbody></table></div></div></div>';var source_qmatrix_blank_swap='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><table class="wjtable matrix_table" cellspacing="0" cellpadding="0"><tbody><tr><td width="15%">&nbsp;</td>{@each qmodel.matrixrow_list as row}<td class="option_label label_${row._id.$oid}">$${row.title}</td>{@/each}</tr>{@each qmodel.option_list as option}<tr class="data_row"><td class="option_label label_${option._id.$oid}" style="text-align:left;">$${option.title}</td>{@each qmodel.matrixrow_list as row}<td><textarea id="open_${row._id.$oid}_${option._id.$oid}" cols="${parseInt(option.custom_attr.text_col) * 2}" rows="${option.custom_attr.text_row}" class="option_open" option_id="${option._id.$oid}"></textarea><br><span class="red option_tip"></span></td>{@/each}</tr>{@/each}</tbody></table></div></div>';var source_qmatrix_score='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><div class="PR15"><table class="matrix_table wjtable" cellspacing="0" cellpadding="0"><tr><td align="center" width="15%">&nbsp;</td>{@each qmodel.option_list as option}<td class="option_label label_${option._id.$oid}">$${option.title}</td>{@/each}</tr>{@each qmodel.matrixrow_list as row}<tr class="data_row"><td class="option_label label_${row._id.$oid}" style="text-align:left;">$${row.title}</td>{@each qmodel.option_list as option}<td align="center" class="score_td" id="option_${row._id.$oid}_${option._id.$oid}"><table><tr>{@each i in range(1, parseInt(question.custom_attr.max_answer_num) + 1)}<td style="border:0"><img src="${star_off}" class="matrix_score" stat="off"/></td>{@/each}</tr></table></td>{@/each}</tr>{@/each}</table></div></div></div>';var source_qmatrix_score_swap='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix" style="width:800px;"><table class="matrix_table wjtable" cellspacing="0" cellpadding="0"><tr><td align="center" width="15%">&nbsp;</td>{@each qmodel.matrixrow_list as row}<td class="option_label label_${row._id.$oid}">$${row.title}</td>{@/each}</tr>{@each qmodel.option_list as option}<tr class="data_row"><td class="option_label label_${option._id.$oid}" style="text-align:left;">$${option.title}</td>{@each qmodel.matrixrow_list as row}<td align="center" class="score_td" id="option_${row._id.$oid}_${option._id.$oid}"><table><tr>{@each i in range(1, parseInt(question.custom_attr.max_answer_num) + 1)}<td style="border:0"><img src="${star_off}" class="matrix_score" stat="off"/></td>{@/each}</tr></table></td>{@/each}</tr>{@/each}</table></div></div>';var source_qdesc='<div class="wjques maxtop question" id="question_${qmodel.qid}"><div class="title">$${qmodel.title}</div></div>';var source_qdesc_split_line='<div id="question_${qmodel.qid}" class="maxtop question "><div class="DividingLine"></div></div>';var source_qblank_date='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix question_date"><input id="${question.option_id_list[0]}" type="text" class="option"/></div></div>';var source_qblank_time='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix"><div class="Time_con"><select id="option_${qmodel.option_list[0]._id.$oid}" class="option"><option value="">小时</option>{@each i in range(0, 24)}{@if i < 10}<option value="0${i}">0${i}</option>{@else}<option value="${i}">${i}</option>{@/if}{@/each}</select><span>&nbsp;:&nbsp;</span><select id="option_${qmodel.option_list[1]._id.$oid}" class="option"><option value="">分钟</option>{@each i in range(0, 60)}{@if i < 10}<option value="0${i}">0${i}</option>{@else}<option value="${i}">${i}</option>{@/if}{@/each}</select></div></div></div>';var source_qimage_single='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div class="red" id="tip_${qmodel.qid}"></div><ul class="Imgli">{@each qmodel.option_list as option}<li><div class="questionImgBox"><div class="QImgCon"><img onclick="bigImg.showImg(this,\'${option.custom_attr.images.src}\')" src="${option.custom_attr.images.thumbnail_src}"></div><input type="radio" name="question_${qmodel.qid}" id="option_${option._id.$oid}" value="${option._id.$oid}" class="option" option_id="${option._id.$oid}"><label class="T_edit_min label_${option._id.$oid}" for="" name="option">$${option.title}</label></div></li>{@/each}</ul></div></div>';var source_qimage_multiple='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div class="red" id="tip_${qmodel.qid}"></div><ul class="Imgli">{@each qmodel.option_list as option}<li><div class="questionImgBox"><div class="QImgCon"><img onclick="bigImg.showImg(this,\'${option.custom_attr.images.src}\')" src="${option.custom_attr.images.thumbnail_src}"></div><input type="checkbox" name="question_${qmodel.qid}" id="option_${option._id.$oid}" value="${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if} option_id="${option._id.$oid}"><label class="T_edit_min label_${option._id.$oid}" for="" name="option">$${option.title}</label></div></li>{@/each}</ul></div></div>';var source_qimagevote_single='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div class="red" id="tip_${qmodel.qid}"></div><ul class="Imgli">{@each qmodel.option_list as option}<li><div class="questionImgBox"><div class="QImgCon"><img onclick="bigImg.showImg(this,\'${option.custom_attr.images.src}\')" src="${option.custom_attr.images.thumbnail_src}"><div class="voteProgressBox" onclick="bigImg.showImg(this,\'${option.custom_attr.images.src}\')"><div class="progress"></div><div class="progress_info"></div></div></div><input type="radio" name="question_${qmodel.qid}" id="option_${option._id.$oid}" value="${option._id.$oid}" class="option" option_id="${option._id.$oid}"><label class="T_edit_min label_${option._id.$oid}" for="" name="option">$${option.title}</label></div></li>{@/each}</ul></div></div>';var source_qimagevote_multiple='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div class="red" id="tip_${qmodel.qid}"></div><ul class="Imgli">{@each qmodel.option_list as option}<li><div class="questionImgBox"><div class="QImgCon"><img onclick="bigImg.showImg(this,\'${option.custom_attr.images.src}\')" src="${option.custom_attr.images.thumbnail_src}"><div class="voteProgressBox" onclick="bigImg.showImg(this,\'${option.custom_attr.images.src}\')"><div class="progress"></div><div class="progress_info"></div></div></div><input type="checkbox" name="question_${qmodel.qid}" id="option_${option._id.$oid}" value="${option._id.$oid}" class="option" {@if \'exclusive\' in option.custom_attr}exclusive="1"{@/if} option_id="${option._id.$oid}"><label class="T_edit_min label_${option._id.$oid}" for="" name="option">$${option.title}</label></div></li>{@/each}</ul></div></div>';var source_qblank_upload_file='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div class="matrix"><div class="red" id="tip_${qmodel.qid}"></div><div class="upFile"><div class="upBut"><div class="file-box"><img class="tempImg" src="" dynsrc="" style="visibility:hidden;"><input class="selectFile" type="file" name="file" id="file_${qmodel.qid}"><input type="hidden" name="" class="option" id="${qmodel.option_list[0]._id.$oid}"><div class="Hbuttom poa" id="upload_btn_${qmodel.qid}">选择文件</div><div class="loadingimg" style=""></div><span id="filename_${qmodel.qid}" style=""></span></div></div><div class="span_text">( 10M以内 )</div></div></div></div>';var source_qnps_score='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><div class="matrix"><table class="QScorelist QNpsScorelist" width=100% border=0 cellpadding=0 cellspacing=0><tr><td></td><td><table id="tip_table" class="nps_tip_text" border=0 cellspacing=0 cellpadding=0><tr><td><span class="fl">0：不可能</span><span class="fr">10：极有可能</span></td></tr></table></td><td></td></tr>{@each qmodel.option_list as option}<tr><td class="option_label label_${option._id.$oid}"></td><td><table class="data_row" border=0 cellspacing=0 cellpadding=0 style="border:solid 0px gray; overflow:hidden;font-size:12px;"><tr><td><table border=0 cellspacing=0 cellpadding=1 class="nps_grade_text"><tr><td>{@each i in range(parseInt(question.custom_attr.min_answer_num), parseInt(question.custom_attr.max_answer_num) + 1)}<div {@if i==parseInt(question.custom_attr.max_answer_num) } class="div_float div_float_last" {@else} class="div_float"{@/if}>${i}</div>{@/each}</td></tr></table></td><td class="score nps_score" width="50px" align="center" id="option_${option._id.$oid}"></td><td width="30px">&nbsp;</td></tr></table></td><td>&nbsp;</td></tr>{@/each}</table></div></div>';var source_qblank_geographical='<div class="wjques maxtop question" id="question_${qmodel.qid}" {@if \'allow_null\' in qmodel.question.custom_attr}allow_null="1"{@/if} questiontype="${qmodel.question.question_type}"><div class="title">$${qmodel.title}</div><div id="tip_${qmodel.qid}" class="red"></div><a class="map_a" qid="${qmodel.qid}"><i class="geo_ico location_ico"></i>点击获取地理位置</a><div class="geographical_content disp_none"><div class="geographical_result clearfix"><i class="geo_ico mark_ico"></i><a class="geo_primary_btn geographical_clear_btn">清除</a><div class="geographical_address">正在加载地址...</div><div class="geographical_coord">正在加载坐标...</div></div><div id="map_${qmodel.qid}" class="geographical"></div><div class="geographical_action clearfix"><div class="geographical_input"><input type="text" class="search_input" placeholder="请输入要搜索的地点、街道"><a class="geographical_search_btn"><i class="geo_ico"></i></a></div><a class="geo_primary_btn current_location_btn"><i class="geo_ico location_ico"></i>重新获取地理位置</a></div></div>{@each qmodel.option_list as option}<input type="hidden" class="option ${option.custom_attr.name_en}" id="option_${option._id.$oid}">{@/each}</div>';var plugin_support=Modernizr.inputtypes.date;var TemplateFactory={getHtml:function(qmodel,source){var disp_type=qmodel.question.custom_attr.disp_type||'vertical';var column_count=qmodel.question.custom_attr.column_count||'1';var col_width=100/parseInt(column_count)+'%';if(disp_type=='vertical')col_width='100%';var data={"qmodel":qmodel,"question":qmodel.question,"c_uuid":uuid,"star_off":star_off,'disp_type':disp_type,'column_count':column_count,'col_width':col_width,'is_ios':is_ios,'cmf':checkmethod_factory};return juicer(source,data);}};juicer.register('tabularize',tabularize);function QBase(question){this.question=arguments[0]||null;if(isNotEmpty(this.question)){this.qid=get_oid(this.question);this.title=copy_obj(this.question.title);if(isNotEmpty(this.question.cid)){var cid=copy_obj(this.question.cid);this.seq=cid.substring(1,cid.length);}}}QBase.prototype.set_question=function(question){this.question=question;};QBase.prototype.get_survey_html=function(){return "";};QBase.prototype.get_base_option_list=function(){if(isNotEmpty(this.question.option_list))return this.question.option_list;return [];};QBase.prototype.get_base_matrixrow_list=function(){if(isNotEmpty(this.question.matrixrow_list))return this.question.matrixrow_list;return [];};QBase.prototype.get_current_answer=function(){return total_answers[this.qid];};QBase.prototype.get_survey_source=function(){return '';};QBase.prototype.gen_edit_template=function(){var source=this.get_edit_template();return TemplateFactory.getHtml(this,source);};QBase.prototype.gen_survey_template=function(){var source=this.get_survey_source();if(isNotEmpty(source)){var href=window.location.href;var show_seq=false;if(href.indexOf('preview=1')>=0)if(href.indexOf('show_seq=1')>=0)show_seq=true;else if(href.indexOf('show_seq=0')>=0)show_seq=false;else if("show_seq" in project.custom_attr)show_seq=true;else show_seq=false;else if("show_seq" in project.custom_attr)show_seq=true;if(show_seq)if(this.title.indexOf("Qnum")===-1&&this.question.question_type!=70)this.title='<span class="Qnum">'+this.seq+'.</span> '+this.title;return TemplateFactory.getHtml(this,source);}else{console.warn("QModel: "+this+"has no survey_source yet.");return "";}};QBase.prototype.get_selected=function(){return "";};QBase.prototype.get_input=function(){return "";};QBase.prototype.get_validate_function=function(){return function(){return true;};};QBase.prototype.get_getanswer_function=function(){return function(){return null;};};QBase.prototype.bind_event_function=function(){};QBase.prototype.estimate_time=function(){return estimate_map[this.qid];};QBase.prototype.show_option_msg=function(option_id,msg){return;};QBase.prototype.clear_option_msg=function(option_id){return;};QBase.prototype.show_edit_error_msg=function(){var msg='请至少添加1个选项';verify_question_option.show(this.qid,msg);};QBase.prototype.hide_edit_error_msg=function(){verify_question_option.hide(this.qid);};function QSingle(question){QBase.call(this,question);}QSingle.prototype=new QBase();QSingle.prototype.get_selected=function(){var answer=this.get_current_answer();if(isNotEmpty(answer))return answer[this.question.id];return null;};QSingle.prototype.get_input=function(){var answer=this.get_current_answer();if(isNotEmpty(answer))return answer[this.qid+"_open"];return null;};QSingle.prototype.get_edit_template=function(){var disp_type=this.question.custom_attr.disp_type||'vertical';if("dropdown"==disp_type||"dropdown" in this.question.custom_attr)return source_qsingle_dropdown;return source_qsingle;};QSingle.prototype.get_survey_source=function(){var disp_type=this.question.custom_attr.disp_type||'vertical';if("dropdown"==disp_type||"dropdown" in this.question.custom_attr)return source_qsingle_dropdown;return source_qsingle;};QSingle.prototype.get_selected=function(){var current_answer=this.get_current_answer();if(isNotEmpty(current_answer))return current_answer[0];return "";};QSingle.prototype.get_input=function(){var current_answer=this.get_current_answer();if(isNotEmpty(current_answer)&&current_answer.length==2)return current_answer[1];return "";};QSingle.prototype.get_validate_function=function(){return validate_answer_qsingle;};QSingle.prototype.get_getanswer_function=function(){return get_answer_qsingle;};QSingle.prototype.bind_event_function=function(){bind_event_qsingle(this);};QSingle.prototype.show_option_msg=function(option_id,msg){$("#"+option_id).next().text(msg);};QSingle.prototype.clear_option_msg=function(option_id){$("#"+option_id).next().text("");};QSingle.prototype.show_edit_error_msg=function(){var msg='请至少添加1个选项';verify_question_option.show(this.qid,msg);};function QMultiple(question){QBase.call(this,question);}QMultiple.prototype=new QBase();QMultiple.prototype.get_selected=function(){var answer=this.get_current_answer();if(isNotEmpty(answer))return answer[this.qid];return [];};QMultiple.prototype.get_input=function(option_id_or_cid){var option=get_option(this.qid,option_id_or_cid);if(isNotEmpty(answer))return answer[this.qid+option.id+"_open"];return "";};QMultiple.prototype.get_edit_template=function(){return source_qmultiple;};QMultiple.prototype.get_survey_source=function(){return source_qmultiple;};QMultiple.prototype.get_selected=function(){var current_answer=this.get_current_answer();if(isNotEmpty(current_answer))return $.map(current_answer,function(item){if(isNotEmpty(item))return item[0];});return [];};QMultiple.prototype.get_input=function(){var current_answer=this.get_current_answer();if(isNotEmpty(current_answer))return $.map(current_answer,function(item){if(isNotEmpty(item)&&item.length==2)return item[1];});return [];};QMultiple.prototype.get_validate_function=function(){return validate_answer_qmultiple;};QMultiple.prototype.get_getanswer_function=function(){return get_answer_qmultiple;};QMultiple.prototype.bind_event_function=function(){bind_event_qmultiple(this);};QMultiple.prototype.show_option_msg=function(option_id,msg){$("#"+option_id).next().text(msg);};QMultiple.prototype.clear_option_msg=function(option_id){$("#"+option_id).next().text("");};QMultiple.prototype.show_edit_error_msg=function(){var msg='请至少添加1个选项';verify_question_option.show(this.qid,msg);};function QBlank(question){QBase.call(this,question);}QBlank.prototype=new QBase();QBlank.prototype.get_edit_template=function(){return source_qblank;};QBlank.prototype.get_survey_source=function(){return source_qblank;};QBlank.prototype.get_validate_function=function(){return validate_answer_qblank;};QBlank.prototype.get_getanswer_function=function(){return get_answer_qblank;};QBlank.prototype.bind_event_function=function(){bind_event_qblank(this);};QBlank.prototype.get_selected=function(){var answer=this.get_current_answer();if(isNotEmpty(answer)){var option_id=this.question.option_id_list[0];var input_val=answer[option_id+"_open"];if(isNotEmpty(input_val))return input_val;return "";}return "";};QBlank.prototype.show_option_msg=function(option_id,msg){$("#tip_"+this.qid).text(msg);};QBlank.prototype.clear_option_msg=function(option_id){$("#tip_"+this.qid).text("");};function QScore(question){QBase.call(this,question);}QScore.prototype=new QBase();QScore.prototype.get_edit_template=function(){return source_qscore;};QScore.prototype.get_survey_source=function(){return source_qscore;};QScore.prototype.get_validate_function=function(){return validate_answer_qscore;};QScore.prototype.get_getanswer_function=function(){return get_answer_qscore;};QScore.prototype.bind_event_function=function(){bind_event_qscore(this);};QScore.prototype.show_edit_error_msg=function(){var msg='请至少添加1个打分项';verify_question_option.show(this.qid,msg);};function QOrder(question){QBase.call(this,question);}QOrder.prototype=new QBase();QOrder.prototype.get_edit_template=function(){return source_qorder;};QOrder.prototype.get_survey_source=function(){return source_qsort;};QOrder.prototype.get_validate_function=function(){return validate_answer_qsort;};QOrder.prototype.get_getanswer_function=function(){return get_answer_qsort;};QOrder.prototype.bind_event_function=function(){bind_event_qsort(this);};QOrder.prototype.show_edit_error_msg=function(){var msg='请至少添加1个选项';verify_question_option.show(this.qid,msg);};function QMultipleBlank(question){QBase.call(this,question);}QMultipleBlank.prototype=new QBase();QMultipleBlank.prototype.get_edit_template=function(){return source_qmultiple_blank;};QMultipleBlank.prototype.get_survey_source=function(){return source_qmultiple_blank;};QMultipleBlank.prototype.get_validate_function=function(){return validate_answer_qmultipleblank;};QMultipleBlank.prototype.get_getanswer_function=function(){return get_answer_qmultipleblank;};QMultipleBlank.prototype.bind_event_function=function(){bind_event_qmultipleblank(this);};QMultipleBlank.prototype.show_option_msg=function(option_id,msg){$("#"+option_id).next().text(msg);};QMultipleBlank.prototype.clear_option_msg=function(option_id){$("#"+option_id).next().text("");};QMultipleBlank.prototype.show_edit_error_msg=function(){var msg='请至少添加1个填空项';verify_question_option.show(this.qid,msg);};function QMatrixSingle(question){QBase.call(this,question);}QMatrixSingle.prototype=new QBase();QMatrixSingle.prototype.get_edit_template=function(){return source_qmatrix_single;};QMatrixSingle.prototype.get_survey_source=function(){if("is_swap" in this.question.custom_attr)return source_qmatrix_single_swap;return source_qmatrix_single;};QMatrixSingle.prototype.get_validate_function=function(){return validate_answer_qmatrixsingle;};QMatrixSingle.prototype.get_getanswer_function=function(){return get_answer_qmatrixsingle;};QMatrixSingle.prototype.bind_event_function=function(){bind_event_qmatrixsingle(this);};QMatrixSingle.prototype.show_option_msg=function(option_id,msg){$("#"+option_id).next().next().text(msg);};QMatrixSingle.prototype.clear_option_msg=function(option_id){$("#"+option_id).next().next().text("");};QMatrixSingle.prototype.show_edit_error_msg=function(){var msg='请至少添加1个矩阵行和选项';verify_question_option.show(this.qid,msg);};function QMatrixMultiple(question){QBase.call(this,question);}QMatrixMultiple.prototype=new QBase();QMatrixMultiple.prototype.get_edit_template=function(){return source_qmatrix_multiple;};QMatrixMultiple.prototype.get_survey_source=function(){if("is_swap" in this.question.custom_attr)return source_qmatrix_multiple_swap;return source_qmatrix_multiple;};QMatrixMultiple.prototype.get_validate_function=function(){return validate_answer_qmatrixmultiple;};QMatrixMultiple.prototype.get_getanswer_function=function(){return get_answer_qmatrixmultiple;};QMatrixMultiple.prototype.bind_event_function=function(){bind_event_qmatrixmultple(this);};QMatrixMultiple.prototype.show_option_msg=function(option_id,msg){$("#"+option_id).next().next().text(msg);};QMatrixMultiple.prototype.clear_option_msg=function(option_id){$("#"+option_id).next().next().text("");};QMatrixMultiple.prototype.show_edit_error_msg=function(){var msg='请至少添加1个矩阵行和选项';verify_question_option.show(this.qid,msg);};function QMatrixBlank(question){QBase.call(this,question);}QMatrixBlank.prototype=new QBase();QMatrixBlank.prototype.get_edit_template=function(){return source_qmatrix_blank;};QMatrixBlank.prototype.get_survey_source=function(){if("is_swap" in this.question.custom_attr)return source_qmatrix_blank_swap;return source_qmatrix_blank;};QMatrixBlank.prototype.get_validate_function=function(){return validate_answer_qmatrixblank;};QMatrixBlank.prototype.get_getanswer_function=function(){return get_answer_qmatrixblank;};QMatrixBlank.prototype.bind_event_function=function(){bind_event_qmatrixblank(this);};QMatrixBlank.prototype.show_option_msg=function(option_id,msg){$("#"+option_id).next().next().text(msg);};QMatrixBlank.prototype.clear_option_msg=function(option_id){$("#"+option_id).next().next().text("");};QMatrixBlank.prototype.show_edit_error_msg=function(){var msg='请至少添加1个矩阵行和填空项';verify_question_option.show(this.qid,msg);};function QMatrixScore(question){QBase.call(this,question);}QMatrixScore.prototype=new QBase();QMatrixScore.prototype.get_edit_template=function(){return source_qmatrix_score;};QMatrixScore.prototype.get_survey_source=function(){if("is_swap" in this.question.custom_attr)return source_qmatrix_score_swap;return source_qmatrix_score;};QMatrixScore.prototype.get_validate_function=function(){return validate_answer_qmatrixscore;};QMatrixScore.prototype.get_getanswer_function=function(){return get_answer_qmatrixscore;};QMatrixScore.prototype.bind_event_function=function(){bind_event_qmatrixscore(this);};QMatrixScore.prototype.show_edit_error_msg=function(){var msg='请至少添加1个打分项和分值';verify_question_option.show(this.qid,msg);};function QDesc(question){QBase.call(this,question);}QDesc.prototype=new QBase();QDesc.prototype.get_edit_template=function(){if(this.question.custom_attr.disp_type==="split_line")return source_qdesc_split_line;return source_qdesc;};QDesc.prototype.get_survey_source=function(){if(this.question.custom_attr.disp_type==="split_line")return source_qdesc_split_line;return source_qdesc;};function QBlankDropdown(question){QBlank.call(this,question);}QBlankDropdown.prototype=new QBase();QBlankDropdown.prototype.get_edit_template=function(){return source_qblank_dropdown;};QBlankDropdown.prototype.get_survey_source=function(){return source_qblank_dropdown;};QBlankDropdown.prototype.get_validate_function=function(){return validate_answer_qblank_dropdown;};QBlankDropdown.prototype.get_getanswer_function=function(){return get_answer_qblank_dropdown;};QBlankDropdown.prototype.bind_event_function=function(){bind_event_qblank_dropdown(this);};QBlankDropdown.prototype.bind_drop=function(){var drop_type=this.question.custom_attr.drop_type;var qdiv=$("#question_"+this.qid);if(drop_type=="city"||drop_type=="address"){var province=qdiv.find("select:eq(0)");var city=qdiv.find("select:eq(1)");var region=qdiv.find("select:eq(2)");for(var i=0;i<ssq_data.length;i++){var p_obj=ssq_data[i];province.append("<option value="+p_obj.name+">"+p_obj.name+"</option>");}province.change(function(){if(this.value!=""){var val=this.value;var p_obj=ssq_data.filter(function(e){return e.name==val;})[0];city.html("<option value=''>请选择市</option>");for(var i=0;i<p_obj.sub.length;i++){var c_obj=p_obj.sub[i];city.append("<option value="+c_obj.name+">"+c_obj.name+"</option>");}region.html("<option value=''>请选择区/县</option>");}else{city.html("<option value=''>请选择市</option>");region.html("<option value=''>请选择区/县</option>");}});city.change(function(){if(this.value!=""){var c_val=this.value;var p_val=province.val();var p_obj=ssq_data.filter(function(e){return e.name==p_val;})[0];var c_obj=p_obj.sub.filter(function(e){return e.name==c_val;})[0];region.html("<option value=''>请选择区/县</option>");for(var i=0;i<c_obj.sub.length;i++){var area=c_obj.sub[i];region.append("<option value="+area.name+">"+area.name+"</option>");}}else region.html("<option value=''>请选择区/县</option>");});}else if(drop_type=="age"){var year=qdiv.find("select:eq(0)");var month=qdiv.find("select:eq(1)");var date=qdiv.find("select:eq(2)");var now=new Date();for(var i=now.getFullYear();i>=1900;i--)year.append("<option value='"+i+"'>"+i+"</option>");for(var i=1;i<=12;i++)month.append("<option value='"+i+"'>"+i+"</option>");year.change(function(){var days=getDaysInOneMonth(year.val(),month.val());date.html("<option value=''>请选择日</option>");for(var i=1;i<=days;i++)date.append("<option value='"+i+"'>"+i+"</option>");});month.change(function(){var days=getDaysInOneMonth(year.val(),month.val());date.html("<option value=''>请选择日</option>");for(var i=1;i<=days;i++)date.append("<option value='"+i+"'>"+i+"</option>");});year.focus(function(){if(this.value=="")this.value="1980";});}};function QBlankExtra(question){QMultipleBlank.call(this,question);}QBlankExtra.prototype=new QBase();QBlankExtra.prototype.get_edit_template=function(){if(this.question.custom_attr.disp_type==="date")return source_qblank_date;else if(this.question.custom_attr.disp_type==="time")return source_qblank_time;else if(this.question.custom_attr.disp_type==="upload_file")return source_qblank_upload_file;else if(this.question.custom_attr.disp_type===DISP_TYPE_GEOGRAPHICAL)return source_qblank_geographical;};QBlankExtra.prototype.get_survey_source=function(){if(this.question.custom_attr.disp_type==="date")return source_qblank_date;else if(this.question.custom_attr.disp_type==="time")return source_qblank_time;else if(this.question.custom_attr.disp_type==="upload_file")return source_qblank_upload_file;else if(this.question.custom_attr.disp_type===DISP_TYPE_GEOGRAPHICAL)return source_qblank_geographical;};QBlankExtra.prototype.get_validate_function=function(){if(this.question.custom_attr.disp_type==="date")return validate_answer_qblank_date;else if(this.question.custom_attr.disp_type==="time")return validate_answer_qblank_time;else if(this.question.custom_attr.disp_type==="upload_file")return validate_answer_qblank_upload_file;else if(this.question.custom_attr.disp_type===DISP_TYPE_GEOGRAPHICAL)return validate_answer_qblank_geographical;};QBlankExtra.prototype.get_getanswer_function=function(){if(this.question.custom_attr.disp_type==="date")return get_answer_qblank_date;else if(this.question.custom_attr.disp_type==="time")return get_answer_qblank_time;else if(this.question.custom_attr.disp_type==="upload_file")return get_answer_qblank_upload_file;else if(this.question.custom_attr.disp_type===DISP_TYPE_GEOGRAPHICAL)return get_answer_qblank_geographical;};QBlankExtra.prototype.bind_event_function=function(){if(this.question.custom_attr.disp_type==="date")bind_event_qblank_date(this);else if(this.question.custom_attr.disp_type==="time")bind_event_qblank_time(this);else if(this.question.custom_attr.disp_type==="upload_file")bind_event_qblank_upload_file(this);else if(this.question.custom_attr.disp_type===DISP_TYPE_GEOGRAPHICAL)bind_event_qblank_geographical(this);};QBlankExtra.prototype.show_edit_error_msg=function(){var msg='请至少添加1个选项';verify_question_option.show(this.qid,msg);};function QImageSingle(question){QSingle.call(this,question);}QImageSingle.prototype=new QSingle();QImageSingle.prototype.get_edit_template=function(){return source_qimage_single;};QImageSingle.prototype.get_survey_source=function(){return source_qimage_single;};QImageSingle.prototype.get_validate_function=function(){return validate_answer_for_q_image_single;};QImageSingle.prototype.get_getanswer_function=function(){return get_answer_q_image_single;};QImageSingle.prototype.show_edit_error_msg=function(){var msg='请至少添加1张图片';verify_question_option.show(this.qid,msg);};function QImageMultiple(question){QMultiple.call(this,question);}QImageMultiple.prototype=new QMultiple();QImageMultiple.prototype.get_edit_template=function(){return source_qimage_multiple;};QImageMultiple.prototype.get_survey_source=function(){return source_qimage_multiple;};QImageMultiple.prototype.get_validate_function=function(){return validate_answer_q_image_multiple;};QImageMultiple.prototype.get_getanswer_function=function(){return get_answer_q_image_multiple;};QImageMultiple.prototype.bind_event_function=function(){bind_event_q_image_multiple(this);};QImageMultiple.prototype.show_edit_error_msg=function(){var msg='请至少添加1张图片';verify_question_option.show(this.qid,msg);};function QNpsScore(question){QScore.call(this,question);}QNpsScore.prototype=new QScore();QNpsScore.prototype.get_edit_template=function(){return source_qnps_score;};QNpsScore.prototype.get_survey_source=function(){return source_qnps_score;};QNpsScore.prototype.get_validate_function=function(){return validate_answer_qNpsScore;};QNpsScore.prototype.get_getanswer_function=function(){return get_answer_qNpsScore;};QNpsScore.prototype.bind_event_function=function(){bind_event_qNpsScore(this);};function QSingleVote(question){QSingle.call(this,question);}QSingleVote.prototype=new QSingle();QSingleVote.prototype.get_edit_template=function(){return source_qsinglevote;};QSingleVote.prototype.get_survey_source=function(){return source_qsinglevote;};QSingleVote.prototype.bind_event_function=function(){bind_event_qsinglevote(this);};function QMultipleVote(question){QBase.call(this,question);}QMultipleVote.prototype=new QMultiple();QMultipleVote.prototype.get_edit_template=function(){return source_qmultiplevote;};QMultipleVote.prototype.get_survey_source=function(){return source_qmultiplevote;};QMultipleVote.prototype.bind_event_function=function(){bind_event_qmultiplevote(this);};function QImageVoteSingle(question){QSingle.call(this,question);}QImageVoteSingle.prototype=new QImageSingle();QImageVoteSingle.prototype.get_edit_template=function(){return source_qimagevote_single;};QImageVoteSingle.prototype.get_survey_source=function(){return source_qimagevote_single;};QImageVoteSingle.prototype.bind_event_function=function(){bind_event_qimagevote_single(this);};function QImageVoteMultiple(question){QMultiple.call(this,question);}QImageVoteMultiple.prototype=new QImageMultiple();QImageVoteMultiple.prototype.get_edit_template=function(){return source_qimagevote_multiple;};QImageVoteMultiple.prototype.get_survey_source=function(){return source_qimagevote_multiple;};QImageVoteMultiple.prototype.bind_event_function=function(){bind_event_qimagevote_multiple(this);};var QMODEL_CLASS_MAP={};QMODEL_CLASS_MAP[QUESTION_TYPE_SINGLE]=QSingle;QMODEL_CLASS_MAP[QUESTION_TYPE_MULTIPLE]=QMultiple;QMODEL_CLASS_MAP[QUESTION_TYPE_BLANK]=QBlank;QMODEL_CLASS_MAP[QUESTION_TYPE_SCORE]=QScore;QMODEL_CLASS_MAP[QUESTION_TYPE_ORDER]=QOrder;QMODEL_CLASS_MAP[QUESTION_TYPE_MULTIPLE_BLANK]=QMultipleBlank;QMODEL_CLASS_MAP[QUESTION_TYPE_MATRIX_SINGLE]=QMatrixSingle;QMODEL_CLASS_MAP[QUESTION_TYPE_MATRIX_MULTIPLE]=QMatrixMultiple;QMODEL_CLASS_MAP[QUESTION_TYPE_MATRIX_SCORE]=QMatrixScore;QMODEL_CLASS_MAP[QUESTION_TYPE_MATRIX_BLANK]=QMatrixBlank;QMODEL_CLASS_MAP[QUESTION_TYPE_DESC]=QDesc;QMODEL_CLASS_MAP[QUESTION_TYPE_BLANK_DROPDOWN]=QBlankDropdown;var QModelFactory={getQModel:function(question){var QModelClass=QMODEL_CLASS_MAP[question.question_type];if(isNotEmpty(question.custom_attr.disp_type))if(question.question_type===QUESTION_TYPE_MULTIPLE_BLANK)return new QBlankExtra(question);else if(check_in(question.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE])){var disp_type=question.custom_attr.disp_type;if(disp_type=="image_single")return new QImageSingle(question);else if(disp_type=="image_multiple")return new QImageMultiple(question);else if(disp_type=="singlevote")return new QSingleVote(question);else if(disp_type=="multiplevote")return new QMultipleVote(question);else if(disp_type=="imagevote_single")return new QImageVoteSingle(question);else if(disp_type=="imagevote_multiple")return new QImageVoteMultiple(question);else return new QModelClass(question);}else if(check_in(question.question_type,[QUESTION_TYPE_SCORE])){var disp_type=question.custom_attr.disp_type;if(disp_type=="nps_score")return new QNpsScore(question);}else return new QModelClass(question);return new QModelClass(question);}};function filter_option(qmodel){qmodel.option_list=copy_obj(qmodel.get_base_option_list());if("op_random" in qmodel.question.custom_attr)if("last_op_fixed" in qmodel.question.custom_attr){var last_op=qmodel.option_list.pop();qmodel.option_list=qmodel.option_list.shuffle().concat([last_op]);}else qmodel.option_list=qmodel.option_list.shuffle();for(var i=0;i<qmodel.option_list.length;i++){var option=qmodel.option_list[i];check_autoreplace(option);}}function filter_matrixrow(qmodel){qmodel.matrixrow_list=copy_obj(qmodel.get_base_matrixrow_list());if("row_random" in qmodel.question.custom_attr)qmodel.matrixrow_list=qmodel.matrixrow_list.shuffle();for(var i=0;i<qmodel.matrixrow_list.length;i++){var row=qmodel.matrixrow_list[i];check_autoreplace(row);}}function check_autoreplace(obj){var reg=/\[(Q\d{1,3})\]/g;if(isNotEmpty(obj)){if(obj instanceof QBase)obj.title=copy_obj(obj.question.title);if(isNotEmpty(obj.title)){var match_group=obj.title.match(reg);if(isNotEmpty(match_group))for(var i=0;i<match_group.length;i++){var qcid_reg=/(Q\d{1,3})/;var match_str=match_group[i];var qcid=match_str.match(qcid_reg)[0];var qmodel=get_qmodel(qcid);var selected=qmodel.get_selected();if(qmodel.question.question_type==QUESTION_TYPE_BLANK)obj.title=obj.title.replace("["+qcid+"]",selected);else if(selected.constructor==String&&selected!=""){var option=get_option(qmodel.qid,selected);obj.title=obj.title.replace("["+qcid+"]",option.title);}else if(selected.constructor==Array){var replace_content=$.map(selected,function(option_id){var option=get_option(qmodel.qid,option_id);return option.title;});replace_content=replace_content.join(",");obj.title=obj.title.replace("["+qcid+"]",replace_content);}else obj.title=obj.title.replaceAll("["+qcid+"]","");}}}}function get_current_replaced_content(obj){if(!isNotEmpty(obj))return '';var orig_title=copy_obj(obj.title);var ar_items=AUTOREPLACE_OBJ_ID_DICT[get_oid(obj)];for(var i=0;i<ar_items.length;i++){var ar_item=ar_items[i];var source_qmodel=get_qmodel(ar_item.source_qid);var get_answer_func=source_qmodel.get_getanswer_function();var answer=get_answer_func(source_qmodel);if(isNotEmpty(answer)){if(source_qmodel.question.question_type==QUESTION_TYPE_BLANK){var input_value;for(key in answer)input_value=answer[key];orig_title=orig_title.replaceAll(ar_item.tag,input_value);}else if(source_qmodel.question.question_type==QUESTION_TYPE_SINGLE){var option=get_option(source_qmodel.qid,answer[0]);orig_title=orig_title.replaceAll(ar_item.tag,option.title);}else if(source_qmodel.question.question_type==QUESTION_TYPE_MULTIPLE){var replace_content=$.map(answer,function(item){var option_id=item[0];var option=get_option(source_qmodel.qid,option_id);return option.title;}).join("、");if(isNotEmpty(replace_content))orig_title=orig_title.replaceAll(ar_item.tag,replace_content);}}else orig_title=orig_title.replaceAll("["+ar_item.tag+"]","");}if("show_seq" in project.custom_attr){orig_title=orig_title.replace(/<p>/g,'<span>').replace(/<\/p>/g,'</span>');orig_title='<span class="Qnum">'+obj.cid.replace("Q","")+'.</span> '+orig_title;}return orig_title.replace(/\[Q\d{1,3}\]/g,"");}function get_next_page_by_jumpconstraint(qmodel){var jump_list=$.map(qmodel.question.jumpconstraint_id_list2,function(jump_id){var jump=get_jumpconstraint(jump_id);if(jump.jump_to_qid.length===24){var jump_to_q=get_question(jump.jump_to_qid);if(jump_to_q.questionpage_id===qmodel.question.questionpage_id)return;}return jump;});var selected=qmodel.get_selected();if(selected.constructor==String)selected=[selected];var display_and_hide_id_list=get_display_qids_by_answer(qmodel.qid);if(display_and_hide_id_list){var display_list=display_and_hide_id_list[1];if(display_list.indexOf('1')>=0)return '1';if(display_list.indexOf('2')>=0)return '2';}var jump_to_qid=null;for(var i=0;i<jump_list.length;i++){var jump=jump_list[i];if(jump.option_id=="any"&&is_any_condition_match(qmodel))jump_to_qid=jump.jump_to_qid;else for(var k=0;k<selected.length;k++){var option_id=selected[k];if(jump.option_id==option_id)jump_to_qid=jump.jump_to_qid;}}return isNotEmpty(jump_to_qid)?jump_to_qid:null;}function arrayContainsAnotherArray(needle,haystack){for(var i=0;i<needle.length;i++)if(haystack.indexOf(needle[i])===-1)return false;return true;}function is_any_condition_match(qmodel){var match=false;if($("#question_"+qmodel.qid).attr("hideByLogic")!=="1")match=true;return match;}function get_current_q_answer(qid){var qmodel=get_qmodel(qid);var get_answer_func=qmodel.get_getanswer_function();return get_answer_func(qmodel);}function array_contains(totalArray,subArray){var isContain=true;for(var i=0;i<subArray.length;i++)if(totalArray.indexOf(subArray[i])==-1){isContain=false;break;}return isContain;}function get_current_page_answers(current_page,total_answers){var page_answers={};for(var i=0;i<current_page.question_id_list.length;i++){var index=current_page.question_id_list[i];page_answers[index]=total_answers[index];}return page_answers;}function upload_page_answers(data){data._xsrf=$.cookie('_xsrf');var response;$.ajax({url:'/save_page_answers/',data:data,dataType:'json',type:'POST',async:false,success:function(ret){response=ret;},error:function(err){if(err&&err.responseText)response=$.parseJSON(err.responseText);else response={"err_msg":"网络出错，请稍后重试"};}});return response;}function recover_page_answers(page_id,total_answers){var page=get_questionpage(page_id);var page_question_id_list=page.question_id_list;for(var i=0;i<page_question_id_list.length;i++){var qid=page_question_id_list[i];if(qid in total_answers){var answer=total_answers[qid];var question=get_question(qid);var qmodel=get_qmodel(question);if(question.question_type===QUESTION_TYPE_MULTIPLE_BLANK)if(check_in(question.custom_attr.disp_type,["upload_file","date","time"]))var fill_answer_func=FILL_ANSWER_FUNC_MAP[question.custom_attr.disp_type];else var fill_answer_func=FILL_ANSWER_FUNC_MAP[question.question_type];else var fill_answer_func=FILL_ANSWER_FUNC_MAP[question.question_type];fill_answer_func(qmodel,answer);}}}function show_related_options_event(qmodel){$("#question_"+qmodel.qid+" a").click(function(){show_related_options_func(qmodel);});$("#question_"+qmodel.qid+" select").change(function(){show_related_options_func(qmodel);});}function show_related_options_func(qmodel){var answer=get_current_q_answer(qmodel.qid);if(qmodel.question.question_type===QUESTION_TYPE_MULTIPLE)answer=answer.map(function(item){return item[0];});var question_list=[],question_select_list;for(var i=0;i<qmodel.question.option_id_list.length;i++){if(check_in(qmodel.question.option_id_list[i],answer)){$("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").show();$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").removeClass('option-hide');}else{$("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").hide();$("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").find('input.option').prop('checked',false);$("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").find('.jqTransformChecked').removeClass('jqTransformChecked');$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").addClass('option-hide');$("option[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").each(function(index,el){var that=$(el),parent_select=that.parents('.matrix_sel');if(parent_select.val()==that.val())parent_select.val('');});}question_list=$("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").parents('.matrix');question_select_list=$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").parents('.question');update_related_question(question_list,question_select_list,false);}for(var i=0;i<qmodel.question.related_question_list.length;i++)for(var j=0;j<qmodel.question.related_question_list[i].option_id_list.length;j++){var related_option_id=qmodel.question.related_question_list[i].option_id_list[j];if(check_in(related_option_id,answer)){$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").show();$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").removeClass('option-hide');}else{$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").hide();$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").find('input.option').prop('checked',false);$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").find('.jqTransformChecked').removeClass('jqTransformChecked');$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").addClass('option-hide');$("option[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").each(function(index,el){var that=$(el),parent_select=that.parents('.matrix_sel');if(parent_select.val()==that.val())parent_select.val('');});}question_list=$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.matrix');question_select_list=$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.question');update_related_question(question_list,question_select_list,false);}var relations=RELATED_QUESTION_DICT[qmodel.qid];for(var i=0;i<relations.length;i++){var qid=relations[i].qid;if(qid in JUMPCONSTRAINT_SOURCE_Q_DICT||check_in(qid,DISPLAYCONSTRIANT_DEST_QID_LIST))answer_question_logic_event(qid);}selected_related_questions.push(qmodel.qid);}function show_related_options_event_mobile(qmodel){$('#question_'+qmodel.qid+' .checked_wrap').click(function(){show_related_options_func_mobile(qmodel);});$('#question_'+qmodel.qid+' select').change(function(){show_related_options_func_mobile(qmodel);});}function show_related_options_func_mobile(qmodel){var answer=get_current_q_answer(qmodel.qid);if(qmodel.question.question_type===QUESTION_TYPE_MULTIPLE)answer=answer.map(function(item){return item[0];});var question_list=[],question_select_list=[];for(var i=0;i<qmodel.question.option_id_list.length;i++){if(check_in(qmodel.question.option_id_list[i],answer)){$("li[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").show();$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").removeClass('option-hide');}else{$("li[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").removeClass('checked').hide();$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").addClass('option-hide');$("option[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").each(function(index,el){var that=$(el),parent_select=that.parents('.select-box');if(parent_select.val()==that.val())parent_select.val('');});}question_list=$("li[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").parents('.question');question_select_list=$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").parents('.question');update_related_question(question_list,question_select_list,true);}for(var i=0;i<qmodel.question.related_question_list.length;i++)for(var j=0;j<qmodel.question.related_question_list[i].option_id_list.length;j++){var related_option_id=qmodel.question.related_question_list[i].option_id_list[j];if(check_in(related_option_id,answer)){$("li[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").show();$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").removeClass('option-hide');}else{$("li[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").removeClass('checked').hide();$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").addClass('option-hide');$("option[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").each(function(index,el){var that=$(el),parent_select=that.parents('.select-box');if(parent_select.val()==that.val())parent_select.val('');});}question_list=$("li[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.question');question_select_list=$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.question');update_related_question(question_list,question_select_list,true);}var relations=RELATED_QUESTION_DICT[qmodel.qid];if(typeof relations==="undefined")return;for(var i=0;i<relations.length;i++){var qid=relations[i].qid;if(qid in JUMPCONSTRAINT_SOURCE_Q_DICT||check_in(qid,DISPLAYCONSTRIANT_DEST_QID_LIST))answer_question_logic_event(qid);}selected_related_questions.push(qmodel.qid);}function show_related_options(isMobile){for(var i=0;i<selected_related_questions.length;i++){var qmodel=get_qmodel(selected_related_questions[i]);var answer=get_current_q_answer(selected_related_questions[i]);if(qmodel.question.question_type===QUESTION_TYPE_MULTIPLE)answer=answer.map(function(item){return item[0];});var question_list=[],question_select_list=[];for(var j=0;j<qmodel.question.option_id_list.length;j++){if(check_in(qmodel.question.option_id_list[j],answer)){if(isMobile)$("li[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").show();else $("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").show();$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").removeClass('option-hide');}else{if(isMobile)$("li[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").hide();else $("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").hide();$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").addClass('option-hide');}if(isMobile)question_list=$("li[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").parents('.question');else question_list=$("div[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[i]+"']").parents('.matrix');question_select_list=$("span[related-id='related_"+qmodel.qid+"_"+qmodel.question.option_id_list[j]+"']").parents('.question');update_related_question(question_list,question_select_list,isMobile);}for(var m=0;m<qmodel.question.related_question_list.length;m++)for(var n=0;n<qmodel.question.related_question_list[m].option_id_list.length;n++){var related_option_id=qmodel.question.related_question_list[m].option_id_list[n];if(check_in(related_option_id,answer)){if(isMobile)$("li[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").show();else $("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").show();$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").removeClass('option-hide');}else if(isMobile){$("li[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").removeClass('checked').hide();$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").addClass('option-hide');$("option[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").each(function(index,el){var that=$(el),parent_select=that.parents('.select-box');if(parent_select.val()==that.val())parent_select.val('');});}else{$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").hide();$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").find('input.option').prop('checked',false);$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").find('.jqTransformChecked').removeClass('jqTransformChecked');$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").addClass('option-hide');$("option[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").each(function(index,el){var that=$(el),parent_select=that.parents('.matrix_sel');if(parent_select.val()==that.val())parent_select.val('');});}if(isMobile)question_list=$("li[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.question');else question_list=$("div[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.matrix');question_select_list=$("span[related-id='related_"+qmodel.qid+"_"+related_option_id+"']").parents('.question');var flag=isMobile?true:false;update_related_question(question_list,question_select_list,flag);}}}function update_related_question(question_list,question_select_list,isMobile){if(question_list.length>0)if(isMobile)question_list.each(function(index,el){var $question=$(el);if($question.find(".unstyled li:visible").length==0){$question.find('.related-tip').html('此题选项来源于前面题目，请先回答前面题目').show();$question.find('.unstyled').addClass('noborder');}else{$question.find('.related-tip').html('').hide();$question.find('.unstyled').removeClass('noborder');}});else question_list.each(function(index,el){var $matrix=$(el),$question=$matrix.parents('.question');if($matrix.find(".icheckbox_div:visible").length==0)$question.find('.related-tip').html('此题选项来源于前面题目，请先回答前面题目').show();else $question.find('.related-tip').html('').hide();});if(question_select_list.length>0)question_select_list.each(function(index,el){var $question=$(el),$matrix_sel,$select_source=$question.find('.select-source');if(isMobile)$matrix_sel=$question.find('.select-box');else $matrix_sel=$question.find('.matrix_sel');if($question.find('.select-source span.option-hide').length==$question.find('.select-source span').length){$question.find('.related-tip').html('此题选项来源于前面题目，请先回答前面题目').show();$matrix_sel.hide();if(isMobile)$question.find('.phone_select').addClass('noborder');}else{$question.find('.related-tip').html('').hide();$matrix_sel.show();if(isMobile)$question.find('.phone_select').removeClass('noborder');}var default_val=$matrix_sel.val(),select_source_arr=[];$select_source.find('span').each(function(index,el){var that=$(el);if(!that.hasClass('option-hide'))if(that.attr('related-id'))select_source_arr.push('<option value="'+that.attr('data-value')+'" related-id="'+that.attr('related-id')+'">'+that.text()+'</option>');else select_source_arr.push('<option value="'+that.attr('data-value')+'">'+that.text()+'</option>');});$matrix_sel.find('option:gt(0)').remove();$matrix_sel.append(select_source_arr.join(''));$matrix_sel.val(default_val);});}function get_q_answer(qid){var qmodel=get_qmodel(qid);var get_answer_func=qmodel.get_getanswer_function();var answer=get_answer_func(qmodel);if(isNotEmpty(answer))return answer;var ori_answer=answer;if(total_answers&&qid in total_answers){answer=total_answers[qid];if(!isNotEmpty(answer))answer=ori_answer;}return answer;}function get_following_hide_qid_list(qid){if(isNotEmpty(current_page_id)){var answer=get_q_answer(qid);var qmodel=get_qmodel(qid);if(qmodel.question.question_type==QUESTION_TYPE_SCORE)var answerNotEmpty=!check_score_question_answer_empty(answer);else var answerNotEmpty=isNotEmpty(answer);if(answerNotEmpty)return get_following_hide_qid_list_by_answer(qid);else return get_default_following_hide_qid_list(qid);}return [];}function get_default_following_hide_qid_list(qid){var jump_constraint_list=JUMPCONSTRAINT_SOURCE_Q_DICT[qid];var need_hide_qid_list=[];var page=get_questionpage(current_page_id);var q_index=page.question_id_list.indexOf(qid);for(var i=0;i<jump_constraint_list.length;i++){var jump_constraint=jump_constraint_list[i];if(check_in(jump_constraint.next_qid,["1","2"]))if($("#question_"+qid).attr('hidebylogic')=='1')need_hide_qid_list=[];else need_hide_qid_list=need_hide_qid_list.concat(page.question_id_list.slice(q_index+1));else{var next_q_index=page.question_id_list.indexOf(jump_constraint.next_qid);if(next_q_index==-1)need_hide_qid_list=need_hide_qid_list.concat(page.question_id_list.slice(q_index+1));else need_hide_qid_list=need_hide_qid_list.concat(page.question_id_list.slice(q_index+1,next_q_index));}}return need_hide_qid_list.unique();}function get_following_hide_qid_list_by_answer(qid){var answer=get_q_answer(qid);var qmodel=get_qmodel(qid);var jump_constraint_list=JUMPCONSTRAINT_SOURCE_Q_DICT[qid];var need_hide_qid_list=[];for(var i=0;i<jump_constraint_list.length;i++){var condition=jump_constraint_list[i].condition;var next_qid=jump_constraint_list[i].next_qid;if(is_condition_valid(condition)){var page=get_questionpage(current_page_id);var q_index=page.question_id_list.indexOf(qid);if(check_in(next_qid,["1","2"]))need_hide_qid_list=need_hide_qid_list.concat(page.question_id_list.slice(q_index+1));else{var next_q_index=page.question_id_list.indexOf(next_qid);need_hide_qid_list=need_hide_qid_list.concat(page.question_id_list.slice(q_index+1,next_q_index));}}}return need_hide_qid_list.unique();}function get_current_page_hide_qid_list(current_page_id){var page=get_questionpage(current_page_id);var need_hide_qid_list=[];for(var i=0;i<page.question_id_list.length;i++){var qid=page.question_id_list[i];if(qid in DISPLAYCONSTRAINT_SOURCE_Q_DICT&&!check_question_display_logic(qid)){need_hide_qid_list.push(qid);hide_qid_list_by_logic.push(qid);if(total_answers[qid])delete total_answers[qid];}if($("#question_"+qid).length<1||(!$("#question_"+qid).attr("hideByLogic")&&$("#question_"+qid).css('display')=='none')){if($("#question_"+qid).attr("isHide")){need_hide_qid_list.push(qid);hide_qid_list_by_logic.push(qid);}continue;}if((qid in JUMPCONSTRAINT_SOURCE_Q_DICT&&!(qid in DISPLAYCONSTRAINT_SOURCE_Q_DICT))||(qid in JUMPCONSTRAINT_SOURCE_Q_DICT&&!check_in(qid,need_hide_qid_list))){var hide_qid_list=get_following_hide_qid_list(qid);need_hide_qid_list=need_hide_qid_list.concat(hide_qid_list);hide_qid_list_by_logic=hide_qid_list_by_logic.concat(hide_qid_list);}}hide_qid_list_by_logic=hide_qid_list_by_logic.unique();return need_hide_qid_list.unique();}function get_next_qid_by_answer(qid){var answer=get_q_answer(qid);var qmodel=get_qmodel(qid);if(qid in JUMPCONSTRAINT_SOURCE_Q_DICT){var jump_constraint_list=JUMPCONSTRAINT_SOURCE_Q_DICT[qid];if(qmodel.question.question_type==QUESTION_TYPE_SCORE)var answerNotEmpty=!check_score_question_answer_empty(answer);else var answerNotEmpty=isNotEmpty(answer);if(answerNotEmpty){for(var i=0;i<jump_constraint_list.length;i++){var condition=jump_constraint_list[i].condition;if(is_condition_valid(condition))return jump_constraint_list[i].next_qid;}}else{var maxIndex=0;var page=get_questionpage(current_page_id);for(var i=0;i<jump_constraint_list.length;i++){var next_qid=jump_constraint_list[i].next_qid;if(check_in(next_qid,["1","2"]))return next_qid;else if(page.question_id_list.indexOf(next_qid)==-1)return next_qid;else if(page.question_id_list.indexOf(next_qid)>=maxIndex)maxIndex=page.question_id_list.indexOf(next_qid);}return page.question_id_list[maxIndex];}}var page=get_questionpage(current_page_id);var index=page.question_id_list.indexOf(qid);if(index!==page.question_id_list.length-1)return page.question_id_list[index+1];}function get_default_next_qid(qid){var qmodel=get_qmodel(qid);if(qid in JUMPCONSTRAINT_SOURCE_Q_DICT){var jump_constraint_list=JUMPCONSTRAINT_SOURCE_Q_DICT[qid];var maxIndex=0;var page=get_questionpage(current_page_id);for(var i=0;i<jump_constraint_list.length;i++){var next_qid=jump_constraint_list[i].next_qid;if(check_in(next_qid,["1","2"]))return next_qid;else if(page.question_id_list.indexOf(next_qid)==-1)return next_qid;else if(page.question_id_list.indexOf(next_qid)>=maxIndex)maxIndex=page.question_id_list.indexOf(next_qid);}return page.question_id_list[maxIndex];}var page=get_questionpage(current_page_id);var index=page.question_id_list.indexOf(qid);if(index!==page.question_id_list.length-1)return page.question_id_list[index+1];}function answer_question_logic_event(current_qid){var qmodel=get_qmodel(current_qid);var answer=get_q_answer(current_qid);if(qmodel.question.question_type==QUESTION_TYPE_SCORE)var answerNotEmpty=!check_score_question_answer_empty(answer);else var answerNotEmpty=isNotEmpty(answer);var current_page=get_questionpage(current_page_id);var current_q_index=current_page.question_id_list.indexOf(current_qid);var next_qid=get_next_qid_by_answer(current_qid);if(!isNotEmpty(next_qid))return;var need_hide_qid_list=[];if(check_in(next_qid,["1","2"])){need_hide_qid_list=need_hide_qid_list.concat(current_page.question_id_list.slice(current_q_index+1));next_qid=current_qid;next_q_index=current_q_index;}else{var next_q=get_question(next_qid);if(next_q.questionpage_id!==current_page_id){need_hide_qid_list=need_hide_qid_list.concat(current_page.question_id_list.slice(current_q_index+1));next_q_index=current_page.question_id_list.length-1;for(var i=0;i<need_hide_qid_list.length;i++){var qid=need_hide_qid_list[i];hide_question_by_logic(qid);}}else{next_q_index=current_page.question_id_list.indexOf(next_qid);need_hide_qid_list=need_hide_qid_list.concat(current_page.question_id_list.slice(current_q_index+1,next_q_index));if(!answerNotEmpty&&check_in(qmodel.question.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_SCORE]))for(var i=0;i<need_hide_qid_list.length;i++){var qid=need_hide_qid_list[i];if(qid in JUMPCONSTRAINT_SOURCE_Q_DICT){var default_next_qid=get_default_next_qid(qid);if(page.question_id_list.indexOf(default_next_qid)>=page.question_id_list.indexOf(next_qid)){next_qid=default_next_qid;next_q_index=current_page.question_id_list.indexOf(next_qid);}else if(check_in(default_next_qid,["1","2"])){need_hide_qid_list=current_page.question_id_list.slice(current_q_index+1);next_qid=current_qid;next_q_index=current_q_index;}}}var following_qid_list=current_page.question_id_list.slice(next_q_index);for(var i=0;i<following_qid_list.length;i++){var qid=following_qid_list[i];if(qid in JUMPCONSTRAINT_SOURCE_Q_DICT&&check_question_display_logic(qid))need_hide_qid_list=need_hide_qid_list.concat(get_following_hide_qid_list(qid));}}}need_hide_qid_list=need_hide_qid_list.unique();var visible_q_list=[];for(var i=0;i<current_page.question_id_list.length;i++){if(i<current_q_index)continue;var qid=current_page.question_id_list[i];var qmodel=get_qmodel(qid);if(check_in(qid,need_hide_qid_list)){hide_question_by_logic(qid);need_hide_qid_list.push(qid);}else if(qid in DISPLAYCONSTRAINT_SOURCE_Q_DICT)if(check_question_display_logic(qid)){show_question_by_logic(qid);visible_q_list.push(qmodel);}else{hide_question_by_logic(qid);need_hide_qid_list.push(qid);}else if($("#question_"+qid).css("display")==="none"&&!("need_permission" in qmodel.question.custom_attr)){show_question_by_logic(qid);visible_q_list.push(qmodel);}}if(((!next_qid||!(next_qid in JUMPCONSTRAINT_SOURCE_Q_DICT))&&visible_q_list.length))for(var i=0;i<visible_q_list.length;i++){var visible_q=visible_q_list[i];if(visible_q.qid in JUMPCONSTRAINT_SOURCE_Q_DICT)next_qid=visible_q.qid;}if(next_qid.length==24&&next_qid!==current_qid&&check_in(next_qid,current_page.question_id_list)&&next_qid in JUMPCONSTRAINT_SOURCE_Q_DICT&&!check_in(next_qid,need_hide_qid_list))answer_question_logic_event(next_qid);}function get_next_page_by_jumpconstraint(qmodel){var next_qid=get_next_qid_by_answer(qmodel.qid);if(check_in(next_qid,["1","2"]))return next_qid;else if(isNotEmpty(next_qid)){var next_q=get_question(next_qid);if(next_q.questionpage_id==qmodel.question.questionpage_id)return;else return next_qid;}return;}function check_question_display_logic(qid){var qmodel=get_qmodel(qid);if(!(qid in DISPLAYCONSTRAINT_SOURCE_Q_DICT))return true;var display_constraint_list=DISPLAYCONSTRAINT_SOURCE_Q_DICT[qid];for(var i=0;i<display_constraint_list.length;i++){var condition=display_constraint_list[i].condition;if(qmodel.question.custom_attr.condition_relation==CONDITION_RELATION_AND&&!is_condition_valid(condition))return false;else if(qmodel.question.custom_attr.condition_relation==CONDITION_RELATION_OR&&is_condition_valid(condition))return true;}return qmodel.question.custom_attr.condition_relation==CONDITION_RELATION_AND?true:false;}function check_score_question_answer_empty(answer){var keys=Object.keys(answer);for(var i=0;i<keys.length;i++){var option_answer=answer[keys[i]][0];if((option_answer||option_answer==0)&&option_answer!==-1)return false;}return true;}function is_condition_valid(condition){for(var i=0;i<condition.condition_item_list.length;i++){var condition_item=condition.condition_item_list[i];if(condition.logic_relation==CONDITION_RELATION_AND&&!is_condition_item_valid(condition_item))return false;else if(condition.logic_relation==CONDITION_RELATION_OR&&is_condition_item_valid(condition_item))return true;}return condition.logic_relation==CONDITION_RELATION_AND?true:false;}function is_condition_item_valid(condition_item){var qmodel=get_qmodel(condition_item.question_id);var answer=get_q_answer(qmodel.qid);if(qmodel.question.question_type==QUESTION_TYPE_SCORE)var answerNotEmpty=!check_score_question_answer_empty(answer);else var answerNotEmpty=isNotEmpty(answer);if(condition_item.operation_type==CONDITION_OPERATION_TYPE_SELECTED){var display_question_type_list=[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_BLANK,QUESTION_TYPE_MATRIX_SCORE,QUESTION_TYPE_BLANK_DROPDOWN,QUESTION_TYPE_ORDER,QUESTION_TYPE_DESC,QUESTION_TYPE_MULTIPLE_BLANK,QUESTION_TYPE_MATRIX_BLANK];if(display_question_type_list.indexOf(qmodel.question.question_type)!=-1){if(hide_qid_list_by_logic.indexOf(qmodel.qid)==-1)return true;return false;}if(!answerNotEmpty)return false;if(qmodel.question.question_type==QUESTION_TYPE_SINGLE){if(hide_qid_list_by_logic.indexOf(qmodel.qid)!=-1&&$("#question_"+qmodel.qid).attr("hideByLogic"))return false;if(condition_item.option_id=="any")return true;if(check_in(condition_item.option_id,answer))return true;}else if(qmodel.question.question_type==QUESTION_TYPE_MULTIPLE){if(hide_qid_list_by_logic.indexOf(qmodel.qid)!=-1&&$("#question_"+qmodel.qid).attr("hideByLogic"))return false;if(condition_item.option_id=="any")return true;var format_answer=answer.map(function(answer_item){return answer_item[0];});var option_id_list=condition_item.option_id.split(',');var equal=true;for(var i=0;i<option_id_list.length;i++)if(format_answer.indexOf(option_id_list[i])==-1)equal=false;if(equal)return true;}else if(qmodel.question.question_type==QUESTION_TYPE_SCORE)if(condition_item.option_id=="any"){var option_id_list=Object.keys(answer);for(var i=0;i<option_id_list.length;i++){var option_answer=answer[option_id_list[i]];if(option_answer){if(condition_item.score_range.start_score&&condition_item.score_range.start_score=='any')return true;if(parseInt(option_answer)<=parseInt(condition_item.score_range.end_score)&&parseInt(option_answer)>=parseInt(condition_item.score_range.start_score))return true;}}}else{var option_answer=answer[condition_item.option_id]?answer[condition_item.option_id][0]:null;if(option_answer){if(condition_item.score_range.start_score&&condition_item.score_range.start_score=='any')return true;if(parseInt(option_answer)<=parseInt(condition_item.score_range.end_score)&&parseInt(option_answer)>=parseInt(condition_item.score_range.start_score))return true;}}}else if(condition_item.operation_type==CONDITION_OPERATION_TYPE_UNSELECTED){if(!answerNotEmpty)return false;if(qmodel.question.question_type==QUESTION_TYPE_SINGLE){if(condition_item.option_id=="any"&&qmodel.option_list.length!=1)return true;if(condition_item.option_id!="any"&&!check_in(condition_item.option_id,answer))return true;}else if(qmodel.question.question_type==QUESTION_TYPE_MULTIPLE){var format_answer=answer.map(function(answer_item){return answer_item[0];});var option_id_list=condition_item.option_id.split(',');if(condition_item.option_id=="any"&&format_answer!=qmodel.option_list.length)return true;var notEqual=true;for(var i=0;i<option_id_list.length;i++)if(format_answer.indexOf(option_id_list[i])!=-1)notEqual=false;if(notEqual)return true;}else if(qmodel.question.question_type==QUESTION_TYPE_SCORE){if(condition_item.option_id=="any"){var option_id_list=Object.keys(answer);for(var i=0;i<option_id_list.length;i++){var option_answer=answer[option_id_list[i]];if(option_answer){if(condition_item.score_range.start_score&&condition_item.score_range.start_score=='any')return false;if(parseInt(option_answer)<=parseInt(condition_item.score_range.end_score)&&parseInt(option_answer)>=parseInt(condition_item.score_range.start_score))return false;}}}else{var option_answer=answer[condition_item.option_id]?answer[condition_item.option_id][0]:null;if(option_answer){if(condition_item.score_range.start_score&&condition_item.score_range.start_score=='any')return false;if(parseInt(option_answer)<=parseInt(condition_item.score_range.end_score)&&parseInt(option_answer)>=parseInt(condition_item.score_range.start_score))return false;}}return true;}}else if(condition_item.operation_type==CONDITION_OPERATION_TYPE_DISPLAYED){if(hide_qid_list_by_logic.indexOf(qmodel.qid)==-1)return true;}else if(condition_item.operation_type==CONDITION_OPERATION_TYPE_NOTDISPLAYED)if(hide_qid_list_by_logic.indexOf(qmodel.qid)!=-1)return true;return false;}function hide_question_by_logic(qid){if(!$("#question_"+qid).attr("hideByLogic")){$("#question_"+qid).attr("hideByLogic","1").hide();if(hide_qid_list_by_logic.indexOf(qid)==-1)hide_qid_list_by_logic.push(qid);}}function show_question_by_logic(qid){if($("#question_"+qid).attr("hideByLogic"))if(!is_ie7){$("#question_"+qid).attr("hideByLogic",null).hide().slideDown("slow",function(){var questionObj=get_question(qid);if(questionObj.question_type==QUESTION_TYPE_ORDER)sortable_height('question_'+qid);});}else{$("#question_"+qid).attr("hideByLogic",null).show();var questionObj=get_question(qid);if(questionObj.question_type==QUESTION_TYPE_ORDER)sortable_height('question_'+qid);}if(hide_qid_list_by_logic.indexOf(qid)!=-1)hide_qid_list_by_logic.splice(hide_qid_list_by_logic.indexOf(qid),1);}function update_total_answer(prev_page_id,next_page_id){var questionpage_id_list=project.questionpage_id_list;var prev_page_index=questionpage_id_list.indexOf(prev_page_id);var next_page_index=questionpage_id_list.indexOf(next_page_id)!=-1?questionpage_id_list.indexOf(next_page_id):questionpage_id_list.length-1;for(var i=prev_page_index+1;i<next_page_index;i++){var page_id=questionpage_id_list[i];var question_list=QUESTIONPAGE_DICT[page_id].question_list;for(var j=0;j<question_list.length;j++){var qid=question_list[j]._id.$oid;if(total_answers[qid])delete total_answers[qid];}}}var Qiniu_upload=function(file_element_id,token,qid,key,success_callback,fail_callback){var protocol=window.location.protocol.replace(':','');var upload_url=protocol==="http"?"http://up.qiniu.com/":"https://upload.qiniup.com/";$.ajaxFileUpload({url:upload_url,secureuri:false,fileElementId:file_element_id,data:{"token":token,"key":key,"accept":"text/plain"},dataType:"json",success:success_callback,error:fail_callback});};function upload_file(file_element_id,pid,qid,c_uuid){if(test_mode)return;var token;var key;$.ajax({url:site_url+"/f/get_upload_form_params/",type:"GET",data:"pid="+pid+"&qid="+qid+"&u="+c_uuid,dataType:"json",async:false,success:function(ret){token=ret.token;key=ret.key;}});if($("#"+file_element_id).val()!==""&&token!=""){$("#filename_"+qid).text("");$("#question_"+qid).find(".loadingimg").show();uncompleted_upfile.push("keng");$("#file_"+qid).hide();Qiniu_upload(file_element_id,token,qid,key,function(ret,qid){},function(ret,qid,e){$("#tip_"+qid).text("云端服务器或网络出错");$("#file_"+qid).show();});}}function success_upload(ret_str){var ret=eval("("+ret_str+")");var qid=ret.qid;var orig_fname=ret.name;var orig_ftype=ret.type;var suffix;var r=orig_fname.split(".");suffix=r[r.length-1];$("#question_"+qid+" .option").val(ret.key+"."+suffix+"|"+orig_fname);$("#tip_"+qid).text("");$("#filename_"+qid).text(orig_fname);$("#upload_btn_"+qid).text("重新上传");$("#question_"+qid).find(".loadingimg").hide();loadMack({off:'on',Limg:0,text:"上传成功",set:1000});uncompleted_upfile.pop();$("#file_"+qid).show();}function fail_upload(errmsg,qid){if(qid){$("#question_"+qid).find(".loadingimg").hide();if(errmsg=='exceed FsizeLimit')$("#tip_"+qid).text("文件过大");else $("#tip_"+qid).text("云端服务器出错:"+errmsg);}$("#file_"+qid).show();uncompleted_upfile.pop();}var test_code=1;var current_page_id=null;var pwd_window=null;var is_first_page=true;var is_ie7=false;var total_finish_status=null;var IE_error_count=0;var submit_text_arr=["加载中...","正在努力提交中...","网速较慢，请耐心等待..."];var uncompleted_upfile=[];var question_visible_map={};var hide_qid_list_by_logic=[];var need_hide_qid_list_in_display_logic=[];var need_display_qid_obj_in_display_logic={};var question_captcha_map={};var hasAnswerSurvey=false;if(!test_mode&&project.questionpage_id_list.length>1&&!$.isEmptyObject(prev_answers_data)){total_answers={};answer_path=prev_answers_data.answer_path;for(var i=0;i<answer_path.length;i++)$.extend(total_answers,prev_answers_data.answers[answer_path[i]]);current_page_id=answer_path[answer_path.length-1];}jQuery(document).ready(function($){if(window.location.href.indexOf('openapi/weixin')>=0){var furl=getQueryString("furl");if(isNotEmpty(furl))window.location.href='furl';else window.location.href='{0}//{1}/s/{2}/'.format([window.location.protocol,window.location.host,project.short_id]);}if($.browser.msie===true&&$.browser.version==="7.0")is_ie7=true;show_begin_desc();$('#loader_div_1').hide();if(isNotEmpty(verify_types))show_verify_questions();else setTimeout(function(){$(".desc_begin").html(project.begin_desc);show_next_page(true);update_progress();doExtraFunc();},100);window.onbeforeunload=function(evt){if(!hasAnswerSurvey)return;var tipTxt='';pcLeaveTip();if(window.has_lucky_money)tipTxt='红包还有'+remainingTime+'秒到达战场，确定现在放弃？';else if(window.luckyDrawUrl)tipTxt='一大波奖品正在靠近，预计'+remainingTime+'秒后抵达，确定现在放弃？';else if(luck_draw_ad_switch=='off')tipTxt='你的观点对我们很重要。只需'+remainingTime+'秒，请多多指教。';else tipTxt='一大波奖品正在靠近，预计'+remainingTime+'秒后抵达，确定现在放弃？';var message=tipTxt;if(typeof evt=='undefined')evt=window.event;if(evt)evt.returnValue=message;return message;};$("#question_box").on("mousedown",".question",function(){if(!test_mode)hasAnswerSurvey=true;});$("#prev_button").click(function(){show_prev_page();update_progress();doExtraFunc();window.scrollTo(0,0);return false;});$("#next_button").click(function(){window.endTime=new Date();if(is_valid_current_page_answer()){answer_path.push(current_page_id);hide_begin_desc();save_answer();hide_current_page();show_next_page();update_progress();doExtraFunc();window.scrollTo(0,0);return false;}});if(window.has_lucky_money)_hmt.push(['_trackPageview','/s/lucky_money']);if(window.luckyDrawUrl)_hmt.push(['_trackPageview','/s/lucky_draw']);if(window.hide_logo!='False'&&window.luck_draw_ad_switch!='on')_hmt.push(['_trackPageview','/s/hide_logo']);if(window.luck_draw_ad_switch=='off')_hmt.push(['_trackPageview','/s/luck_draw_ad_off']);});function show_begin_desc(){$("#begin_content").show();}function hide_begin_desc(){$("#begin_content").hide();}function bind_icheck(){if("msie" in $.browser&&$.browser.version=="6.0"){}else $('.matrix input').iCheck({checkboxClass:'icheckbox_minimal',radioClass:'iradio_minimal',increaseArea:'20%'});}function hide_current_page(){var page=get_questionpage(current_page_id);for(var i=0;i<page.question_id_list.length;i++){var qid=page.question_id_list[i];var question=get_question(qid);if($("#question_"+get_oid(question)).css('display')==='none'){}else $("#question_"+qid).hide();}}function show_prev_page(){var prev_page_id=answer_path.pop();var p_p_page_id=answer_path.length>=1?answer_path[answer_path.length-1]:null;var page=get_questionpage(current_page_id);for(var i=0;i<page.question_id_list.length;i++){var qid=page.question_id_list[i];if($("#question_"+qid).css('display')==='none'&&$("#question_"+qid).attr('hideByLogic'))$("#question_"+qid).removeAttr('hideByLogic');}hide_current_page();$(".red").text("");current_page_id=p_p_page_id;show_next_page(false,true);setTimeout(function(){recover_page_answers(prev_page_id,total_answers);},200);curr_time_cost=0;}function is_valid_current_page_answer(){var page=get_questionpage(current_page_id);var is_valid=true;var unique_qid_list=[];for(var i=0;i<page.question_id_list.length;i++){var question_id=page.question_id_list[i];if($("#question_"+question_id).length===0||$("#question_"+question_id).css("display")==="none")continue;var qmodel=get_qmodel(question_id);if(is_blank(qmodel.question))if(qmodel.question.custom_attr.hasOwnProperty("data_unique"))unique_qid_list.push(qmodel.qid);var valid_func=qmodel.get_validate_function();if(typeof valid_func=="function")is_valid=is_valid&&valid_func(qmodel);}if(is_valid){var blank_qmodels=$.map(unique_qid_list,function(qid){return get_qmodel(qid);});for(var i=0;i<blank_qmodels.length;i++){var qmodel=blank_qmodels[i];for(var k=0;k<qmodel.question.option_id_list.length;k++){var option_id=qmodel.question.option_id_list[k];$("#"+option_id).removeClass("invalid");$("#tip_"+option_id).hide();}}var check_result=check_answer_unique(blank_qmodels);if(isNotEmpty(check_result)){is_valid=false;for(var i=0;i<page.question_id_list.length;i++){var qid=page.question_id_list[i];if(check_in(qid,unique_qid_list)){scroll_to($("#question_"+qid));break;}}}}if(!is_valid)$("#err_msg").text("请确保所有内容填写正确");else $("#err_msg").text("");return is_valid;}function show_next_page(init,prev){var prev_page_id=current_page_id;var next_page_qmodel_list=get_next_page();if(isNotEmpty(next_page_qmodel_list))if(next_page_qmodel_list=="1"||next_page_qmodel_list=="2"){var is_intact=check_answer_integrity();if(!is_intact){$("#survey_page").html("<div style='text-align: center;padding: 20px;'><strong>保存出错</strong><br/><span style='color:#3c9ccf;padding:0 5px;cursor:pointer;' onclick='javascript:window.location.reload();'>点此</span>刷新, 或把该情况<a style='color:#3c9ccf;padding:0 5px;display:inline;' href='/about/zxzx/'>反馈</a>给我们</div>");return;}try{upload_answer(next_page_qmodel_list);}catch(e){if(!test_mode){var d={'pid':get_oid(project),'message':e.toString(),'stack':e.stack,'url':window.location.href,'cookie':document.cookie};ajaxPost("/js_error",d,function(){});}alert("噢!提交出错鸟!请刷新页面试试看.");}return;}else{if(!test_mode){if(init&&prev_page_id)hide_begin_desc();if(!init&&!prev&&prev_page_id){var prev_page=get_questionpage(prev_page_id);var current_page_answers=get_current_page_answers(prev_page,total_answers);var data={short_id:project.short_id,page_rspd_data_str:toJSONString({answers:current_page_answers,answer_path:answer_path}),timestr:timestr};if(project.checkpoints)data.has_checkpoints=true;var response=upload_page_answers(data);if(response.err_msg){$("#error_msg_box, .preview_model, #control_panel").hide();get_end_page(response,'1');return;}}}show_questions(next_page_qmodel_list);}var current_page_hide_qid_list=get_current_page_hide_qid_list(current_page_id);for(var i=0;i<current_page_hide_qid_list.length;i++){var qid=current_page_hide_qid_list[i];var question=get_question(qid);if(question&&question.question_type===QUESTION_TYPE_DESC&&question.custom_attr.disp_type==="split_line")continue;$("#question_"+qid).attr("hideByLogic","1").hide();$("#question_"+qid).removeAttr("isHide");}show_related_options();if(isNotEmpty(is_iframe))is_first_page?get_iframe_height(-2):get_iframe_height();is_first_page=false;if(answer_path.length>=1&&show_prev_btn)$("#prev_button").show();else $("#prev_button").hide();if(from_idy)start_count_down();else{$("#next_button").show();$("#time_count").hide();}ImgWidthAuto();}function get_next_page(){if(!isNotEmpty(current_page_id)){current_page_id=project.questionpage_id_list[0];var current_page=get_questionpage(current_page_id);return $.map(current_page.question_id_list,function(qid){return get_qmodel(qid);});}else{var current_page_index=project.questionpage_id_list.indexOf(current_page_id);if(current_page_index==project.questionpage_id_list.length-1){var current_page=get_questionpage(current_page_id);var current_page_hide_qid_list=get_current_page_hide_qid_list(current_page_id);if(current_page_hide_qid_list.length===current_page.question_id_list.length)return "1";var dest_qid=null;for(var i=0;i<current_page.question_id_list.length;i++){var question_id=current_page.question_id_list[i];if(!$("#question_"+question_id).length||$("#question_"+question_id).attr("hideByLogic"))continue;var qmodel=get_qmodel(question_id);dest_qid=get_next_page_by_jumpconstraint(qmodel);if(isNotEmpty(dest_qid))break;}if(isNotEmpty(dest_qid))if(check_in(dest_qid,["1","2"]))return dest_qid;return "1";}else{var current_page=get_questionpage(current_page_id);var dest_qid=null;for(var i=0;i<current_page.question_id_list.length;i++){var question_id=current_page.question_id_list[i];if(!$("#question_"+question_id).length||$("#question_"+question_id).attr("hideByLogic"))continue;var qmodel=get_qmodel(question_id);dest_qid=get_next_page_by_jumpconstraint(qmodel);if(check_in(dest_qid,current_page.question_id_list))continue;if(isNotEmpty(dest_qid))break;}var question_id_list=[];var next_page=null;if(isNotEmpty(dest_qid)){if(dest_qid=="1"||dest_qid=="2"){update_total_answer(current_page_id,dest_qid);return dest_qid;}else{var prev_page_id=current_page_id;var next_page_question=get_question(dest_qid);current_page_id=next_page_question.questionpage_id;next_page=get_questionpage(current_page_id);var total_question_id_list=next_page.question_id_list;var dest_qid_index=total_question_id_list.indexOf(dest_qid);if(dest_qid_index>0)for(var i=0;i<dest_qid_index;i++)$("#question_"+total_question_id_list[i]).attr("isHide","true");question_id_list=total_question_id_list.slice(dest_qid_index);update_total_answer(prev_page_id,current_page_id);}}else{current_page_id=project.questionpage_id_list[current_page_index+1];next_page=get_questionpage(current_page_id);question_id_list=next_page.question_id_list;}var current_page_hide_qid_list=get_current_page_hide_qid_list(current_page_id);if(current_page_hide_qid_list.length==next_page.question_id_list.length)return get_next_page();return $.map(question_id_list,function(qid){return get_qmodel(qid);});}}}function show_questions(qmodel_list){for(var i=0;i<qmodel_list.length;i++){var qmodel=qmodel_list[i];if(qmodel.question.custom_attr.hide)continue;check_autoreplace(qmodel);filter_option(qmodel);filter_matrixrow(qmodel);insert_question_html(qmodel);$(".option_open").on("focus",function(){var checkbox=$(this).parent().find("input:checkbox, input:radio");if(!checkbox.attr("checked"))checkbox.prev().click();});}if(mobile_auth_queston_status==MOBILE_AUTH_QUESTION_STATUS_NO_QUOTA)$('.sms_yzm').hide();}function save_answer(){var page=get_questionpage(current_page_id);var current_path_answered_question=[];for(var k=0;k<page.question_id_list.length;k++){var question_id=page.question_id_list[k];try{delete total_answers[question_id];}catch(e){}if(check_hide_for_question(question_id))continue;current_path_answered_question.push(question_id);var qmodel=get_qmodel(question_id);var get_answer_func=qmodel.get_getanswer_function();if(isNotEmpty(get_answer_func)){var answer=get_answer_func(qmodel);if(isNotEmpty(answer))total_answers[qmodel.qid]=answer;}}question_visible_map[current_page_id]=current_path_answered_question;}function upload_answer(finish_status,extraData){total_finish_status=finish_status;$("#error_msg_box, .preview_model, #control_panel").hide();if(show_vcode&&mobile_auth_queston_status!=MOBILE_AUTH_QUESTION_STATUS_NEED_GEETEST){window[captchaFunc](finish_status);return;}if(test_mode){$(".preview_model").show();get_end_page(null,finish_status);}else if(false)get_end_page(null,finish_status);else{$("#loader_text").text(submit_text_arr[0]);$("#loader_div").show();get_iframe_height();

setTimeout(function(){
var code='var s_code = '+func_name+'('+rand_int+')';
eval(code);
var data={"total_answers_str":toJSONString(total_answers),"pconvert_data":toJSONString(pconvert_data),"finish_status":finish_status,"timestr":timestr,"idy_uuid":uuid,

"svc":et([get_oid(project),uuid,timestr],ev)

,"project_version":project.version,"s_code":s_code,"s_func_id":s_func_id,"vvv":vvv,"rand_int":rand_int,"question_captcha_map_str":toJSONString(question_captcha_map)};if(isNotEmpty(extraData))data=$.extend(data,extraData);var full_url=window.location.href;if(isNotEmpty(project.custom_attr.custom_before_post))eval(project.custom_attr.custom_before_post);ajaxPost(window.location.href,data,function(ret){if(ret.status=="200")get_end_page(ret,finish_status);else{}},survey_fail_callback);},1000)

;}}function has_checkpoints(current_page_question_id_list,checkpoints){for(var i=0;i<current_page_question_id_list.length;i++){var qid=current_page_question_id_list[i];if(checkpoints.indexOf(qid)>=0)return true;}return false;}function get_end_page(ret,finish_status){if(!test_mode)hasAnswerSurvey=false;draw_ret=ret;if(ret&&isNotEmpty(ret.redirect_url))window.location.href=ret.redirect_url;if(ret&&isNotEmpty(ret.redirect_uri))window.location.href=ret.redirect_uri;$("#loader_div").hide();$("#survey_end").show();if(project.status==PROJECT_STATUS_FINISHED)$("#end_desc").text("目前该问卷已结束").css({'text-align':'center'});else if(project.status==PROJECT_STATUS_CREATED&&!test_mode)$("#end_desc").text("该问卷已停止收集").css({'text-align':'center'});else if(finish_status=="1"&&!test_mode){if(isNotEmpty(ret)&&ret.err_msg){$("#end_desc").text(ret.err_msg).css({'text-align':'center'});return;}if(project.end_desc==='您已完成本次问卷，感谢您的帮助与支持'){var str='<p style="text-align:center;">'+project.end_desc+'</p>';save_title(str,'end_desc',project._id.$oid);$("#end_desc").html(str);}else $("#end_desc").html(project.end_desc);ImgWidthAuto();_hmt.push(['_trackPageview','/s/survey_success']);set_advertising_cookie(ret.rid);if(isNotEmpty(window.luckyDrawUrl)&&isNotEmpty(ret.rid)){if(luck_draw_rspd_time){var rspdTime=window.endTime-new Date(window.beginTime);if(rspdTime/1000<+luck_draw_rspd_time){if(luck_draw_ad_switch=="off")return;_hmt.push(['_trackPageview','/s/pc_answer_finish_not_show_luckdraw']);luck_draw_flow_distribution({platform:'pc',position:'answer_finish_not_show_luckdraw'});return;}}$('.wjContent').addClass('w100');$(document.body).addClass('padd0');$("#luckdraw_iframe").show().find('iframe').attr('src',window.luckyDrawUrl+'?mid='+ret.rid);$('.footer_mini').remove();$('.share_ld').remove();$('#share_ld1').show();$("#luckdraw_iframe button").live('click',function(){$("#survey_page").slideUp(1000);$("#luckdraw_iframe button").remove();$("#luckdraw_iframe iframe").attr('src',window.luckyDrawUrl+'?mid='+ret.rid+'#/'+project._id.$oid+'/'+project.short_id+'/'+document.title+'/survey');});}if(window.has_lucky_money){if(luck_money_rspd_time){var rspdTime=window.endTime-new Date(window.beginTime);if(rspdTime/1000<+luck_money_rspd_time){if(luck_draw_ad_switch=='off')return;_hmt.push(['_trackPageview','/s/pc_answer_finish_not_show_envelope']);luck_draw_flow_distribution({platform:'pc',position:'answer_finish_not_show_envelope'});return;}}$('body').css('background-color','#ffffff');$('#survey_page').css('top','-25px');$('.wjContent').css({'border':'none','width':'100%','padding':'0','margin':'0'});$('.conthank').css('margin','0');$('#envelopeDiv_box').css({'background-color':'#efefef','width':'100%','margin-top':'0','position':'relative','top':'30px'});$('.footer_mini').css({'background':'#efefef','margin-top':'-25px'});if($('#seq_content').html()=='&nbsp;')$('#seq_content').hide();$('.share_div').css('background','#efefef');ajaxPost("/luckymoney/get_lucky_money/?project_id="+get_oid(project)+"&member_type="+ret.member_type+"&rid="+ret.rid+'&share_survey_url='+window.location.href,{'_xsrf':$.cookie('_xsrf')},function(ret){if(ret.isOk)if(ret.probability)if(ret.lucky_money_amount){$('#envelopeDiv_box').show();lucky_money_amount=ret.lucky_money_amount;lucky_money_url=ret.lucky_money_url;$('#envelope_layer .big_size').text(lucky_money_amount);$('#envelope_layer .red_code').attr('src',lucky_money_url);}else $('#noEnvelope').show();else{$("#envelopeDiv_box").show();if(ret.lucky_money_amount){lucky_money_amount=ret.lucky_money_amount;lucky_money_url=ret.lucky_money_url;$('#envelope_layer .big_size').text(lucky_money_amount);$('#envelope_layer .red_code').attr('src',lucky_money_url);$("#envelopeDiv_box .go_draw_btn_box").attr("name","envelopeDiv");}else $("#envelopeDiv_box .go_draw_btn_box").attr("name","no_EnvelopeDiv_box");}});}if(is_luck_draw_ad_open()&&project.short_id!="yaIbUv"){_hmt.push(['_trackPageview','/s/pc_answer_finish_normal']);luck_draw_flow_distribution({platform:'pc',position:'answer_finish_normal'});}}else if(finish_status=="1"){if(project.end_desc==='您已完成本次问卷，感谢您的帮助与支持'){var str='<p style="text-align:center;">'+project.end_desc+'</p>';save_title(str,'end_desc',project._id.$oid);$("#end_desc").html(str);}else $("#end_desc").html(project.end_desc);ImgWidthAuto();}else if(finish_status=="2"){_hmt.push(['_trackPageview','/s/survey_filter']);$("#end_desc").html(project.custom_attr.screenout_desc||"抱歉，您不太适合填写本次问卷，谢谢您的参与").css({'text-align':'center'});ImgWidthAuto();if(is_luck_draw_ad_open()&&project.short_id!="yaIbUv"){_hmt.push(['_trackPageview','/s/pc_answer_finish_filter']);luck_draw_flow_distribution({platform:'pc',position:'answer_finish_filter'});}}get_iframe_height();if(!test_mode)$.ajax({url:"/finished/",data:"pid="+get_oid(project)});}function update_progress(){var current_page_index=project.questionpage_id_list.indexOf(current_page_id);var progress_percent=parseInt((current_page_index+1)/project.questionpage_id_list.length*100);$(".barbox").css("width",progress_percent+"%");$("#progress_bar span").text(progress_percent+"%");if(parseInt(progress_percent)==100)$("#next_button").html("&nbsp;提  交&nbsp;");else $("#next_button").html("下一页");}function Pop_up(content){var html_h=$("body").height();var wid_h=$(window).height();var mack_h='';html_h>wid_h?mack_h=html_h:mack_h=wid_h;var zw=document.documentElement.clientWidth||document.body.clientWidth;var zh=document.documentElement.clientHeight||document.body.clientHeight;var conW=400;var con=$('<div id="lightBox" class="popupComponent maptss_lightBox" style="display: block; height:'+mack_h+'+px;"><div class="popupCover"></div></div><div class="jsbox" style="display: block;"><div style="width:'+conW+'px;" class="jsboxContent">'+content+'</div></div>');$('body').append(con);var conH=$('.jsbox').height();var conTop=(wid_h/2)-(conH/2)-50;var conLeft=(zw/2)-(conW/2);$('.jsbox').css({'top':conTop+'px','left':conLeft+'px'});return con;}function Width_mate(id){var obj=$('#'+id);var objTable=$('table tr:eq(0) td',obj);var l=objTable.length;var mean_width=80/(l-1);objTable.each(function(index,element){if(index==0)$(this).attr('width',(20/100*900)+'');else $(this).attr('width',(mean_width/100*900)+'');});}function insert_question_html(qmodel){var qdiv=$("#question_"+qmodel.qid);if(use_cache!='1')if(qdiv.length!==0){qdiv.before(qmodel.gen_survey_template());qdiv.empty().remove();}else $("#question_box").append(qmodel.gen_survey_template());$('#question_'+qmodel.qid).jqTransform();qmodel.bind_event_function();if(check_in(qmodel.question.question_type,[QUESTION_TYPE_MATRIX_SINGLE,QUESTION_TYPE_MATRIX_SCORE,QUESTION_TYPE_MATRIX_MULTIPLE,QUESTION_TYPE_MATRIX_BLANK])){Width_mate("question_"+qmodel.qid);if('col_width' in qmodel.question.custom_attr)getMatrixWidth(qmodel.qid,qmodel.question.custom_attr.col_width.parseJSON());}if((check_in(qmodel.question.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE,QUESTION_TYPE_SCORE,QUESTION_TYPE_MULTIPLE_BLANK])&&qmodel.qid in JUMPCONSTRAINT_SOURCE_Q_DICT)||check_in(qmodel.qid,DISPLAYCONSTRIANT_DEST_QID_LIST))bind_logic_event(qmodel);if(qmodel.qid in AUTOREPLACE_SOURCE_Q_DICT)bind_replace_event(qmodel);if(qmodel.qid in RELATED_QUESTION_DICT)show_related_options_event(qmodel);}function bind_logic_event(qmodel){if(qmodel.question.question_type===QUESTION_TYPE_SINGLE&&qmodel.question.custom_attr.disp_type==="dropdown")$("#question_"+qmodel.qid+" select").change(function(){answer_question_logic_event(qmodel.qid);});else if(qmodel.question.question_type===QUESTION_TYPE_SCORE){$("#question_"+qmodel.qid+" .div_float").click(function(){if(!$(this).hasClass("score_slider_box"))answer_question_logic_event(qmodel.qid);});}else $("#question_"+qmodel.qid+" a").click(function(){answer_question_logic_event(qmodel.qid);});}function bind_replace_event(qmodel){if(check_in(qmodel.question.question_type,[QUESTION_TYPE_SINGLE,QUESTION_TYPE_MULTIPLE]))if(qmodel.question.question_type==QUESTION_TYPE_SINGLE&&qmodel.question.custom_attr.disp_type=="dropdown")$("#question_"+qmodel.qid+" select").change(function(){var qid=$(this).attr("rel").replace("question_","");do_replace_for_question(qid);});else $("#question_"+qmodel.qid+" a").click(function(){var qdiv=$(this).parents(".question","div");var qid=qdiv.attr("id").replace("question_","");do_replace_for_question(qid);});else $("#question_"+qmodel.qid).find(".option").blur(function(){var qdiv=$(this).parents(".question","div");var qid=qdiv.attr("id").replace("question_","");do_replace_for_question(qid);});}function do_replace_for_question(qid){var qmodel=get_qmodel(qid);var get_answer_func=qmodel.get_getanswer_function();var ar_items=AUTOREPLACE_SOURCE_Q_DICT[qmodel.qid];for(var i=0;i<ar_items.length;i++){var ar_item=ar_items[i];var obj;switch(ar_item.dest_type){case 1:obj=get_question(ar_item.obj_id);var new_title=get_current_replaced_content(obj);$("#question_"+ar_item.obj_id+" .title").html(new_title);break;case 2:obj=get_option(ar_item.question_id,ar_item.obj_id);var new_title=get_current_replaced_content(obj);$(".label_"+ar_item.obj_id).html(new_title);break;case 3:obj=get_matrixrow(ar_item.question_id,ar_item.obj_id);var new_title=get_current_replaced_content(obj);$(".label_"+ar_item.obj_id).html(new_title);break;}}}function getMatrixWidth(qid,data){var table_width=0;$("#question_"+qid+" .wjtable > tbody > tr").each(function(m){table_width=0;$(this).children("td").each(function(i){if(data[i]==undefined)data[i]=data[i-1];;$(this).wrapInner('<div class="tdiv"></div>');$(this).children(".tdiv").width(data[i]-1+"px");$(this).width(data[i]+"px");table_width+=data[i];});});$("#question_"+qid+" .wjtable").width(table_width);}var upload_error_count=0;function survey_fail_callback(XMLHttpRequest,textStatus,errorThrown){var http_code=XMLHttpRequest.status;http_code=parseInt(http_code);if(http_code===null||parseInt(http_code)===200){get_end_page({},total_finish_status);return;}if(http_code>12000)if(IE_error_count<3){IE_error_count+=1;upload_answer(total_finish_status);return;}if(http_code===400){upload_answer_with_form(total_finish_status);return;}var error_text="提交失败, 请检查网络并重试";var error_type="";if(textStatus=="timeout"){error_text="提交失败，请检查网络并重新提交";error_type="timeout";}else if(http_code>400&&http_code<500){error_text="提交失败, 请刷新页面重新作答, 或联系我们";error_type="client_error";}else if(http_code>=500){error_text="提交失败";error_type="server_error";}survey_error_controller(http_code,error_type,error_text);}var try_count=0;function survey_error_controller(http_code,error_type,error_text){$("#loader_div").hide();$("#reupload_answer").off().on("click",function(){upload_answer(total_finish_status);});if(try_count==0&&error_type=="timeout"){$("#error_msg_box .error_text").html("{0}<br/><span style='padding: 0px; font-size: 14px; color:#888888;'>({1})</span>".format([error_text,http_code]));$("#reupload_answer").show();$("#fankui").hide();}else if(error_type==""&&http_code==0){$("#error_msg_box .error_text").html("{0}<br/><span style='padding: 0px; font-size: 14px; color:#888888;'>({1})</span>".format([error_text,http_code]));$("#reupload_answer").show();$("#fankui").hide();}else if(try_count>0){$("#error_msg_box .error_text").html("又失败了<br>");$("#reupload_answer").hide();var fankui_href="/about/zxzx/?err_code="+http_code;$("#fankui").show().attr("href",fankui_href);}else{$("#error_msg_box .error_text").html("{0}<br/><span style='padding: 0px; font-size: 14px; color:#888888;'>({1})</span>".format([error_text,http_code]));$("#reupload_answer").hide();var fankui_href="/about/zxzx/?err_code="+http_code;$("#fankui").show().attr("href",fankui_href);}$("#error_msg_box").show();}function get_curr_page_time_cost(){var current_page=get_questionpage(current_page_id);var q_list=$.map(current_page.question_id_list,function(qid){return get_qmodel(qid);});var time_cost=q_list.reduce(function(cost_sec,q){if($("#question_"+q.qid).is(":visible"))return cost_sec+q.estimate_time();else return cost_sec;},0);return time_cost;}var timer=null;function count_down(){if(curr_time_cost>1){--curr_time_cost;$("#time_count").show().text(curr_time_cost);$("#next_button").hide();timer=window.setTimeout(function(){count_down();},1000);}else{$("#timeremain").text("");$("#time_count").hide();$("#next_button").show();curr_time_cost=0;window.clearTimeout(timer);return false;}}function start_count_down(){curr_time_cost=get_curr_page_time_cost();count_down();}function submit_counter(){$("#loader_text").text(submit_text_arr[0]);setTimeout(function(){$("#loader_text").text(submit_text_arr[1]);},5000);setTimeout(function(){$("#loader_text").text(submit_text_arr[2]);},10000);}function show_verify_questions(){$(".desc_begin").html("<p>请验证如下信息</p>");for(var i=0;i<verify_types.length;i++){var v_type=verify_types[i];var q_html=get_verify_q_html(v_type);$("#question_box").append(q_html);};$(".v_question").jqTransform();$("#progress_bar").hide();$("#confirm_verify_btn").show();$("#confirm_verify_btn").click(commit_verify_info);}var pconvert_data={};function commit_verify_info(){var is_valid=true;$(".v_question").each(function(){if($(this).find("input:radio").length>0){var selected_radio=$(this).find("input:radio:checked");if(selected_radio.length<1){is_valid=false;return;}pconvert_data[selected_radio.attr("name")]=selected_radio.val();}else if($(this).find("select").length>0){var select=$(this).find("select");if(!isNotEmpty(select.val())){is_valid=false;return;}pconvert_data[select.attr("name")]=select.val();}});if(!is_valid){$("#err_msg").text("请填写所有内容");return false;}$(".v_question").hide();$("#confirm_verify_btn").hide();$("#loader_div").show();$("#control_panel").hide();var href=window.location.href;var uri_params=href.substring(href.indexOf("?"));setTimeout(function(){ajaxPost("/pconvert/ajax/condition_check/"+get_oid(project)+"/"+uri_params,{'answers':toJSONString(pconvert_data)},function(ret){$("#loader_div").hide();if(ret.type===1){$("#control_panel").show();if(project.questionpage_id_list.length>1)$("#progress_bar").show();$(".desc_begin").html(project.begin_desc);show_next_page();update_progress();doExtraFunc();}else if(ret.type===2||ret.type===3){$("#begin_content").hide();$("#survey_end").show();$("#show_results").hide();$("#end_desc").text("抱歉，你不太适合填写本问卷").css({'text-align':'center'});}});},1000);}function upload_answer_with_form(finish_status)

{var code='var s_code = '+func_name+'('+rand_int+')';


eval(code);$("#upload_form #pconvert_data").val(toJSONString(pconvert_data));
$("#upload_form #s_code").val(s_code);
$("#upload_form #total_answers_str").val(toJSONString(total_answers));$("#upload_form #finish_status").val(finish_status);

$("#upload_form #svc").val(
et([get_oid(project),uuid,timestr],ev)
);


$("#upload_form").attr("action",window.location.href);$("#upload_form").submit();}function get_all_question_estimate_time(){var cost_time=0;for(var qid in QUESTION_DICT){var q=QUESTION_DICT[qid];var qmodel=get_qmodel(q);cost_time+=qmodel.estimate_time();}return parseInt(cost_time);}function get_oid(obj){if(obj.hasOwnProperty("_id"))return obj._id.$oid;return "";}function save_title(title,type,id){var data={type:type,content:title,oid:id};ajaxPost('/edit/ajax/save_content/'+get_oid(project),data);}function is_luck_draw_ad_open(){if(luck_draw_ad_switch=='on')if(!window.has_lucky_money&&!window.luckyDrawUrl)return true;else return false;else if(luck_draw_ad_switch=="None")if(!window.has_lucky_money&&!window.luckyDrawUrl&&window.hide_logo=='False')return true;else return false;else return false;}var age={'en_name':'age','cn_name':'年龄','option_list':['unlimit_20','21_30','31_40','41_45','46_unlimit'],'left_option_list':['unlimit','21','31','41','46'],'right_option_list':['20','30','40','45','unlimit'],'unlimit_unlimit':{'rmb':0},'unlimit_20':{'cn_name':'20岁以下','rmb':10},'21_30':{'cn_name':'21-30岁','rmb':2},'31_40':{'cn_name':'31-40岁','rmb':4},'41_45':{'cn_name':'41-45岁','rmb':6},'46_unlimit':{'cn_name':'46岁以上','rmb':10}};var educational={'en_name':'educational','cn_name':'学历','option_list':['junior_school','senior_school','junior_college','undergraduate_degree','master_degree','doctor_degree'],'junior_school':{'cn_name':'初中及以下','rmb':10},'senior_school':{'cn_name':'高中/中专/技校','rmb':8},'junior_college':{'cn_name':'大专及以上','rmb':6},'undergraduate_degree':{'cn_name':'本科/学士及以上','rmb':6},'master_degree':{'cn_name':'硕士/研究生','rmb':8},'doctor_degree':{'cn_name':'博士','rmb':15}};var career={'en_name':'career','cn_name':'职业','option_list':['student','company_employer','civil_servants','service_industry_employer','freelance','unemployed','retirement','housewife'],'student':{'cn_name':'学生','rmb':5},'company_employer':{'cn_name':'公司职员','rmb':4},'civil_servants':{'cn_name':'公务员/事业单位员工','rmb':8},'service_industry_employer':{'cn_name':'服务行业员工','rmb':5},'freelance':{'cn_name':'私营业主/自由职业者','rmb':10},'unemployed':{'cn_name':'待业','rmb':5},'retirement':{'cn_name':'退休','rmb':10},'housewife':{'cn_name':'居家','rmb':6}};var marital_status={'en_name':'marital_status','cn_name':'婚姻状况','option_list':['married','unmarried','divorced','widowed'],'married':{'cn_name':'已婚','rmb':3},'unmarried':{'cn_name':'未婚','rmb':3},'divorced':{'cn_name':'离异','rmb':6},'widowed':{'cn_name':'丧偶','rmb':8}};var household_income={'en_name':'household_income','cn_name':'家庭月收入','option_list':['lte_4000','4001_8000','8001_15000','15001_25000','gte_25001'],'lte_4000':{'cn_name':'4000元及以下','rmb':6},'4001_8000':{'cn_name':'4001-8000元','rmb':5},'8001_15000':{'cn_name':'8001-15000元','rmb':4},'15001_25000':{'cn_name':'15001-25000元','rmb':4},'gte_25001':{'cn_name':'15001-25000元','rmb':6}};var mobile_brand={'en_name':'mobile_brand','cn_name':'手机品牌','option_list':['huawei','oppo','apple','vivo','xiaomi','samsung','meizu','gionee','letv','coolpad','lenovo','honor','nubia'],'huawei':{'cn_name':'华为','rmb':5},'oppo':{'cn_name':'oppo','rmb':5},'apple':{'cn_name':'苹果','rmb':4},'vivo':{'cn_name':'vivo','rmb':5},'xiaomi':{'cn_name':'小米','rmb':5},'samsung':{'cn_name':'三星','rmb':4},'meizu':{'cn_name':'魅族','rmb':5},'gionee':{'cn_name':'金立','rmb':5},'letv':{'cn_name':'乐视','rmb':6},'coolpad':{'cn_name':'酷派','rmb':6},'lenovo':{'cn_name':'联想','rmb':6},'honor':{'cn_name':'荣耀','rmb':6},'nubia':{'cn_name':'努比亚','rmb':6}};var feature_list=["age","educational","career","marital_status","household_income","mobile_brand"];var feature_dict={"age":age,"educational":educational,"career":career,"marital_status":marital_status,"household_income":household_income,"mobile_brand":mobile_brand};var q_sex='<div class="wjques maxtop v_question">'+'<div class="title">'+'你的性别是？'+'</div>'+'<div class="matrix">'+'<div class="icheckbox_div" style="">'+'<input type="radio" name="sex" value="male" id="sex_male" class="option">'+'<label for="sex_male" class="option_label" style="cursor: pointer;">男</label>'+'</div>'+'<div class="icheckbox_div" style="">'+'<input type="radio" name="sex" value="female" id="sex_female" class="option">'+'<label for="sex_female" class="option_label" style="cursor: pointer;">女</label>'+'</div>'+'</div>'+'</div>';var q_birth='<div class="wjques maxtop v_question jqtransformdone">'+'<div class="title">你的出生年份是？</div>'+'<div class="matrix">'+'<select class="matrix_sel" name="age">'+'<option value="">--请选择一个选项--</option>'+'</select>'+'</div>'+'</div>';function get_verify_q_html(type){if(type==="sex")return q_sex;else if($.inArray(type,feature_list)!=-1){var source=$(q_birth);var feature=feature_dict[type];var title=feature.cn_name;var added_source="";if(type=="age"){title="出生年份";var date=new Date();for(var i=1949;i<=date.getFullYear();i++)added_source+='<option value="'+i+'">'+i+'</option>';}else{var option_list=feature.option_list;for(var i=0;i<option_list.length;i++){var option=option_list[i];added_source+='<option value="'+option+'">'+feature[option].cn_name+'</option>';}}source.find(".title").text("您的"+title+"是？");source.find("select").attr("name",type).append(added_source);return source;}return "";}function captchaChiChar(finish_status){var validate_obj=Object;validate_obj.title='验证码';var content=''+'<div class="popup_submit_validation">'+'<div class="text">'+'<input type="text" placeholder="请输入验证码" />'+'<img id="vcode_image" src="/get_vcode/'+project.short_id+'?m='+Math.random()+'"/>'+'</div>'+'<p class="error"></p>'+'</div>';validate_obj.content=content;validate_obj.obj=function(){var $popupSubmitValidation=$('.popup_submit_validation');var $input=$popupSubmitValidation.find('input');var $error=$popupSubmitValidation.find('.error');if($input.val()==''){$input.focus();$error.html('验证码不能为空');return false;}else{var is_invalid=false;syncPost("/get_vcode/"+project.short_id+"/",{"vcode":$input.val()},function(response){if(response.is_valid){show_vcode=false;$("#survey_page").show();$(".footer_mini").show();upload_answer(finish_status,{'vcode':$input.val()});}else{$error.html("验证码有误, 请重新输入");is_invalid=true;}});if(is_invalid)return false;}};validate_obj.conw=340;$("#survey_page").hide();$(".footer_mini").hide();jsAlert(validate_obj);$("#vcode_image").click(function(){$(this).attr("src",'/get_vcode/'+project.short_id+'?m='+Math.random());});}function captchaGeeTest(finish_status){$("#survey_page, .footer_mini").hide();gt_captcha_obj.appendTo('#gt');$("#gt").show();gt_captcha_obj.onSuccess(function(){var validate=gt_captcha_obj.getValidate();if(isNotEmpty(validate)){$("#gt").hide();show_vcode=false;$("#survey_page").show();$(".footer_mini").show();upload_answer(finish_status,validate);}else alert('验证码错误!');});}function captchaLSM(finish_status){$("#survey_page, .footer_mini").hide();$(".lsm_bg,.lsm_bg .l-captcha").show();show_vcode=false;lsmCbFinishStatus=finish_status;uploadFunc=upload_answer;}var ssq_data=[{"name":"北京市","sub":[{"name":"北京市","sub":[{"name":"东城区"},{"name":"西城区"},{"name":"朝阳区"},{"name":"丰台区"},{"name":"石景山区"},{"name":"海淀区"},{"name":"门头沟区"},{"name":"房山区"},{"name":"通州区"},{"name":"顺义区"},{"name":"昌平区"},{"name":"大兴区"},{"name":"怀柔区"},{"name":"平谷区"},{"name":"密云区"},{"name":"延庆区"},{"name":"经济技术开发区"}]}]},{"name":"天津市","sub":[{"name":"天津市","sub":[{"name":"和平区"},{"name":"滨海新区"},{"name":"津南区"},{"name":"河东区"},{"name":"河西区"},{"name":"南开区"},{"name":"河北区"},{"name":"红桥区"},{"name":"东丽区"},{"name":"西青区"},{"name":"北辰区"},{"name":"武清区"},{"name":"宝坻区"},{"name":"宁河区"},{"name":"静海区"},{"name":"蓟州区"}]}]},{"name":"河北省","sub":[{"name":"石家庄市","sub":[{"name":"长安区"},{"name":"桥东区"},{"name":"桥西区"},{"name":"新华区"},{"name":"裕华区"},{"name":"井陉矿区"},{"name":"藁城区"},{"name":"鹿泉区"},{"name":"栾城区"},{"name":"井陉县"},{"name":"正定县"},{"name":"行唐县"},{"name":"灵寿县"},{"name":"高邑县"},{"name":"深泽县"},{"name":"赞皇县"},{"name":"无极县"},{"name":"平山县"},{"name":"元氏县"},{"name":"赵县"},{"name":"晋州市"},{"name":"新乐市"},{"name":"高新技术开发区"}]},{"name":"唐山市","sub":[{"name":"路南区"},{"name":"路北区"},{"name":"古冶区"},{"name":"开平区"},{"name":"丰南区"},{"name":"丰润区"},{"name":"滦县"},{"name":"滦南县"},{"name":"乐亭县"},{"name":"迁西县"},{"name":"玉田县"},{"name":"曹妃甸区"},{"name":"遵化市"},{"name":"迁安市"},{"name":"海港开发区"},{"name":"高新开发区（滨江）"},{"name":"芦台开发区"},{"name":"汉沽管理区"}]},{"name":"秦皇岛市","sub":[{"name":"海港区"},{"name":"北戴河区"},{"name":"北戴河新区"},{"name":"青龙满族自治县"},{"name":"山海关区"},{"name":"昌黎县"},{"name":"抚宁区"},{"name":"经济技术开发区"},{"name":"卢龙县"}]},{"name":"邯郸市","sub":[{"name":"邯山区"},{"name":"丛台区"},{"name":"复兴区"},{"name":"峰峰矿区"},{"name":"邯郸县"},{"name":"临漳县"},{"name":"成安县"},{"name":"大名县"},{"name":"涉县"},{"name":"磁县"},{"name":"肥乡县"},{"name":"永年县"},{"name":"邱县"},{"name":"鸡泽县"},{"name":"广平县"},{"name":"馆陶县"},{"name":"魏县"},{"name":"曲周县"},{"name":"武安市"}]},{"name":"邢台市","sub":[{"name":"桥东区"},{"name":"桥西区"},{"name":"邢台县"},{"name":"临城县"},{"name":"内丘县"},{"name":"柏乡县"},{"name":"隆尧县"},{"name":"任县"},{"name":"南和县"},{"name":"宁晋县"},{"name":"巨鹿县"},{"name":"新河县"},{"name":"广宗县"},{"name":"平乡县"},{"name":"威县"},{"name":"清河县"},{"name":"临西县"},{"name":"南宫市"},{"name":"开发区"},{"name":"大曹庄"},{"name":"沙河市"}]},{"name":"保定市","sub":[{"name":"高新区"},{"name":"竞秀区"},{"name":"满城区"},{"name":"莲池区"},{"name":"清苑区"},{"name":"涞水县"},{"name":"阜平县"},{"name":"徐水区"},{"name":"定兴县"},{"name":"唐县"},{"name":"高阳县"},{"name":"容城县"},{"name":"涞源县"},{"name":"望都县"},{"name":"安新县"},{"name":"易县"},{"name":"曲阳县"},{"name":"蠡县"},{"name":"顺平县"},{"name":"博野县"},{"name":"雄县"},{"name":"涿州市"},{"name":"安国市"},{"name":"高碑店市"}]},{"name":"张家口市","sub":[{"name":"桥东区"},{"name":"桥西区"},{"name":"宣化区"},{"name":"下花园区"},{"name":"张北县"},{"name":"康保县"},{"name":"沽源县"},{"name":"尚义县"},{"name":"蔚县"},{"name":"阳原县"},{"name":"怀安县"},{"name":"万全区"},{"name":"怀来县"},{"name":"涿鹿县"},{"name":"宣化县"},{"name":"赤城县"},{"name":"崇礼区"}]},{"name":"承德市","sub":[{"name":"双桥区"},{"name":"双滦区"},{"name":"鹰手营子矿区"},{"name":"承德县"},{"name":"兴隆县"},{"name":"平泉县"},{"name":"滦平县"},{"name":"隆化县"},{"name":"丰宁满族自治县"},{"name":"宽城满族自治县"},{"name":"围场满族自治县"}]},{"name":"沧州市","sub":[{"name":"新华区"},{"name":"运河区"},{"name":"沧县"},{"name":"青县"},{"name":"东光县"},{"name":"海兴县"},{"name":"盐山县"},{"name":"肃宁县"},{"name":"南皮县"},{"name":"吴桥县"},{"name":"献县"},{"name":"孟村回族自治县"},{"name":"渤海新区"},{"name":"经济开发区"},{"name":"沧州高新区"},{"name":"临港经济技术开发区"},{"name":"泊头市"},{"name":"任丘市"},{"name":"黄骅市"},{"name":"河间市"}]},{"name":"廊坊市","sub":[{"name":"安次区"},{"name":"广阳区"},{"name":"固安县"},{"name":"永清县"},{"name":"香河县"},{"name":"大城县"},{"name":"文安县"},{"name":"大厂回族自治县"},{"name":"廊坊开发区"},{"name":"霸州市"},{"name":"三河市"}]},{"name":"衡水市","sub":[{"name":"桃城区"},{"name":"枣强县"},{"name":"武邑县"},{"name":"武强县"},{"name":"饶阳县"},{"name":"安平县"},{"name":"故城县"},{"name":"景县"},{"name":"阜城县"},{"name":"冀州区"},{"name":"开发区"},{"name":"滨湖新区"},{"name":"深州市"}]},{"name":"省直辖县级行政区划","sub":[{"name":"定州市"},{"name":"辛集市"}]}]},{"name":"山西省","sub":[{"name":"太原市","sub":[{"name":"小店区"},{"name":"迎泽区"},{"name":"杏花岭区"},{"name":"尖草坪区"},{"name":"万柏林区"},{"name":"晋源区"},{"name":"清徐县"},{"name":"阳曲县"},{"name":"娄烦区"},{"name":"古交市"}]},{"name":"大同市","sub":[{"name":"城区"},{"name":"矿区"},{"name":"南郊区"},{"name":"新荣区"},{"name":"阳高县"},{"name":"天镇县"},{"name":"广灵县"},{"name":"灵丘县"},{"name":"浑源县"},{"name":"左云县"},{"name":"大同县"}]},{"name":"阳泉市","sub":[{"name":"城区"},{"name":"矿区"},{"name":"郊区"},{"name":"平定县"},{"name":"盂县"}]},{"name":"长治市","sub":[{"name":"城区"},{"name":"郊区"},{"name":"长治县"},{"name":"襄垣县"},{"name":"屯留县"},{"name":"平顺县"},{"name":"黎城县"},{"name":"壶关县"},{"name":"长子县"},{"name":"武乡县"},{"name":"沁县"},{"name":"沁源县"},{"name":"高新区"},{"name":"潞城市"}]},{"name":"晋城市","sub":[{"name":"城区"},{"name":"沁水县"},{"name":"阳城县"},{"name":"陵川县"},{"name":"泽州县"},{"name":"高平市"}]},{"name":"朔州市","sub":[{"name":"朔城区"},{"name":"平鲁区"},{"name":"山阴县"},{"name":"应县"},{"name":"右玉县"},{"name":"怀仁县"}]},{"name":"晋中市","sub":[{"name":"榆次区"},{"name":"榆社县"},{"name":"左权县"},{"name":"和顺县"},{"name":"昔阳县"},{"name":"寿阳县"},{"name":"太谷县"},{"name":"祁县"},{"name":"平遥县"},{"name":"灵石县"},{"name":"介休市"}]},{"name":"运城市","sub":[{"name":"盐湖区"},{"name":"临猗县"},{"name":"万荣县"},{"name":"闻喜县"},{"name":"稷山县"},{"name":"新绛县"},{"name":"绛县"},{"name":"垣曲县"},{"name":"夏县"},{"name":"平陆县"},{"name":"芮城县"},{"name":"永济市"},{"name":"河津市"}]},{"name":"忻州市","sub":[{"name":"忻府区"},{"name":"定襄县"},{"name":"五台县"},{"name":"代县"},{"name":"繁峙县"},{"name":"宁武县"},{"name":"静乐县"},{"name":"神池县"},{"name":"五寨县"},{"name":"岢岚县"},{"name":"河曲县"},{"name":"保德县"},{"name":"偏关县"},{"name":"原平市"}]},{"name":"临汾市","sub":[{"name":"尧都区"},{"name":"曲沃县"},{"name":"翼城县"},{"name":"襄汾县"},{"name":"洪洞县"},{"name":"古县"},{"name":"安泽县"},{"name":"浮山县"},{"name":"吉县"},{"name":"乡宁县"},{"name":"大宁县"},{"name":"隰县"},{"name":"永和县"},{"name":"蒲县"},{"name":"汾西县"},{"name":"侯马市"},{"name":"霍州市"}]},{"name":"吕梁市","sub":[{"name":"离石区"},{"name":"文水县"},{"name":"交城县"},{"name":"兴县"},{"name":"临县"},{"name":"柳林县"},{"name":"石楼县"},{"name":"岚县"},{"name":"方山县"},{"name":"中阳县"},{"name":"交口县"},{"name":"孝义市"},{"name":"汾阳市"}]}]},{"name":"内蒙古自治区","sub":[{"name":"呼和浩特市","sub":[{"name":"新城区"},{"name":"回民区"},{"name":"玉泉区"},{"name":"赛罕区"},{"name":"土默特左旗"},{"name":"托克托县"},{"name":"和林格尔县"},{"name":"清水河县"},{"name":"武川县"}]},{"name":"包头市","sub":[{"name":"东河区"},{"name":"昆都仑区"},{"name":"青山区"},{"name":"石拐区"},{"name":"白云鄂博矿区"},{"name":"九原区"},{"name":"土默特右旗"},{"name":"固阳县"},{"name":"稀土高新区"},{"name":"达茂旗"}]},{"name":"乌海市","sub":[{"name":"海勃湾区"},{"name":"海南区"},{"name":"乌达区"}]},{"name":"赤峰市","sub":[{"name":"红山区"},{"name":"元宝山区"},{"name":"松山区"},{"name":"阿鲁科尔沁旗"},{"name":"巴林左旗"},{"name":"巴林右旗"},{"name":"林西县"},{"name":"克什克腾旗"},{"name":"翁牛特旗"},{"name":"喀喇沁旗"},{"name":"宁城县"},{"name":"敖汉旗"}]},{"name":"通辽市","sub":[{"name":"科尔沁区"},{"name":"科尔沁左翼中旗"},{"name":"科尔沁左翼后旗"},{"name":"开鲁县"},{"name":"库伦旗"},{"name":"奈曼旗"},{"name":"扎鲁特旗"},{"name":"通辽经济开发区"},{"name":"霍林郭勒市"}]},{"name":"鄂尔多斯市","sub":[{"name":"东胜区"},{"name":"达拉特旗"},{"name":"准格尔旗"},{"name":"鄂托克前旗"},{"name":"鄂托克旗"},{"name":"杭锦旗"},{"name":"乌审旗"},{"name":"康巴什区"},{"name":"成吉思汗陵旅游区"},{"name":"恩格贝生态示范区"},{"name":"鄂尔多斯高新技术产业园区"},{"name":"准格尔经济开发区"},{"name":"大路煤化工基地"},{"name":"江苏工业园区"},{"name":"圣圆煤化工基地"},{"name":"苏里格经济开发区"},{"name":"独贵塔拉工业园区"},{"name":"新能源产业示范区"},{"name":"上海庙经济开发区"},{"name":"伊金霍洛旗"}]},{"name":"呼伦贝尔市","sub":[{"name":"海拉尔区"},{"name":"扎赉诺尔区"},{"name":"阿荣旗"},{"name":"莫力达瓦达斡尔族自治旗"},{"name":"鄂伦春自治旗"},{"name":"鄂温克族自治旗"},{"name":"陈巴尔虎旗"},{"name":"新巴尔虎左旗"},{"name":"满洲里市"},{"name":"牙克石市"},{"name":"扎兰屯市"},{"name":"额尔古纳市"},{"name":"根河市"}]},{"name":"巴彦淖尔市","sub":[{"name":"临河区"},{"name":"五原县"},{"name":"磴口县"},{"name":"乌拉特前旗"},{"name":"乌拉特中旗"},{"name":"乌拉特后旗"},{"name":"杭锦后旗"}]},{"name":"乌兰察布市","sub":[{"name":"集宁区"},{"name":"卓资县"},{"name":"化德县"},{"name":"商都县"},{"name":"兴和县"},{"name":"凉城县"},{"name":"察哈尔右翼前旗"},{"name":"察哈尔右翼中旗"},{"name":"察哈尔右翼后旗"},{"name":"四子王旗"},{"name":"丰镇市"}]},{"name":"兴安盟","sub":[{"name":"乌兰浩特市"},{"name":"阿尔山市"},{"name":"科尔沁右翼前旗"},{"name":"科尔沁右翼中旗"},{"name":"扎赉特旗"},{"name":"突泉县"}]},{"name":"锡林郭勒盟","sub":[{"name":"二连浩特市"},{"name":"锡林浩特市"},{"name":"阿巴嘎旗"},{"name":"苏尼特左旗"},{"name":"苏尼特右旗"},{"name":"东乌珠穆沁旗"},{"name":"西乌珠穆沁旗"},{"name":"太仆寺旗"},{"name":"镶黄旗"},{"name":"正镶白旗"},{"name":"正蓝旗"},{"name":"乌拉盖管理区"},{"name":"锡林郭勒经济开发区"},{"name":"多伦县"}]},{"name":"阿拉善盟","sub":[{"name":"阿拉善左旗"},{"name":"阿拉善右旗"},{"name":"阿拉善经济开发区"},{"name":"腾格里经济技术开发区"},{"name":"乌兰布和生态沙产业示范区"},{"name":"策克口岸经济开发区"},{"name":"额济纳旗"}]}]},{"name":"辽宁省","sub":[{"name":"沈阳市","sub":[{"name":"和平区"},{"name":"沈河区"},{"name":"大东区"},{"name":"皇姑区"},{"name":"铁西区"},{"name":"苏家屯区"},{"name":"沈北新区"},{"name":"于洪区"},{"name":"辽中县"},{"name":"康平县"},{"name":"法库县"},{"name":"浑南区"},{"name":"新民市"}]},{"name":"大连市","sub":[{"name":"中山区"},{"name":"西岗区"},{"name":"沙河口区"},{"name":"甘井子区"},{"name":"旅顺口区"},{"name":"金州区"},{"name":"长海县"},{"name":"瓦房店市"},{"name":"普兰店市"},{"name":"庄河市"}]},{"name":"鞍山市","sub":[{"name":"铁东区"},{"name":"铁西区"},{"name":"立山区"},{"name":"千山区"},{"name":"台安县"},{"name":"岫岩满族自治县"},{"name":"海城市"}]},{"name":"抚顺市","sub":[{"name":"新抚区"},{"name":"东洲区"},{"name":"望花区"},{"name":"顺城区"},{"name":"抚顺县"},{"name":"新宾满族自治县"},{"name":"清原满族自治县"}]},{"name":"本溪市","sub":[{"name":"平山区"},{"name":"溪湖区"},{"name":"明山区"},{"name":"南芬区"},{"name":"本溪满族自治县"},{"name":"桓仁满族自治县"}]},{"name":"丹东市","sub":[{"name":"元宝区"},{"name":"振兴区"},{"name":"振安区"},{"name":"宽甸满族自治县"},{"name":"东港市"},{"name":"凤城市"}]},{"name":"锦州市","sub":[{"name":"古塔区"},{"name":"凌河区"},{"name":"太和区"},{"name":"黑山县"},{"name":"义县"},{"name":"凌海市"},{"name":"北镇市"}]},{"name":"营口市","sub":[{"name":"站前区"},{"name":"西市区"},{"name":"鲅鱼圈区"},{"name":"老边区"},{"name":"盖州市"},{"name":"大石桥市"}]},{"name":"阜新市","sub":[{"name":"海州区"},{"name":"新邱区"},{"name":"太平区"},{"name":"清河门区"},{"name":"细河区"},{"name":"阜新蒙古族自治县"},{"name":"彰武县"}]},{"name":"辽阳市","sub":[{"name":"白塔区"},{"name":"文圣区"},{"name":"宏伟区"},{"name":"弓长岭区"},{"name":"太子河区"},{"name":"辽阳县"},{"name":"灯塔市"}]},{"name":"盘锦市","sub":[{"name":"双台子区"},{"name":"兴隆台区"},{"name":"大洼县"},{"name":"盘山县"}]},{"name":"铁岭市","sub":[{"name":"银州区"},{"name":"清河区"},{"name":"铁岭县"},{"name":"西丰县"},{"name":"昌图县"},{"name":"调兵山市"},{"name":"开原市"}]},{"name":"朝阳市","sub":[{"name":"双塔区"},{"name":"龙城区"},{"name":"朝阳县"},{"name":"建平县"},{"name":"喀喇沁左翼蒙古族自治县"},{"name":"北票市"},{"name":"凌源市"}]},{"name":"葫芦岛市","sub":[{"name":"连山区"},{"name":"龙港区"},{"name":"南票区"},{"name":"绥中县"},{"name":"建昌县"},{"name":"兴城市"}]}]},{"name":"吉林省","sub":[{"name":"长春市","sub":[{"name":"南关区"},{"name":"宽城区"},{"name":"朝阳区"},{"name":"二道区"},{"name":"绿园区"},{"name":"双阳区"},{"name":"农安县"},{"name":"九台区"},{"name":"榆树市"},{"name":"长春新区"},{"name":"德惠市"}]},{"name":"吉林市","sub":[{"name":"昌邑区"},{"name":"龙潭区"},{"name":"船营区"},{"name":"丰满区"},{"name":"永吉县"},{"name":"蛟河市"},{"name":"桦甸市"},{"name":"舒兰市"},{"name":"磐石市"}]},{"name":"四平市","sub":[{"name":"铁西区"},{"name":"铁东区"},{"name":"梨树县"},{"name":"伊通满族自治县"},{"name":"公主岭市"},{"name":"双辽市"}]},{"name":"辽源市","sub":[{"name":"龙山区"},{"name":"西安区"},{"name":"东丰县"},{"name":"东辽县"}]},{"name":"通化市","sub":[{"name":"东昌区"},{"name":"二道江区"},{"name":"通化县"},{"name":"辉南县"},{"name":"柳河县"},{"name":"梅河口市"},{"name":"集安市"}]},{"name":"白山市","sub":[{"name":"浑江区"},{"name":"江源区"},{"name":"抚松县"},{"name":"靖宇县"},{"name":"长白朝鲜族自治县"},{"name":"临江市"}]},{"name":"松原市","sub":[{"name":"宁江区"},{"name":"前郭尔罗斯蒙古族自治县"},{"name":"长岭县"},{"name":"乾安县"},{"name":"扶余市"}]},{"name":"白城市","sub":[{"name":"洮北区"},{"name":"镇赉县"},{"name":"通榆县"},{"name":"洮南市"},{"name":"大安市"}]},{"name":"延边朝鲜族自治州","sub":[{"name":"延吉市"},{"name":"图们市"},{"name":"敦化市"},{"name":"珲春市"},{"name":"龙井市"},{"name":"和龙市"},{"name":"汪清县"},{"name":"安图县"}]},{"name":"长白山保护开发区管委会","sub":[{"name":"长白山保护开发区管委会"}]}]},{"name":"黑龙江省","sub":[{"name":"哈尔滨市","sub":[{"name":"道里区"},{"name":"南岗区"},{"name":"道外区"},{"name":"平房区"},{"name":"松北区"},{"name":"香坊区"},{"name":"呼兰区"},{"name":"阿城区"},{"name":"双城区"},{"name":"依兰县"},{"name":"方正县"},{"name":"宾县"},{"name":"巴彦县"},{"name":"木兰县"},{"name":"通河县"},{"name":"延寿县"},{"name":"尚志市"},{"name":"五常市"}]},{"name":"齐齐哈尔市","sub":[{"name":"龙沙区"},{"name":"建华区"},{"name":"铁锋区"},{"name":"昂昂溪区"},{"name":"富拉尔基区"},{"name":"碾子山区"},{"name":"梅里斯达斡尔族区"},{"name":"龙江县"},{"name":"依安县"},{"name":"泰来县"},{"name":"甘南县"},{"name":"富裕县"},{"name":"克山县"},{"name":"克东县"},{"name":"拜泉县"},{"name":"讷河市"}]},{"name":"鸡西市","sub":[{"name":"鸡冠区"},{"name":"恒山区"},{"name":"滴道区"},{"name":"梨树区"},{"name":"城子河区"},{"name":"麻山区"},{"name":"鸡东县"},{"name":"虎林市"},{"name":"密山市"}]},{"name":"鹤岗市","sub":[{"name":"向阳区"},{"name":"工农区"},{"name":"南山区"},{"name":"兴安区"},{"name":"东山区"},{"name":"兴山区"},{"name":"萝北县"},{"name":"绥滨县"}]},{"name":"双鸭山市","sub":[{"name":"尖山区"},{"name":"岭东区"},{"name":"四方台区"},{"name":"宝山区"},{"name":"集贤县"},{"name":"友谊县"},{"name":"宝清县"},{"name":"饶河县"}]},{"name":"大庆市","sub":[{"name":"萨尔图区"},{"name":"龙凤区"},{"name":"让胡路区"},{"name":"红岗区"},{"name":"大同区"},{"name":"肇州县"},{"name":"肇源县"},{"name":"林甸县"},{"name":"杜尔伯特蒙古族自治县"}]},{"name":"伊春市","sub":[{"name":"伊春区"},{"name":"南岔区"},{"name":"友好区"},{"name":"西林区"},{"name":"翠峦区"},{"name":"新青区"},{"name":"美溪区"},{"name":"金山屯区"},{"name":"五营区"},{"name":"乌马河区"},{"name":"汤旺河区"},{"name":"带岭区"},{"name":"乌伊岭区"},{"name":"红星区"},{"name":"上甘岭区"},{"name":"嘉荫县"},{"name":"铁力市"}]},{"name":"佳木斯市","sub":[{"name":"向阳区"},{"name":"前进区"},{"name":"东风区"},{"name":"郊区"},{"name":"桦南县"},{"name":"桦川县"},{"name":"汤原县"},{"name":"抚远县"},{"name":"同江市"},{"name":"富锦市"}]},{"name":"七台河市","sub":[{"name":"新兴区"},{"name":"桃山区"},{"name":"茄子河区"},{"name":"勃利县"}]},{"name":"牡丹江市","sub":[{"name":"东安区"},{"name":"阳明区"},{"name":"爱民区"},{"name":"西安区"},{"name":"东宁市"},{"name":"林口县"},{"name":"绥芬河市"},{"name":"海林市"},{"name":"宁安市"},{"name":"穆棱市"}]},{"name":"黑河市","sub":[{"name":"爱辉区"},{"name":"嫩江县"},{"name":"逊克县"},{"name":"孙吴县"},{"name":"北安市"},{"name":"五大连池市"}]},{"name":"绥化市","sub":[{"name":"北林区"},{"name":"望奎县"},{"name":"兰西县"},{"name":"青冈县"},{"name":"庆安县"},{"name":"明水县"},{"name":"绥棱县"},{"name":"安达市"},{"name":"肇东市"},{"name":"海伦市"}]},{"name":"大兴安岭地区","sub":[{"name":"加格达奇区"},{"name":"松岭区"},{"name":"新林区"},{"name":"呼中区"},{"name":"呼玛县"},{"name":"塔河县"},{"name":"漠河县"}]}]},{"name":"上海市","sub":[{"name":"上海市","sub":[{"name":"黄浦区"},{"name":"徐汇区"},{"name":"长宁区"},{"name":"静安区"},{"name":"普陀区"},{"name":"虹口区"},{"name":"杨浦区"},{"name":"闵行区"},{"name":"宝山区"},{"name":"嘉定区"},{"name":"浦东新区"},{"name":"金山区"},{"name":"松江区"},{"name":"青浦区"},{"name":"奉贤区"},{"name":"崇明区"}]}]},{"name":"江苏省","sub":[{"name":"南京市","sub":[{"name":"玄武区"},{"name":"秦淮区"},{"name":"建邺区"},{"name":"鼓楼区"},{"name":"浦口区"},{"name":"栖霞区"},{"name":"雨花台区"},{"name":"江宁区"},{"name":"六合区"},{"name":"溧水区"},{"name":"高淳区"}]},{"name":"无锡市","sub":[{"name":"江阴市"},{"name":"宜兴市"},{"name":"梁溪区"},{"name":"锡山区"},{"name":"惠山区"},{"name":"滨湖区"},{"name":"新吴区"}]},{"name":"徐州市","sub":[{"name":"鼓楼区"},{"name":"云龙区"},{"name":"市经济技术开发区"},{"name":"贾汪区"},{"name":"徐州新城区"},{"name":"泉山区"},{"name":"丰县"},{"name":"沛县"},{"name":"铜山区"},{"name":"睢宁县"},{"name":"新沂市"},{"name":"邳州市"}]},{"name":"常州市","sub":[{"name":"天宁区"},{"name":"钟楼区"},{"name":"新北区"},{"name":"武进区"},{"name":"溧阳市"},{"name":"金坛区"}]},{"name":"苏州市","sub":[{"name":"苏州工业园区"},{"name":"苏州高新区"},{"name":"虎丘区"},{"name":"吴中区"},{"name":"相城区"},{"name":"常熟市"},{"name":"张家港市"},{"name":"昆山市"},{"name":"吴江区"},{"name":"姑苏区"},{"name":"太仓市"}]},{"name":"南通市","sub":[{"name":"崇川区"},{"name":"港闸区"},{"name":"海安县"},{"name":"如东县"},{"name":"启东市"},{"name":"如皋市"},{"name":"通州区"},{"name":"海门市"}]},{"name":"连云港市","sub":[{"name":"连云区"},{"name":"连云港经济技术开发区"},{"name":"海州区"},{"name":"赣榆区"},{"name":"国家东中西区域合作示范区"},{"name":"云台山风景名胜区"},{"name":"东海县"},{"name":"灌云县"},{"name":"灌南县"}]},{"name":"淮安市","sub":[{"name":"清江浦区"},{"name":"淮安区"},{"name":"淮阴区"},{"name":"淮安经济技术开发区"},{"name":"淮安工业园区"},{"name":"淮安生态新城"},{"name":"淮安盐化新材料产业园"},{"name":"涟水县"},{"name":"洪泽区"},{"name":"盱眙县"},{"name":"金湖县"}]},{"name":"盐城市","sub":[{"name":"亭湖区"},{"name":"盐都区"},{"name":"响水县"},{"name":"滨海县"},{"name":"阜宁县"},{"name":"射阳县"},{"name":"建湖县"},{"name":"东台市"},{"name":"大丰区"}]},{"name":"扬州市","sub":[{"name":"广陵区"},{"name":"邗江区"},{"name":"宝应县"},{"name":"仪征市"},{"name":"高邮市"},{"name":"江都区"}]},{"name":"镇江市","sub":[{"name":"京口区"},{"name":"润州区"},{"name":"丹徒区"},{"name":"镇江新区"},{"name":"丹阳市"},{"name":"扬中市"},{"name":"句容市"}]},{"name":"泰州市","sub":[{"name":"海陵区"},{"name":"高港区"},{"name":"医药高新区"},{"name":"兴化市"},{"name":"靖江市"},{"name":"泰兴市"},{"name":"姜堰区"}]},{"name":"宿迁市","sub":[{"name":"宿城区"},{"name":"宿豫区"},{"name":"沭阳县"},{"name":"泗阳县"},{"name":"泗洪县"}]}]},{"name":"浙江省","sub":[{"name":"杭州市","sub":[{"name":"上城区"},{"name":"下城区"},{"name":"江干区"},{"name":"拱墅区"},{"name":"西湖区"},{"name":"萧山区"},{"name":"余杭区"},{"name":"桐庐县"},{"name":"淳安县"},{"name":"建德市"},{"name":"富阳区"},{"name":"临安市"},{"name":"高新开发区（滨江）"}]},{"name":"宁波市","sub":[{"name":"海曙区"},{"name":"江东区"},{"name":"江北区"},{"name":"北仑区"},{"name":"镇海区"},{"name":"鄞州区"},{"name":"象山县"},{"name":"宁海县"},{"name":"余姚市"},{"name":"慈溪市"},{"name":"奉化市"}]},{"name":"温州市","sub":[{"name":"鹿城区"},{"name":"龙湾区"},{"name":"瓯海区"},{"name":"洞头区"},{"name":"乐清市"},{"name":"瑞安市"},{"name":"永嘉县"},{"name":"平阳县"},{"name":"苍南县"},{"name":"文成县"},{"name":"泰顺县"}]},{"name":"嘉兴市","sub":[{"name":"南湖区"},{"name":"秀洲区"},{"name":"嘉善县"},{"name":"海盐县"},{"name":"海宁市"},{"name":"平湖市"},{"name":"桐乡市"}]},{"name":"湖州市","sub":[{"name":"吴兴区"},{"name":"南浔区"},{"name":"德清县"},{"name":"长兴县"},{"name":"安吉县"}]},{"name":"绍兴市","sub":[{"name":"越城区"},{"name":"柯桥区"},{"name":"新昌县"},{"name":"诸暨市"},{"name":"上虞区"},{"name":"嵊州市"}]},{"name":"金华市","sub":[{"name":"婺城区"},{"name":"金东区"},{"name":"武义县"},{"name":"浦江县"},{"name":"磐安县"},{"name":"兰溪市"},{"name":"义乌市"},{"name":"东阳市"},{"name":"永康市"}]},{"name":"衢州市","sub":[{"name":"柯城区"},{"name":"衢江区"},{"name":"常山县"},{"name":"开化县"},{"name":"龙游县"},{"name":"江山市"}]},{"name":"舟山市","sub":[{"name":"定海区"},{"name":"普陀区"},{"name":"岱山县"},{"name":"嵊泗县"}]},{"name":"台州市","sub":[{"name":"椒江区"},{"name":"黄岩区"},{"name":"路桥区"},{"name":"玉环县"},{"name":"三门县"},{"name":"天台县"},{"name":"仙居县"},{"name":"温岭市"},{"name":"临海市"}]},{"name":"丽水市","sub":[{"name":"莲都区"},{"name":"青田县"},{"name":"缙云县"},{"name":"遂昌县"},{"name":"松阳县"},{"name":"云和县"},{"name":"庆元县"},{"name":"景宁县"},{"name":"龙泉市"}]}]},{"name":"安徽省","sub":[{"name":"合肥市","sub":[{"name":"瑶海区"},{"name":"庐江县"},{"name":"巢湖市"},{"name":"蜀山区"},{"name":"包河区"},{"name":"长丰县"},{"name":"肥东县"},{"name":"肥西县"},{"name":"庐阳区"}]},{"name":"芜湖市","sub":[{"name":"镜湖区"},{"name":"弋江区"},{"name":"鸠江区"},{"name":"三山区"},{"name":"芜湖县"},{"name":"繁昌县"},{"name":"无为县"},{"name":"南陵县"}]},{"name":"蚌埠市","sub":[{"name":"龙子湖区"},{"name":"蚌山区"},{"name":"禹会区"},{"name":"淮上区"},{"name":"怀远县"},{"name":"五河县"},{"name":"固镇县"}]},{"name":"淮南市","sub":[{"name":"大通区"},{"name":"寿县"},{"name":"毛集实验区"},{"name":"田家庵区"},{"name":"谢家集区"},{"name":"八公山区"},{"name":"潘集区"},{"name":"凤台县"}]},{"name":"马鞍山市","sub":[{"name":"博望区"},{"name":"含山县"},{"name":"和县"},{"name":"花山区"},{"name":"雨山区"},{"name":"当涂县"}]},{"name":"淮北市","sub":[{"name":"杜集区"},{"name":"相山区"},{"name":"烈山区"},{"name":"濉溪县"}]},{"name":"铜陵市","sub":[{"name":"铜官区"},{"name":"义安区"},{"name":"郊区"},{"name":"枞阳县"}]},{"name":"安庆市","sub":[{"name":"迎江区"},{"name":"大观区"},{"name":"宜秀区"},{"name":"怀宁县"},{"name":"潜山县"},{"name":"太湖县"},{"name":"宿松县"},{"name":"望江县"},{"name":"岳西县"},{"name":"桐城市"}]},{"name":"黄山市","sub":[{"name":"屯溪区"},{"name":"黄山区"},{"name":"徽州区"},{"name":"歙县"},{"name":"休宁县"},{"name":"黟县"},{"name":"祁门县"},{"name":"黄山风景区"}]},{"name":"滁州市","sub":[{"name":"琅琊区"},{"name":"南谯区"},{"name":"来安县"},{"name":"全椒县"},{"name":"定远县"},{"name":"凤阳县"},{"name":"天长市"},{"name":"明光市"}]},{"name":"阜阳市","sub":[{"name":"颍州区"},{"name":"颍东区"},{"name":"颍泉区"},{"name":"临泉县"},{"name":"太和县"},{"name":"阜南县"},{"name":"颍上县"},{"name":"界首市"}]},{"name":"宿州市","sub":[{"name":"埇桥区"},{"name":"砀山县"},{"name":"萧县"},{"name":"灵璧县"},{"name":"泗县"}]},{"name":"六安市","sub":[{"name":"金安区"},{"name":"裕安区"},{"name":"叶集区"},{"name":"霍邱县"},{"name":"舒城县"},{"name":"金寨县"},{"name":"霍山县"}]},{"name":"亳州市","sub":[{"name":"谯城区"},{"name":"涡阳县"},{"name":"蒙城县"},{"name":"利辛县"}]},{"name":"池州市","sub":[{"name":"贵池区"},{"name":"东至县"},{"name":"石台县"},{"name":"青阳县"},{"name":"九华山风景区"}]},{"name":"宣城市","sub":[{"name":"宣州区"},{"name":"郎溪县"},{"name":"广德县"},{"name":"泾县"},{"name":"绩溪县"},{"name":"旌德县"},{"name":"宁国市"}]}]},{"name":"福建省","sub":[{"name":"福州市","sub":[{"name":"鼓楼区"},{"name":"台江区"},{"name":"仓山区"},{"name":"马尾区"},{"name":"晋安区"},{"name":"闽侯县"},{"name":"连江县"},{"name":"罗源县"},{"name":"闽清县"},{"name":"永泰县"},{"name":"平潭县"},{"name":"福清市"},{"name":"长乐市"}]},{"name":"厦门市","sub":[{"name":"思明区"},{"name":"海沧区"},{"name":"湖里区"},{"name":"集美区"},{"name":"同安区"},{"name":"厦门高新技术产业开发区"},{"name":"厦门象屿保税区"},{"name":"鼓浪屿-万石山风景名胜区"},{"name":"翔安区"}]},{"name":"莆田市","sub":[{"name":"城厢区"},{"name":"涵江区"},{"name":"荔城区"},{"name":"秀屿区"},{"name":"仙游县"}]},{"name":"三明市","sub":[{"name":"梅列区"},{"name":"三元区"},{"name":"明溪县"},{"name":"清流县"},{"name":"宁化县"},{"name":"大田县"},{"name":"尤溪县"},{"name":"沙县"},{"name":"将乐县"},{"name":"泰宁县"},{"name":"建宁县"},{"name":"永安市"}]},{"name":"泉州市","sub":[{"name":"鲤城区"},{"name":"丰泽区"},{"name":"洛江区"},{"name":"泉港区"},{"name":"惠安县"},{"name":"安溪县"},{"name":"永春县"},{"name":"德化县"},{"name":"金门县"},{"name":"泉州台商投资区"},{"name":"泉州经济技术开发区"},{"name":"石狮市"},{"name":"晋江市"},{"name":"南安市"}]},{"name":"漳州市","sub":[{"name":"芗城区"},{"name":"龙文区"},{"name":"云霄县"},{"name":"漳浦县"},{"name":"诏安县"},{"name":"长泰县"},{"name":"东山县"},{"name":"南靖县"},{"name":"平和县"},{"name":"华安县"},{"name":"龙海市"}]},{"name":"南平市","sub":[{"name":"延平区"},{"name":"顺昌县"},{"name":"浦城县"},{"name":"光泽县"},{"name":"松溪县"},{"name":"政和县"},{"name":"邵武市"},{"name":"武夷山市"},{"name":"建瓯市"},{"name":"建阳区"}]},{"name":"龙岩市","sub":[{"name":"新罗区"},{"name":"长汀县"},{"name":"永定区"},{"name":"上杭县"},{"name":"武平县"},{"name":"连城县"},{"name":"漳平市"}]},{"name":"宁德市","sub":[{"name":"蕉城区"},{"name":"霞浦县"},{"name":"古田县"},{"name":"屏南县"},{"name":"寿宁县"},{"name":"周宁县"},{"name":"柘荣县"},{"name":"福安市"},{"name":"福鼎市"}]}]},{"name":"江西省","sub":[{"name":"南昌市","sub":[{"name":"东湖区"},{"name":"西湖区"},{"name":"青云谱区"},{"name":"湾里区"},{"name":"青山湖区"},{"name":"红谷滩新区"},{"name":"高新开发区"},{"name":"桑海开发区"},{"name":"南昌县"},{"name":"新建区"},{"name":"安义县"},{"name":"进贤县"}]},{"name":"景德镇市","sub":[{"name":"昌江区"},{"name":"珠山区"},{"name":"浮梁县"},{"name":"乐平市"}]},{"name":"萍乡市","sub":[{"name":"安源区"},{"name":"湘东区"},{"name":"莲花县"},{"name":"上栗县"},{"name":"芦溪县"},{"name":"萍乡经济技术开发区"}]},{"name":"九江市","sub":[{"name":"庐山市"},{"name":"浔阳区"},{"name":"濂溪区"},{"name":"武宁县"},{"name":"修水县"},{"name":"永修县"},{"name":"德安县"},{"name":"都昌县"},{"name":"湖口县"},{"name":"彭泽县"},{"name":"九江开发区"},{"name":"共青城市"},{"name":"柴桑区"},{"name":"庐山西海风景区"},{"name":"瑞昌市"}]},{"name":"新余市","sub":[{"name":"渝水区"},{"name":"经济开发区"},{"name":"仙女湖风景区"},{"name":"分宜县"}]},{"name":"鹰潭市","sub":[{"name":"月湖区"},{"name":"余江县"},{"name":"贵溪市"}]},{"name":"赣州市","sub":[{"name":"章贡区"},{"name":"赣县"},{"name":"信丰县"},{"name":"大余县"},{"name":"上犹县"},{"name":"崇义县"},{"name":"安远县"},{"name":"龙南县"},{"name":"定南县"},{"name":"全南县"},{"name":"宁都县"},{"name":"于都县"},{"name":"兴国县"},{"name":"会昌县"},{"name":"寻乌县"},{"name":"石城县"},{"name":"瑞金市"},{"name":"南康区"}]},{"name":"吉安市","sub":[{"name":"吉州区"},{"name":"青原区"},{"name":"吉安县"},{"name":"吉水县"},{"name":"峡江县"},{"name":"新干县"},{"name":"永丰县"},{"name":"泰和县"},{"name":"遂川县"},{"name":"万安县"},{"name":"安福县"},{"name":"永新县"},{"name":"井冈山市"}]},{"name":"宜春市","sub":[{"name":"袁州区"},{"name":"奉新县"},{"name":"万载县"},{"name":"上高县"},{"name":"宜丰县"},{"name":"靖安县"},{"name":"铜鼓县"},{"name":"丰城市"},{"name":"樟树市"},{"name":"高安市"}]},{"name":"抚州市","sub":[{"name":"临川区"},{"name":"南城县"},{"name":"黎川县"},{"name":"南丰县"},{"name":"崇仁县"},{"name":"乐安县"},{"name":"宜黄县"},{"name":"金溪县"},{"name":"资溪县"},{"name":"东乡县"},{"name":"广昌县"}]},{"name":"上饶市","sub":[{"name":"信州区"},{"name":"上饶县"},{"name":"广丰县"},{"name":"玉山县"},{"name":"铅山县"},{"name":"横峰县"},{"name":"弋阳县"},{"name":"余干县"},{"name":"鄱阳县"},{"name":"万年县"},{"name":"婺源县"},{"name":"德兴市"}]}]},{"name":"山东省","sub":[{"name":"济南市","sub":[{"name":"历下区"},{"name":"市中区"},{"name":"槐荫区"},{"name":"天桥区"},{"name":"历城区"},{"name":"长清区"},{"name":"平阴县"},{"name":"济阳县"},{"name":"商河县"},{"name":"章丘市"}]},{"name":"青岛市","sub":[{"name":"市南区"},{"name":"市北区"},{"name":"崂山区"},{"name":"李沧区"},{"name":"城阳区"},{"name":"胶州市"},{"name":"即墨市"},{"name":"平度市"},{"name":"黄岛区"},{"name":"莱西市"}]},{"name":"淄博市","sub":[{"name":"淄川区"},{"name":"张店区"},{"name":"博山区"},{"name":"临淄区"},{"name":"周村区"},{"name":"桓台县"},{"name":"高青县"},{"name":"沂源县"}]},{"name":"枣庄市","sub":[{"name":"市中区"},{"name":"薛城区"},{"name":"峄城区"},{"name":"台儿庄区"},{"name":"山亭区"},{"name":"滕州市"}]},{"name":"东营市","sub":[{"name":"东营区"},{"name":"河口区"},{"name":"垦利县"},{"name":"利津县"},{"name":"广饶县"}]},{"name":"烟台市","sub":[{"name":"芝罘区"},{"name":"福山区"},{"name":"牟平区"},{"name":"莱山区"},{"name":"长岛县"},{"name":"龙口市"},{"name":"莱阳市"},{"name":"莱州市"},{"name":"蓬莱市"},{"name":"招远市"},{"name":"栖霞市"},{"name":"海阳市"}]},{"name":"潍坊市","sub":[{"name":"潍城区"},{"name":"寒亭区"},{"name":"坊子区"},{"name":"奎文区"},{"name":"临朐县"},{"name":"昌乐县"},{"name":"青州市"},{"name":"诸城市"},{"name":"寿光市"},{"name":"安丘市"},{"name":"高密市"},{"name":"昌邑市"}]},{"name":"济宁市","sub":[{"name":"任城区"},{"name":"微山县"},{"name":"鱼台县"},{"name":"金乡县"},{"name":"嘉祥县"},{"name":"汶上县"},{"name":"泗水县"},{"name":"梁山县"},{"name":"曲阜市"},{"name":"兖州区"},{"name":"邹城市"}]},{"name":"泰安市","sub":[{"name":"泰山区"},{"name":"岱岳区"},{"name":"宁阳县"},{"name":"东平县"},{"name":"新泰市"},{"name":"肥城市"}]},{"name":"威海市","sub":[{"name":"环翠区"},{"name":"文登市"},{"name":"荣成市"},{"name":"乳山市"}]},{"name":"日照市","sub":[{"name":"东港区"},{"name":"岚山区"},{"name":"五莲县"},{"name":"莒县"}]},{"name":"莱芜市","sub":[{"name":"莱城区"},{"name":"钢城区"}]},{"name":"临沂市","sub":[{"name":"兰山区"},{"name":"罗庄区"},{"name":"河东区"},{"name":"沂南县"},{"name":"郯城县"},{"name":"沂水县"},{"name":"兰陵县"},{"name":"费县"},{"name":"平邑县"},{"name":"莒南县"},{"name":"蒙阴县"},{"name":"临沭县"}]},{"name":"德州市","sub":[{"name":"德城区"},{"name":"陵城区"},{"name":"宁津县"},{"name":"庆云县"},{"name":"临邑县"},{"name":"齐河县"},{"name":"平原县"},{"name":"夏津县"},{"name":"武城县"},{"name":"乐陵市"},{"name":"禹城市"}]},{"name":"聊城市","sub":[{"name":"东昌府区"},{"name":"阳谷县"},{"name":"莘县"},{"name":"茌平县"},{"name":"东阿县"},{"name":"冠县"},{"name":"高唐县"},{"name":"临清市"}]},{"name":"滨州市","sub":[{"name":"滨城区"},{"name":"惠民县"},{"name":"阳信县"},{"name":"无棣县"},{"name":"沾化区"},{"name":"博兴县"},{"name":"邹平县"}]},{"name":"菏泽市","sub":[{"name":"牡丹区"},{"name":"曹县"},{"name":"单县"},{"name":"成武县"},{"name":"巨野县"},{"name":"郓城县"},{"name":"鄄城县"},{"name":"定陶区"},{"name":"东明县"}]}]},{"name":"河南省","sub":[{"name":"郑州市","sub":[{"name":"中原区"},{"name":"二七区"},{"name":"管城回族区"},{"name":"金水区"},{"name":"上街区"},{"name":"惠济区"},{"name":"中牟县"},{"name":"巩义市"},{"name":"荥阳市"},{"name":"新密市"},{"name":"新郑市"},{"name":"登封市"}]},{"name":"开封市","sub":[{"name":"龙亭区"},{"name":"顺河回族区"},{"name":"鼓楼区"},{"name":"禹王台区"},{"name":"金明区"},{"name":"祥符区"},{"name":"杞县"},{"name":"通许县"},{"name":"尉氏县"},{"name":"兰考县"}]},{"name":"洛阳市","sub":[{"name":"老城区"},{"name":"西工区"},{"name":"瀍河回族区"},{"name":"涧西区"},{"name":"吉利区"},{"name":"洛龙区"},{"name":"孟津县"},{"name":"新安县"},{"name":"栾川县"},{"name":"嵩县"},{"name":"汝阳县"},{"name":"宜阳县"},{"name":"洛宁县"},{"name":"伊川县"},{"name":"偃师市"}]},{"name":"平顶山市","sub":[{"name":"新华区"},{"name":"卫东区"},{"name":"石龙区"},{"name":"湛河区"},{"name":"宝丰县"},{"name":"叶县"},{"name":"鲁山县"},{"name":"郏县"},{"name":"舞钢市"},{"name":"汝州市"}]},{"name":"安阳市","sub":[{"name":"文峰区"},{"name":"北关区"},{"name":"殷都区"},{"name":"龙安区"},{"name":"安阳县"},{"name":"汤阴县"},{"name":"滑县"},{"name":"内黄县"},{"name":"林州市"}]},{"name":"鹤壁市","sub":[{"name":"鹤山区"},{"name":"山城区"},{"name":"淇滨区"},{"name":"浚县"},{"name":"淇县"}]},{"name":"新乡市","sub":[{"name":"红旗区"},{"name":"卫滨区"},{"name":"凤泉区"},{"name":"牧野区"},{"name":"新乡县"},{"name":"获嘉县"},{"name":"原阳县"},{"name":"延津县"},{"name":"封丘县"},{"name":"长垣县"},{"name":"卫辉市"},{"name":"辉县市"}]},{"name":"焦作市","sub":[{"name":"解放区"},{"name":"中站区"},{"name":"马村区"},{"name":"山阳区"},{"name":"修武县"},{"name":"博爱县"},{"name":"武陟县"},{"name":"温县"},{"name":"沁阳市"},{"name":"孟州市"}]},{"name":"濮阳市","sub":[{"name":"华龙区"},{"name":"清丰县"},{"name":"南乐县"},{"name":"范县"},{"name":"台前县"},{"name":"濮阳县"}]},{"name":"许昌市","sub":[{"name":"魏都区"},{"name":"许昌县"},{"name":"鄢陵县"},{"name":"襄城县"},{"name":"禹州市"},{"name":"长葛市"}]},{"name":"漯河市","sub":[{"name":"源汇区"},{"name":"郾城区"},{"name":"召陵区"},{"name":"舞阳县"},{"name":"临颍县"}]},{"name":"三门峡市","sub":[{"name":"湖滨区"},{"name":"渑池县"},{"name":"陕州区"},{"name":"卢氏县"},{"name":"义马市"},{"name":"灵宝市"}]},{"name":"南阳市","sub":[{"name":"宛城区"},{"name":"卧龙区"},{"name":"南召县"},{"name":"方城县"},{"name":"西峡县"},{"name":"镇平县"},{"name":"内乡县"},{"name":"淅川县"},{"name":"社旗县"},{"name":"唐河县"},{"name":"新野县"},{"name":"桐柏县"},{"name":"邓州市"}]},{"name":"商丘市","sub":[{"name":"梁园区"},{"name":"睢阳区"},{"name":"民权县"},{"name":"睢县"},{"name":"宁陵县"},{"name":"柘城县"},{"name":"虞城县"},{"name":"夏邑县"},{"name":"永城市"}]},{"name":"信阳市","sub":[{"name":"浉河区"},{"name":"平桥区"},{"name":"罗山县"},{"name":"光山县"},{"name":"新县"},{"name":"商城县"},{"name":"固始县"},{"name":"潢川县"},{"name":"淮滨县"},{"name":"息县"}]},{"name":"济源市","sub":[{"name":"济源市"}]},{"name":"周口市","sub":[{"name":"川汇区"},{"name":"扶沟县"},{"name":"西华县"},{"name":"商水县"},{"name":"沈丘县"},{"name":"郸城县"},{"name":"淮阳县"},{"name":"太康县"},{"name":"鹿邑县"},{"name":"项城市"}]},{"name":"驻马店市","sub":[{"name":"驿城区"},{"name":"西平县"},{"name":"上蔡县"},{"name":"平舆县"},{"name":"正阳县"},{"name":"确山县"},{"name":"泌阳县"},{"name":"汝南县"},{"name":"遂平县"},{"name":"新蔡县"}]}]},{"name":"湖北省","sub":[{"name":"武汉市","sub":[{"name":"江岸区"},{"name":"江汉区"},{"name":"硚口区"},{"name":"汉阳区"},{"name":"武昌区"},{"name":"青山区"},{"name":"洪山区"},{"name":"东西湖区"},{"name":"汉南区"},{"name":"蔡甸区"},{"name":"江夏区"},{"name":"黄陂区"},{"name":"新洲区"},{"name":"东湖新技术开发区"}]},{"name":"黄石市","sub":[{"name":"黄石港区"},{"name":"西塞山区"},{"name":"下陆区"},{"name":"铁山区"},{"name":"阳新县"},{"name":"大冶市"}]},{"name":"十堰市","sub":[{"name":"茅箭区"},{"name":"张湾区"},{"name":"郧阳区"},{"name":"郧西县"},{"name":"竹山县"},{"name":"竹溪县"},{"name":"房县"},{"name":"十堰经济技术开发区"},{"name":"丹江口市"}]},{"name":"宜昌市","sub":[{"name":"西陵区"},{"name":"伍家岗区"},{"name":"高新区"},{"name":"宜昌新区"},{"name":"点军区"},{"name":"猇亭区"},{"name":"夷陵区"},{"name":"远安县"},{"name":"兴山县"},{"name":"秭归县"},{"name":"长阳土家族自治县"},{"name":"五峰土家族自治县"},{"name":"宜都市"},{"name":"当阳市"},{"name":"枝江市"}]},{"name":"襄阳市","sub":[{"name":"襄城区"},{"name":"樊城区"},{"name":"襄州区"},{"name":"南漳县"},{"name":"谷城县"},{"name":"保康县"},{"name":"老河口市"},{"name":"枣阳市"},{"name":"宜城市"}]},{"name":"鄂州市","sub":[{"name":"梁子湖区"},{"name":"华容区"},{"name":"鄂城区"}]},{"name":"荆门市","sub":[{"name":"东宝区"},{"name":"掇刀区"},{"name":"京山县"},{"name":"沙洋县"},{"name":"漳河新区"},{"name":"屈家岭管理区"},{"name":"荆门高新技术产业开发区"},{"name":"钟祥市"}]},{"name":"孝感市","sub":[{"name":"孝南区"},{"name":"孝昌县"},{"name":"大悟县"},{"name":"云梦县"},{"name":"应城市"},{"name":"安陆市"},{"name":"汉川市"}]},{"name":"荆州市","sub":[{"name":"沙市区"},{"name":"荆州区"},{"name":"公安县"},{"name":"监利县"},{"name":"江陵县"},{"name":"石首市"},{"name":"洪湖市"},{"name":"荆州开发区"},{"name":"济南文旅区"},{"name":"华中农高区"},{"name":"松滋市"}]},{"name":"黄冈市","sub":[{"name":"黄州区"},{"name":"团风县"},{"name":"红安县"},{"name":"罗田县"},{"name":"英山县"},{"name":"浠水县"},{"name":"蕲春县"},{"name":"黄梅县"},{"name":"龙感湖管理区"},{"name":"麻城市"},{"name":"武穴市"}]},{"name":"咸宁市","sub":[{"name":"咸安区"},{"name":"嘉鱼县"},{"name":"通城县"},{"name":"崇阳县"},{"name":"通山县"},{"name":"赤壁市"}]},{"name":"随州市","sub":[{"name":"曾都区"},{"name":"随县"},{"name":"广水市"}]},{"name":"恩施土家族苗族自治州","sub":[{"name":"恩施市"},{"name":"利川市"},{"name":"建始县"},{"name":"巴东县"},{"name":"宣恩县"},{"name":"咸丰县"},{"name":"来凤县"},{"name":"鹤峰县"}]},{"name":"省直辖行政单位","sub":[{"name":"仙桃市"},{"name":"潜江市"},{"name":"天门市"},{"name":"神农架林区"}]}]},{"name":"湖南省","sub":[{"name":"长沙市","sub":[{"name":"芙蓉区"},{"name":"天心区"},{"name":"岳麓区"},{"name":"开福区"},{"name":"雨花区"},{"name":"长沙县"},{"name":"望城区"},{"name":"宁乡县"},{"name":"浏阳市"}]},{"name":"株洲市","sub":[{"name":"荷塘区"},{"name":"芦淞区"},{"name":"石峰区"},{"name":"天元区"},{"name":"株洲县"},{"name":"攸县"},{"name":"茶陵县"},{"name":"炎陵县"},{"name":"醴陵市"}]},{"name":"湘潭市","sub":[{"name":"雨湖区"},{"name":"岳塘区"},{"name":"湘潭县"},{"name":"湘乡市"},{"name":"韶山市"}]},{"name":"衡阳市","sub":[{"name":"珠晖区"},{"name":"雁峰区"},{"name":"石鼓区"},{"name":"蒸湘区"},{"name":"南岳区"},{"name":"衡阳县"},{"name":"衡南县"},{"name":"衡山县"},{"name":"衡东县"},{"name":"祁东县"},{"name":"耒阳市"},{"name":"常宁市"}]},{"name":"邵阳市","sub":[{"name":"双清区"},{"name":"大祥区"},{"name":"北塔区"},{"name":"邵东县"},{"name":"新邵县"},{"name":"邵阳县"},{"name":"隆回县"},{"name":"洞口县"},{"name":"绥宁县"},{"name":"新宁县"},{"name":"城步苗族自治县"},{"name":"武冈市"}]},{"name":"岳阳市","sub":[{"name":"岳阳楼区"},{"name":"云溪区"},{"name":"君山区"},{"name":"岳阳县"},{"name":"华容县"},{"name":"湘阴县"},{"name":"平江县"},{"name":"汨罗市"},{"name":"临湘市"}]},{"name":"常德市","sub":[{"name":"武陵区"},{"name":"鼎城区"},{"name":"安乡县"},{"name":"汉寿县"},{"name":"澧县"},{"name":"临澧县"},{"name":"桃源县"},{"name":"石门县"},{"name":"津市市"}]},{"name":"张家界市","sub":[{"name":"永定区"},{"name":"武陵源区"},{"name":"慈利县"},{"name":"桑植县"}]},{"name":"益阳市","sub":[{"name":"资阳区"},{"name":"赫山区"},{"name":"南县"},{"name":"桃江县"},{"name":"安化县"},{"name":"沅江市"}]},{"name":"郴州市","sub":[{"name":"北湖区"},{"name":"苏仙区"},{"name":"桂阳县"},{"name":"宜章县"},{"name":"永兴县"},{"name":"嘉禾县"},{"name":"临武县"},{"name":"汝城县"},{"name":"桂东县"},{"name":"安仁县"},{"name":"资兴市"}]},{"name":"永州市","sub":[{"name":"零陵区"},{"name":"冷水滩区"},{"name":"祁阳县"},{"name":"东安县"},{"name":"双牌县"},{"name":"道县"},{"name":"江永县"},{"name":"宁远县"},{"name":"蓝山县"},{"name":"新田县"},{"name":"江华瑶族自治县"}]},{"name":"怀化市","sub":[{"name":"鹤城区"},{"name":"中方县"},{"name":"沅陵县"},{"name":"辰溪县"},{"name":"溆浦县"},{"name":"会同县"},{"name":"麻阳苗族自治县"},{"name":"新晃侗族自治县"},{"name":"芷江侗族自治县"},{"name":"靖州苗族侗族自治县"},{"name":"通道侗族自治县"},{"name":"洪江市"}]},{"name":"娄底市","sub":[{"name":"娄星区"},{"name":"双峰县"},{"name":"新化县"},{"name":"冷水江市"},{"name":"涟源市"}]},{"name":"湘西土家族苗族自治州","sub":[{"name":"吉首市"},{"name":"泸溪县"},{"name":"凤凰县"},{"name":"花垣县"},{"name":"保靖县"},{"name":"古丈县"},{"name":"永顺县"},{"name":"龙山县"}]}]},{"name":"广东省","sub":[{"name":"广州市","sub":[{"name":"荔湾区"},{"name":"越秀区"},{"name":"海珠区"},{"name":"天河区"},{"name":"白云区"},{"name":"黄埔区"},{"name":"番禺区"},{"name":"花都区"},{"name":"南沙区"},{"name":"萝岗区"},{"name":"增城区"},{"name":"从化区"}]},{"name":"韶关市","sub":[{"name":"武江区"},{"name":"浈江区"},{"name":"曲江区"},{"name":"始兴县"},{"name":"仁化县"},{"name":"翁源县"},{"name":"乳源瑶族自治县"},{"name":"新丰县"},{"name":"乐昌市"},{"name":"南雄市"}]},{"name":"深圳市","sub":[{"name":"罗湖区"},{"name":"福田区"},{"name":"南山区"},{"name":"宝安区"},{"name":"龙岗区"},{"name":"盐田区"},{"name":"龙华区"},{"name":"坪山区"},{"name":"光明新区"},{"name":"大鹏新区"}]},{"name":"珠海市","sub":[{"name":"香洲区"},{"name":"斗门区"},{"name":"金湾区"}]},{"name":"汕头市","sub":[{"name":"龙湖区"},{"name":"金平区"},{"name":"濠江区"},{"name":"潮阳区"},{"name":"潮南区"},{"name":"南澳县"},{"name":"澄海区"}]},{"name":"佛山市","sub":[{"name":"禅城区"},{"name":"南海区"},{"name":"顺德区"},{"name":"三水区"},{"name":"高明区"}]},{"name":"江门市","sub":[{"name":"蓬江区"},{"name":"江海区"},{"name":"新会区"},{"name":"台山市"},{"name":"开平市"},{"name":"鹤山市"},{"name":"恩平市"}]},{"name":"湛江市","sub":[{"name":"赤坎区"},{"name":"霞山区"},{"name":"坡头区"},{"name":"麻章区"},{"name":"遂溪县"},{"name":"徐闻县"},{"name":"廉江市"},{"name":"雷州市"},{"name":"吴川市"}]},{"name":"茂名市","sub":[{"name":"茂南区"},{"name":"茂港区"},{"name":"电白区"},{"name":"高州市"},{"name":"化州市"},{"name":"信宜市"}]},{"name":"肇庆市","sub":[{"name":"端州区"},{"name":"鼎湖区"},{"name":"广宁县"},{"name":"怀集县"},{"name":"封开县"},{"name":"德庆县"},{"name":"高要市"},{"name":"四会市"}]},{"name":"惠州市","sub":[{"name":"惠城区"},{"name":"惠阳区"},{"name":"博罗县"},{"name":"惠东县"},{"name":"龙门县"}]},{"name":"梅州市","sub":[{"name":"梅江区"},{"name":"梅县区"},{"name":"大埔县"},{"name":"丰顺县"},{"name":"五华县"},{"name":"平远县"},{"name":"蕉岭县"},{"name":"兴宁市"}]},{"name":"汕尾市","sub":[{"name":"城区"},{"name":"海丰县"},{"name":"陆河县"},{"name":"陆丰市"}]},{"name":"河源市","sub":[{"name":"源城区"},{"name":"紫金县"},{"name":"龙川县"},{"name":"连平县"},{"name":"和平县"},{"name":"东源县"}]},{"name":"阳江市","sub":[{"name":"江城区"},{"name":"阳西县"},{"name":"阳东区"},{"name":"阳春市"}]},{"name":"清远市","sub":[{"name":"清城区"},{"name":"佛冈县"},{"name":"阳山县"},{"name":"连山壮族瑶族自治县"},{"name":"连南瑶族自治县"},{"name":"清新区"},{"name":"英德市"},{"name":"连州市"}]},{"name":"东莞市","sub":[{"name":"市辖区"}]},{"name":"中山市","sub":[{"name":"市辖区"}]},{"name":"潮州市","sub":[{"name":"湘桥区"},{"name":"潮安区"},{"name":"饶平县"}]},{"name":"揭阳市","sub":[{"name":"榕城区"},{"name":"揭东区"},{"name":"揭西县"},{"name":"惠来县"},{"name":"普宁市"}]},{"name":"云浮市","sub":[{"name":"云城区"},{"name":"新兴县"},{"name":"郁南县"},{"name":"云安区"},{"name":"罗定市"}]}]},{"name":"广西壮族自治区","sub":[{"name":"南宁市","sub":[{"name":"兴宁区"},{"name":"青秀区"},{"name":"江南区"},{"name":"西乡塘区"},{"name":"良庆区"},{"name":"邕宁区"},{"name":"武鸣区"},{"name":"隆安县"},{"name":"马山县"},{"name":"上林县"},{"name":"南宁高新技术产业开发区"},{"name":"南宁经济技术开发区"},{"name":"广西—东盟经济技术开发区"},{"name":"宾阳县"},{"name":"横县"}]},{"name":"柳州市","sub":[{"name":"城中区"},{"name":"鱼峰区"},{"name":"柳南区"},{"name":"柳北区"},{"name":"柳江县"},{"name":"柳城县"},{"name":"鹿寨县"},{"name":"融安县"},{"name":"融水苗族自治县"},{"name":"三江侗族自治县"}]},{"name":"桂林市","sub":[{"name":"秀峰区"},{"name":"叠彩区"},{"name":"象山区"},{"name":"七星区"},{"name":"雁山区"},{"name":"阳朔县"},{"name":"临桂区"},{"name":"灵川县"},{"name":"全州县"},{"name":"兴安县"},{"name":"永福县"},{"name":"灌阳县"},{"name":"龙胜各族自治县"},{"name":"资源县"},{"name":"平乐县"},{"name":"荔浦县"},{"name":"恭城瑶族自治县"}]},{"name":"梧州市","sub":[{"name":"万秀区"},{"name":"龙圩区"},{"name":"长洲区"},{"name":"苍梧县"},{"name":"藤县"},{"name":"蒙山县"},{"name":"岑溪市"}]},{"name":"北海市","sub":[{"name":"海城区"},{"name":"银海区"},{"name":"铁山港区"},{"name":"合浦县"}]},{"name":"防城港市","sub":[{"name":"港口区"},{"name":"防城区"},{"name":"上思县"},{"name":"东兴市"}]},{"name":"钦州市","sub":[{"name":"钦南区"},{"name":"钦北区"},{"name":"灵山县"},{"name":"钦州港经济技术开发区"},{"name":"三娘湾旅游管理区"},{"name":"浦北县"}]},{"name":"贵港市","sub":[{"name":"港北区"},{"name":"港南区"},{"name":"覃塘区"},{"name":"平南县"},{"name":"桂平市"}]},{"name":"玉林市","sub":[{"name":"玉州区"},{"name":"容县"},{"name":"福绵区"},{"name":"陆川县"},{"name":"博白县"},{"name":"兴业县"},{"name":"北流市"}]},{"name":"百色市","sub":[{"name":"右江区"},{"name":"田阳县"},{"name":"田东县"},{"name":"平果县"},{"name":"德保县"},{"name":"靖西市"},{"name":"那坡县"},{"name":"凌云县"},{"name":"乐业县"},{"name":"田林县"},{"name":"西林县"},{"name":"隆林各族自治县"}]},{"name":"贺州市","sub":[{"name":"八步区"},{"name":"昭平县"},{"name":"平桂区"},{"name":"钟山县"},{"name":"富川瑶族自治县"}]},{"name":"河池市","sub":[{"name":"金城江区"},{"name":"南丹县"},{"name":"天峨县"},{"name":"凤山县"},{"name":"东兰县"},{"name":"罗城仫佬族自治县"},{"name":"环江毛南族自治县"},{"name":"巴马瑶族自治县"},{"name":"都安瑶族自治县"},{"name":"大化瑶族自治县"},{"name":"宜州市"}]},{"name":"来宾市","sub":[{"name":"兴宾区"},{"name":"忻城县"},{"name":"象州县"},{"name":"武宣县"},{"name":"金秀瑶族自治县"},{"name":"合山市"}]},{"name":"崇左市","sub":[{"name":"江洲区"},{"name":"扶绥县"},{"name":"宁明县"},{"name":"龙州县"},{"name":"大新县"},{"name":"天等县"},{"name":"凭祥市"}]}]},{"name":"海南省","sub":[{"name":"海口市","sub":[{"name":"秀英区"},{"name":"龙华区"},{"name":"琼山区"},{"name":"美兰区"}]},{"name":"三亚市","sub":[{"name":"吉阳区"},{"name":"崖州区"},{"name":"天涯区"},{"name":"海棠区"}]},{"name":"三沙市","sub":[{"name":"西沙群岛"},{"name":"南沙群岛"},{"name":"永乐群岛"},{"name":"中沙群岛的岛礁及其海域"}]},{"name":"省直辖县级行政单位","sub":[{"name":"五指山市"},{"name":"琼海市"},{"name":"儋州市"},{"name":"文昌市"},{"name":"万宁市"},{"name":"东方市"},{"name":"定安县"},{"name":"屯昌县"},{"name":"澄迈县"},{"name":"临高县"},{"name":"白沙黎族自治县"},{"name":"昌江黎族自治县"},{"name":"乐东黎族自治县"},{"name":"陵水黎族自治县"},{"name":"保亭黎族苗族自治县"},{"name":"琼中黎族苗族自治县"}]}]},{"name":"重庆市","sub":[{"name":"重庆市","sub":[{"name":"万州区"},{"name":"涪陵区"},{"name":"渝中区"},{"name":"大渡口区"},{"name":"江北区"},{"name":"沙坪坝区"},{"name":"九龙坡区"},{"name":"南岸区"},{"name":"北碚区"},{"name":"荣昌区"},{"name":"开州区"},{"name":"渝北区"},{"name":"巴南区"},{"name":"黔江区"},{"name":"长寿区"},{"name":"江津区"},{"name":"合川区"},{"name":"永川区"},{"name":"南川区"},{"name":"綦江县"},{"name":"潼南区"},{"name":"铜梁区"},{"name":"大足县"},{"name":"荣昌区"},{"name":"璧山区"},{"name":"梁平区"},{"name":"城口县"},{"name":"丰都县"},{"name":"垫江县"},{"name":"武隆区"},{"name":"忠县"},{"name":"云阳县"},{"name":"奉节县"},{"name":"巫山县"},{"name":"巫溪县"},{"name":"石柱土家族自治县"},{"name":"秀山土家族苗族自治县"},{"name":"酉阳土家族苗族自治县"},{"name":"彭水苗族土家族自治县"}]}]},{"name":"四川省","sub":[{"name":"成都市","sub":[{"name":"锦江区"},{"name":"青羊区"},{"name":"金牛区"},{"name":"武侯区"},{"name":"成华区"},{"name":"龙泉驿区"},{"name":"青白江区"},{"name":"新都区"},{"name":"温江区"},{"name":"金堂县"},{"name":"双流区"},{"name":"郫都区"},{"name":"大邑县"},{"name":"蒲江县"},{"name":"新津县"},{"name":"都江堰市"},{"name":"彭州市"},{"name":"邛崃市"},{"name":"简阳市"},{"name":"崇州市"}]},{"name":"自贡市","sub":[{"name":"自流井区"},{"name":"贡井区"},{"name":"大安区"},{"name":"沿滩区"},{"name":"荣县"},{"name":"富顺县"}]},{"name":"攀枝花市","sub":[{"name":"东区"},{"name":"西区"},{"name":"仁和区"},{"name":"米易县"},{"name":"盐边县"}]},{"name":"泸州市","sub":[{"name":"江阳区"},{"name":"纳溪区"},{"name":"龙马潭区"},{"name":"泸县"},{"name":"合江县"},{"name":"叙永县"},{"name":"古蔺县"}]},{"name":"德阳市","sub":[{"name":"旌阳区"},{"name":"中江县"},{"name":"罗江县"},{"name":"广汉市"},{"name":"什邡市"},{"name":"绵竹市"}]},{"name":"绵阳市","sub":[{"name":"涪城区"},{"name":"游仙区"},{"name":"三台县"},{"name":"盐亭县"},{"name":"安州区"},{"name":"梓潼县"},{"name":"北川羌族自治县"},{"name":"平武县"},{"name":"江油市"}]},{"name":"广元市","sub":[{"name":"利州区"},{"name":"昭化区"},{"name":"朝天区"},{"name":"旺苍县"},{"name":"青川县"},{"name":"剑阁县"},{"name":"苍溪县"}]},{"name":"遂宁市","sub":[{"name":"船山区"},{"name":"安居区"},{"name":"蓬溪县"},{"name":"射洪县"},{"name":"大英县"}]},{"name":"内江市","sub":[{"name":"市中区"},{"name":"东兴区"},{"name":"威远县"},{"name":"资中县"},{"name":"内江经济开发区"},{"name":"隆昌县"}]},{"name":"乐山市","sub":[{"name":"市中区"},{"name":"沙湾区"},{"name":"五通桥区"},{"name":"金口河区"},{"name":"犍为县"},{"name":"井研县"},{"name":"夹江县"},{"name":"沐川县"},{"name":"峨边彝族自治县"},{"name":"马边彝族自治县"},{"name":"峨眉山市"}]},{"name":"南充市","sub":[{"name":"顺庆区"},{"name":"高坪区"},{"name":"嘉陵区"},{"name":"南部县"},{"name":"营山县"},{"name":"蓬安县"},{"name":"仪陇县"},{"name":"西充县"},{"name":"阆中市"}]},{"name":"眉山市","sub":[{"name":"东坡区"},{"name":"仁寿县"},{"name":"彭山区"},{"name":"洪雅县"},{"name":"丹棱县"},{"name":"青神县"}]},{"name":"宜宾市","sub":[{"name":"翠屏区"},{"name":"宜宾县"},{"name":"南溪区"},{"name":"江安县"},{"name":"长宁县"},{"name":"高县"},{"name":"珙县"},{"name":"筠连县"},{"name":"兴文县"},{"name":"屏山县"}]},{"name":"广安市","sub":[{"name":"广安区"},{"name":"前锋区"},{"name":"岳池县"},{"name":"武胜县"},{"name":"邻水县"},{"name":"华蓥市"}]},{"name":"达州市","sub":[{"name":"通川区"},{"name":"达州区"},{"name":"宣汉县"},{"name":"开江县"},{"name":"大竹县"},{"name":"渠县"},{"name":"万源市"}]},{"name":"雅安市","sub":[{"name":"雨城区"},{"name":"名山县"},{"name":"荥经县"},{"name":"汉源县"},{"name":"石棉县"},{"name":"天全县"},{"name":"芦山县"},{"name":"宝兴县"}]},{"name":"巴中市","sub":[{"name":"巴州区"},{"name":"恩阳区"},{"name":"通江县"},{"name":"南江县"},{"name":"平昌县"}]},{"name":"资阳市","sub":[{"name":"雁江区"},{"name":"安岳县"},{"name":"乐至县"}]},{"name":"阿坝藏族羌族自治州","sub":[{"name":"汶川县"},{"name":"理县"},{"name":"茂县"},{"name":"松潘县"},{"name":"九寨沟县"},{"name":"金川县"},{"name":"小金县"},{"name":"黑水县"},{"name":"马尔康市"},{"name":"壤塘县"},{"name":"阿坝县"},{"name":"若尔盖县"},{"name":"红原县"}]},{"name":"甘孜藏族自治州","sub":[{"name":"康定县"},{"name":"泸定县"},{"name":"丹巴县"},{"name":"九龙县"},{"name":"雅江县"},{"name":"道孚县"},{"name":"炉霍县"},{"name":"甘孜县"},{"name":"新龙县"},{"name":"德格县"},{"name":"白玉县"},{"name":"石渠县"},{"name":"色达县"},{"name":"理塘县"},{"name":"巴塘县"},{"name":"乡城县"},{"name":"稻城县"},{"name":"得荣县"}]},{"name":"凉山彝族自治州","sub":[{"name":"西昌市"},{"name":"木里藏族自治县"},{"name":"盐源县"},{"name":"德昌县"},{"name":"会理县"},{"name":"会东县"},{"name":"宁南县"},{"name":"普格县"},{"name":"布拖县"},{"name":"金阳县"},{"name":"昭觉县"},{"name":"喜德县"},{"name":"冕宁县"},{"name":"越西县"},{"name":"甘洛县"},{"name":"美姑县"},{"name":"雷波县"}]}]},{"name":"贵州省","sub":[{"name":"贵阳市","sub":[{"name":"南明区"},{"name":"云岩区"},{"name":"花溪区"},{"name":"乌当区"},{"name":"白云区"},{"name":"观山湖区"},{"name":"开阳县"},{"name":"息烽县"},{"name":"修文县"},{"name":"清镇市"}]},{"name":"六盘水市","sub":[{"name":"钟山区"},{"name":"六枝特区"},{"name":"水城县"},{"name":"盘县"}]},{"name":"遵义市","sub":[{"name":"红花岗区"},{"name":"汇川区"},{"name":"播州区"},{"name":"桐梓县"},{"name":"绥阳县"},{"name":"正安县"},{"name":"道真仡佬族苗族自治县"},{"name":"务川仡佬族苗族自治县"},{"name":"凤冈县"},{"name":"湄潭县"},{"name":"余庆县"},{"name":"习水县"},{"name":"赤水市"},{"name":"仁怀市"}]},{"name":"安顺市","sub":[{"name":"西秀区"},{"name":"平坝区"},{"name":"普定县"},{"name":"镇宁布依族苗族自治县"},{"name":"关岭布依族苗族自治县"},{"name":"紫云苗族布依族自治县"}]},{"name":"铜仁市","sub":[{"name":"碧江区"},{"name":"万山区"},{"name":"玉屏侗族自治县"},{"name":"江口县"},{"name":"思南县"},{"name":"印江土家族苗族自治县"},{"name":"德江县"},{"name":"沿河土家族自治县"},{"name":"松桃苗族自治县"},{"name":"石阡县"}]},{"name":"黔西南布依族苗族自治州","sub":[{"name":"兴义市"},{"name":"兴仁县"},{"name":"普安县"},{"name":"晴隆县"},{"name":"贞丰县"},{"name":"望谟县"},{"name":"册亨县"},{"name":"安龙县"}]},{"name":"毕节市","sub":[{"name":"七星关区"},{"name":"大方县"},{"name":"黔西县"},{"name":"金沙县"},{"name":"织金县"},{"name":"纳雍县"},{"name":"威宁彝族回族苗族自治县"},{"name":"赫章县"}]},{"name":"黔东南苗族侗族自治州","sub":[{"name":"凯里市"},{"name":"黄平县"},{"name":"施秉县"},{"name":"三穗县"},{"name":"镇远县"},{"name":"岑巩县"},{"name":"天柱县"},{"name":"锦屏县"},{"name":"剑河县"},{"name":"台江县"},{"name":"黎平县"},{"name":"榕江县"},{"name":"从江县"},{"name":"雷山县"},{"name":"麻江县"},{"name":"丹寨县"}]},{"name":"黔南布依族苗族自治州","sub":[{"name":"都匀市"},{"name":"福泉市"},{"name":"荔波县"},{"name":"贵定县"},{"name":"瓮安县"},{"name":"独山县"},{"name":"平塘县"},{"name":"罗甸县"},{"name":"长顺县"},{"name":"龙里县"},{"name":"惠水县"},{"name":"三都水族自治县"}]}]},{"name":"云南省","sub":[{"name":"昆明市","sub":[{"name":"五华区"},{"name":"盘龙区"},{"name":"官渡区"},{"name":"西山区"},{"name":"东川区"},{"name":"呈贡区"},{"name":"晋宁县"},{"name":"富民县"},{"name":"宜良县"},{"name":"石林彝族自治县"},{"name":"嵩明县"},{"name":"禄劝彝族苗族自治县"},{"name":"寻甸回族彝族自治县"},{"name":"安宁市"}]},{"name":"曲靖市","sub":[{"name":"麒麟区"},{"name":"马龙县"},{"name":"陆良县"},{"name":"师宗县"},{"name":"罗平县"},{"name":"富源县"},{"name":"会泽县"},{"name":"沾益区"},{"name":"宣威市"}]},{"name":"玉溪市","sub":[{"name":"红塔区"},{"name":"江川区"},{"name":"澄江县"},{"name":"通海县"},{"name":"华宁县"},{"name":"易门县"},{"name":"峨山彝族自治县"},{"name":"新平彝族傣族自治县"},{"name":"元江哈尼族彝族傣族自治县"}]},{"name":"保山市","sub":[{"name":"隆阳区"},{"name":"施甸县"},{"name":"腾冲市"},{"name":"龙陵县"},{"name":"昌宁县"}]},{"name":"昭通市","sub":[{"name":"昭阳区"},{"name":"鲁甸县"},{"name":"巧家县"},{"name":"盐津县"},{"name":"大关县"},{"name":"永善县"},{"name":"绥江县"},{"name":"镇雄县"},{"name":"彝良县"},{"name":"威信县"},{"name":"水富县"}]},{"name":"丽江市","sub":[{"name":"古城区"},{"name":"玉龙纳西族自治县"},{"name":"永胜县"},{"name":"华坪县"},{"name":"宁蒗彝族自治县"}]},{"name":"普洱市","sub":[{"name":"思茅区"},{"name":"宁洱哈尼族彝族自治县"},{"name":"墨江哈尼族自治县"},{"name":"景东彝族自治县"},{"name":"景谷傣族彝族自治县"},{"name":"镇沅彝族哈尼族拉祜族自治县"},{"name":"江城哈尼族彝族自治县"},{"name":"孟连傣族拉祜族佤族自治县"},{"name":"澜沧拉祜族自治县"},{"name":"西盟佤族自治县"}]},{"name":"临沧市","sub":[{"name":"临翔区"},{"name":"凤庆县"},{"name":"云县"},{"name":"永德县"},{"name":"镇康县"},{"name":"双江拉祜族佤族布朗族傣族自治县"},{"name":"耿马傣族佤族自治县"},{"name":"沧源佤族自治县"}]},{"name":"楚雄彝族自治州","sub":[{"name":"楚雄市"},{"name":"双柏县"},{"name":"牟定县"},{"name":"南华县"},{"name":"姚安县"},{"name":"大姚县"},{"name":"永仁县"},{"name":"元谋县"},{"name":"武定县"},{"name":"禄丰县"}]},{"name":"红河哈尼族彝族自治州","sub":[{"name":"个旧市"},{"name":"开远市"},{"name":"蒙自市"},{"name":"屏边苗族自治县"},{"name":"建水县"},{"name":"石屏县"},{"name":"弥勒市"},{"name":"泸西县"},{"name":"元阳县"},{"name":"红河县"},{"name":"金平苗族瑶族傣族自治县"},{"name":"绿春县"},{"name":"河口瑶族自治县"}]},{"name":"文山壮族苗族自治州","sub":[{"name":"文山市"},{"name":"砚山县"},{"name":"西畴县"},{"name":"麻栗坡县"},{"name":"马关县"},{"name":"丘北县"},{"name":"广南县"},{"name":"富宁县"}]},{"name":"西双版纳傣族自治州","sub":[{"name":"景洪市"},{"name":"勐海县"},{"name":"勐腊县"}]},{"name":"大理白族自治州","sub":[{"name":"大理市"},{"name":"漾濞彝族自治县"},{"name":"祥云县"},{"name":"宾川县"},{"name":"弥渡县"},{"name":"南涧彝族自治县"},{"name":"巍山彝族回族自治县"},{"name":"永平县"},{"name":"云龙县"},{"name":"洱源县"},{"name":"剑川县"},{"name":"鹤庆县"}]},{"name":"德宏傣族景颇族自治州","sub":[{"name":"瑞丽市"},{"name":"芒市"},{"name":"梁河县"},{"name":"盈江县"},{"name":"陇川县"}]},{"name":"怒江傈僳族自治州","sub":[{"name":"泸水市"},{"name":"福贡县"},{"name":"贡山独龙族怒族自治县"},{"name":"兰坪白族普米族自治县"}]},{"name":"迪庆藏族自治州","sub":[{"name":"香格里拉市"},{"name":"德钦县"},{"name":"维西傈僳族自治县"}]}]},{"name":"西藏自治区","sub":[{"name":"拉萨市","sub":[{"name":"城关区"},{"name":"林周县"},{"name":"当雄县"},{"name":"尼木县"},{"name":"曲水县"},{"name":"堆龙德庆县"},{"name":"达孜县"},{"name":"墨竹工卡县"}]},{"name":"昌都市","sub":[{"name":"卡若区"},{"name":"江达县"},{"name":"贡觉县"},{"name":"类乌齐县"},{"name":"丁青县"},{"name":"察雅县"},{"name":"八宿县"},{"name":"左贡县"},{"name":"芒康县"},{"name":"洛隆县"},{"name":"边坝县"}]},{"name":"山南市","sub":[{"name":"乃东区"},{"name":"扎囊县"},{"name":"贡嘎县"},{"name":"桑日县"},{"name":"琼结县"},{"name":"曲松县"},{"name":"措美县"},{"name":"洛扎县"},{"name":"加查县"},{"name":"隆子县"},{"name":"错那县"},{"name":"浪卡子县"}]},{"name":"日喀则市","sub":[{"name":"桑孜珠区"},{"name":"南木林县"},{"name":"江孜县"},{"name":"定日县"},{"name":"萨迦县"},{"name":"拉孜县"},{"name":"昂仁县"},{"name":"谢通门县"},{"name":"白朗县"},{"name":"仁布县"},{"name":"康马县"},{"name":"定结县"},{"name":"仲巴县"},{"name":"亚东县"},{"name":"吉隆县"},{"name":"聂拉木县"},{"name":"萨嘎县"},{"name":"岗巴县"}]},{"name":"那曲地区","sub":[{"name":"那曲县"},{"name":"嘉黎县"},{"name":"比如县"},{"name":"聂荣县"},{"name":"安多县"},{"name":"申扎县"},{"name":"索县"},{"name":"班戈县"},{"name":"巴青县"},{"name":"尼玛县"}]},{"name":"阿里地区","sub":[{"name":"普兰县"},{"name":"札达县"},{"name":"噶尔县"},{"name":"日土县"},{"name":"革吉县"},{"name":"改则县"},{"name":"措勤县"}]},{"name":"林芝市","sub":[{"name":"巴宜区"},{"name":"工布江达县"},{"name":"米林县"},{"name":"墨脱县"},{"name":"波密县"},{"name":"察隅县"},{"name":"朗县"}]}]},{"name":"陕西省","sub":[{"name":"西安市","sub":[{"name":"新城区"},{"name":"碑林区"},{"name":"莲湖区"},{"name":"灞桥区"},{"name":"未央区"},{"name":"雁塔区"},{"name":"阎良区"},{"name":"临潼区"},{"name":"长安区"},{"name":"鄠邑区"},{"name":"蓝田县"},{"name":"周至县"},{"name":"户县"},{"name":"高陵区"}]},{"name":"铜川市","sub":[{"name":"王益区"},{"name":"印台区"},{"name":"耀州区"},{"name":"宜君县"}]},{"name":"宝鸡市","sub":[{"name":"渭滨区"},{"name":"金台区"},{"name":"陈仓区"},{"name":"凤翔县"},{"name":"岐山县"},{"name":"扶风县"},{"name":"眉县"},{"name":"陇县"},{"name":"千阳县"},{"name":"麟游县"},{"name":"凤县"},{"name":"太白县"}]},{"name":"咸阳市","sub":[{"name":"秦都区"},{"name":"杨凌区"},{"name":"渭城区"},{"name":"三原县"},{"name":"泾阳县"},{"name":"乾县"},{"name":"礼泉县"},{"name":"永寿县"},{"name":"彬县"},{"name":"长武县"},{"name":"旬邑县"},{"name":"淳化县"},{"name":"武功县"},{"name":"兴平市"}]},{"name":"渭南市","sub":[{"name":"临渭区"},{"name":"华州区"},{"name":"潼关县"},{"name":"大荔县"},{"name":"合阳县"},{"name":"澄城县"},{"name":"蒲城县"},{"name":"白水县"},{"name":"富平县"},{"name":"韩城市"},{"name":"华阴市"}]},{"name":"延安市","sub":[{"name":"宝塔区"},{"name":"延长县"},{"name":"延川县"},{"name":"子长县"},{"name":"安塞区"},{"name":"志丹县"},{"name":"吴起县"},{"name":"甘泉县"},{"name":"富县"},{"name":"洛川县"},{"name":"宜川县"},{"name":"黄龙县"},{"name":"黄陵县"}]},{"name":"汉中市","sub":[{"name":"汉台区"},{"name":"南郑县"},{"name":"城固县"},{"name":"洋县"},{"name":"西乡县"},{"name":"勉县"},{"name":"宁强县"},{"name":"略阳县"},{"name":"镇巴县"},{"name":"留坝县"},{"name":"佛坪县"}]},{"name":"榆林市","sub":[{"name":"榆阳区"},{"name":"神木县"},{"name":"府谷县"},{"name":"横山区"},{"name":"靖边县"},{"name":"定边县"},{"name":"绥德县"},{"name":"米脂县"},{"name":"佳县"},{"name":"吴堡县"},{"name":"清涧县"},{"name":"子洲县"}]},{"name":"安康市","sub":[{"name":"汉滨区"},{"name":"汉阴县"},{"name":"石泉县"},{"name":"宁陕县"},{"name":"紫阳县"},{"name":"岚皋县"},{"name":"平利县"},{"name":"镇坪县"},{"name":"旬阳县"},{"name":"白河县"}]},{"name":"商洛市","sub":[{"name":"商州区"},{"name":"洛南县"},{"name":"丹凤县"},{"name":"商南县"},{"name":"山阳县"},{"name":"镇安县"},{"name":"柞水县"}]}]},{"name":"甘肃省","sub":[{"name":"兰州市","sub":[{"name":"城关区"},{"name":"七里河区"},{"name":"西固区"},{"name":"安宁区"},{"name":"红古区"},{"name":"永登县"},{"name":"皋兰县"},{"name":"榆中县"}]},{"name":"嘉峪关市","sub":[{"name":"市区"}]},{"name":"金昌市","sub":[{"name":"金川区"},{"name":"永昌县"}]},{"name":"白银市","sub":[{"name":"白银区"},{"name":"平川区"},{"name":"靖远县"},{"name":"会宁县"},{"name":"景泰县"}]},{"name":"天水市","sub":[{"name":"秦州区"},{"name":"麦积区"},{"name":"清水县"},{"name":"秦安县"},{"name":"甘谷县"},{"name":"武山县"},{"name":"张家川回族自治县"}]},{"name":"武威市","sub":[{"name":"凉州区"},{"name":"民勤县"},{"name":"古浪县"},{"name":"天祝藏族自治县"}]},{"name":"张掖市","sub":[{"name":"甘州区"},{"name":"肃南裕固族自治县"},{"name":"民乐县"},{"name":"临泽县"},{"name":"高台县"},{"name":"山丹县"}]},{"name":"平凉市","sub":[{"name":"崆峒区"},{"name":"泾川县"},{"name":"灵台县"},{"name":"崇信县"},{"name":"华亭县"},{"name":"庄浪县"},{"name":"静宁县"}]},{"name":"酒泉市","sub":[{"name":"肃州区"},{"name":"金塔县"},{"name":"瓜州县"},{"name":"肃北蒙古族自治县"},{"name":"阿克塞哈萨克族自治县"},{"name":"玉门市"},{"name":"敦煌市"}]},{"name":"庆阳市","sub":[{"name":"西峰区"},{"name":"庆城县"},{"name":"环县"},{"name":"华池县"},{"name":"合水县"},{"name":"正宁县"},{"name":"宁县"},{"name":"镇原县"}]},{"name":"定西市","sub":[{"name":"安定区"},{"name":"通渭县"},{"name":"陇西县"},{"name":"渭源县"},{"name":"临洮县"},{"name":"漳县"},{"name":"岷县"}]},{"name":"陇南市","sub":[{"name":"武都区"},{"name":"成县"},{"name":"文县"},{"name":"宕昌县"},{"name":"康县"},{"name":"西和县"},{"name":"礼县"},{"name":"徽县"},{"name":"两当县"}]},{"name":"临夏回族自治州","sub":[{"name":"临夏市"},{"name":"临夏县"},{"name":"康乐县"},{"name":"永靖县"},{"name":"广河县"},{"name":"和政县"},{"name":"东乡族自治县"},{"name":"积石山保安族东乡族撒拉族自治县"}]},{"name":"甘南藏族自治州","sub":[{"name":"合作市"},{"name":"临潭县"},{"name":"卓尼县"},{"name":"舟曲县"},{"name":"迭部县"},{"name":"玛曲县"},{"name":"碌曲县"},{"name":"夏河县"}]}]},{"name":"青海省","sub":[{"name":"西宁市","sub":[{"name":"城东区"},{"name":"城中区"},{"name":"城西区"},{"name":"城北区"},{"name":"大通回族土族自治县"},{"name":"湟中县"},{"name":"湟源县"}]},{"name":"海东市","sub":[{"name":"平安区"},{"name":"民和回族土族自治县"},{"name":"乐都区"},{"name":"互助土族自治县"},{"name":"化隆回族自治县"},{"name":"循化撒拉族自治县"}]},{"name":"海北藏族自治州","sub":[{"name":"门源回族自治县"},{"name":"祁连县"},{"name":"海晏县"},{"name":"刚察县"}]},{"name":"黄南藏族自治州","sub":[{"name":"同仁县"},{"name":"尖扎县"},{"name":"泽库县"},{"name":"河南蒙古族自治县"}]},{"name":"海南藏族自治州","sub":[{"name":"共和县"},{"name":"同德县"},{"name":"贵德县"},{"name":"兴海县"},{"name":"贵南县"}]},{"name":"果洛藏族自治州","sub":[{"name":"玛沁县"},{"name":"班玛县"},{"name":"甘德县"},{"name":"达日县"},{"name":"久治县"},{"name":"玛多县"}]},{"name":"玉树藏族自治州","sub":[{"name":"玉树市"},{"name":"杂多县"},{"name":"称多县"},{"name":"治多县"},{"name":"囊谦县"},{"name":"曲麻莱县"}]},{"name":"海西蒙古族藏族自治州","sub":[{"name":"格尔木市"},{"name":"德令哈市"},{"name":"乌兰县"},{"name":"都兰县"},{"name":"大柴旦行委"},{"name":"茫崖行委"},{"name":"冷湖行委"},{"name":"天峻县"}]}]},{"name":"宁夏回族自治区","sub":[{"name":"银川市","sub":[{"name":"兴庆区"},{"name":"西夏区"},{"name":"金凤区"},{"name":"永宁县"},{"name":"贺兰县"},{"name":"灵武市"}]},{"name":"石嘴山市","sub":[{"name":"大武口区"},{"name":"惠农区"},{"name":"平罗县"}]},{"name":"吴忠市","sub":[{"name":"利通区"},{"name":"红寺堡区"},{"name":"盐池县"},{"name":"同心县"},{"name":"青铜峡市"}]},{"name":"固原市","sub":[{"name":"原州区"},{"name":"西吉县"},{"name":"隆德县"},{"name":"泾源县"},{"name":"彭阳县"}]},{"name":"中卫市","sub":[{"name":"沙坡头区"},{"name":"中宁县"},{"name":"海原县"}]}]},{"name":"新疆维吾尔自治区","sub":[{"name":"乌鲁木齐市","sub":[{"name":"天山区"},{"name":"沙依巴克区"},{"name":"新市区"},{"name":"水磨沟区"},{"name":"头屯河区"},{"name":"达坂城区"},{"name":"米东区"},{"name":"乌鲁木齐县"}]},{"name":"克拉玛依市","sub":[{"name":"独山子区"},{"name":"克拉玛依区"},{"name":"白碱滩区"},{"name":"乌尔禾区"}]},{"name":"吐鲁番地区","sub":[{"name":"吐鲁番市"},{"name":"高昌区"},{"name":"鄯善县"},{"name":"托克逊县"}]},{"name":"哈密地区","sub":[{"name":"哈密市"},{"name":"巴里坤哈萨克自治县"},{"name":"伊吾县"}]},{"name":"昌吉回族自治州","sub":[{"name":"昌吉市"},{"name":"阜康市"},{"name":"呼图壁县"},{"name":"玛纳斯县"},{"name":"奇台县"},{"name":"吉木萨尔县"},{"name":"木垒哈萨克自治县"}]},{"name":"博尔塔拉蒙古自治州","sub":[{"name":"博乐市"},{"name":"阿拉山口市"},{"name":"精河县"},{"name":"温泉县"}]},{"name":"巴音郭楞蒙古自治州","sub":[{"name":"库尔勒市"},{"name":"轮台县"},{"name":"尉犁县"},{"name":"若羌县"},{"name":"且末县"},{"name":"焉耆回族自治县"},{"name":"和静县"},{"name":"和硕县"},{"name":"博湖县"}]},{"name":"阿克苏地区","sub":[{"name":"阿克苏市"},{"name":"温宿县"},{"name":"库车县"},{"name":"沙雅县"},{"name":"新和县"},{"name":"拜城县"},{"name":"乌什县"},{"name":"阿瓦提县"},{"name":"柯坪县"}]},{"name":"克孜勒苏柯尔克孜自治州","sub":[{"name":"阿图什市"},{"name":"阿克陶县"},{"name":"阿合奇县"},{"name":"乌恰县"}]},{"name":"喀什地区","sub":[{"name":"喀什市"},{"name":"疏附县"},{"name":"疏勒县"},{"name":"英吉沙县"},{"name":"泽普县"},{"name":"莎车县"},{"name":"叶城县"},{"name":"麦盖提县"},{"name":"岳普湖县"},{"name":"伽师县"},{"name":"巴楚县"},{"name":"塔什库尔干塔吉克自治县"}]},{"name":"和田地区","sub":[{"name":"和田市"},{"name":"和田县"},{"name":"墨玉县"},{"name":"皮山县"},{"name":"洛浦县"},{"name":"策勒县"},{"name":"于田县"},{"name":"民丰县"}]},{"name":"伊犁哈萨克自治州","sub":[{"name":"伊宁市"},{"name":"奎屯市"},{"name":"伊宁县"},{"name":"察布查尔锡伯自治县"},{"name":"霍尔果斯市"},{"name":"霍城县"},{"name":"巩留县"},{"name":"新源县"},{"name":"昭苏县"},{"name":"特克斯县"},{"name":"尼勒克县"}]},{"name":"塔城地区","sub":[{"name":"塔城市"},{"name":"乌苏市"},{"name":"额敏县"},{"name":"沙湾县"},{"name":"托里县"},{"name":"裕民县"},{"name":"和布克赛尔蒙古自治县"}]},{"name":"阿勒泰地区","sub":[{"name":"阿勒泰市"},{"name":"布尔津县"},{"name":"富蕴县"},{"name":"福海县"},{"name":"哈巴河县"},{"name":"青河县"},{"name":"吉木乃县"}]},{"name":"省直辖行政单位","sub":[{"name":"石河子市"},{"name":"阿拉尔市"},{"name":"北屯市"},{"name":"铁门关市"},{"name":"双河市"},{"name":"可克达拉市"},{"name":"昆玉市"},{"name":"图木舒克市"},{"name":"五家渠市"}]}]},{"name":"香港","sub":[{"name":"香港","sub":[{"name":"中西区"},{"name":"湾仔区"},{"name":"东区"},{"name":"南区"},{"name":"深水埗区"},{"name":"油尖旺区"},{"name":"九龙城区"},{"name":"黄大仙区"},{"name":"观塘区"},{"name":"北区"},{"name":"大埔区"},{"name":"沙田区"},{"name":"西贡区"},{"name":"元朗区"},{"name":"屯门区"},{"name":"荃湾区"},{"name":"葵青区"},{"name":"离岛区"},{"name":"其他"}]}]},{"name":"澳门","sub":[{"name":"澳门","sub":[{"name":"花地玛堂区"},{"name":"圣安多尼堂区"},{"name":"大堂区"},{"name":"望德堂区"},{"name":"风顺堂区"},{"name":"嘉模堂区"},{"name":"圣方济各堂区"},{"name":"路氹城"},{"name":"其他"}]}]},{"name":"台湾","sub":[{"name":"台湾","sub":[{"name":"台北市"},{"name":"高雄市"},{"name":"新北市"},{"name":"桃园市"},{"name":"新竹县"},{"name":"苗栗县"},{"name":"台中市"},{"name":"彰化县"},{"name":"南投县"},{"name":"云林县"},{"name":"嘉义县"},{"name":"台南市"},{"name":"高雄市"},{"name":"屏东县"},{"name":"宜兰县"},{"name":"花莲县"},{"name":"台东县"},{"name":"澎湖县"},{"name":"基隆市"},{"name":"新竹市"},{"name":"嘉义市"},{"name":"金门县"},{"name":"连江县"},{"name":"其他"}]}]},{"name":"海外","sub":[{"name":"亚洲","sub":[{"name":"阿富汗"},{"name":"阿联酋"},{"name":"阿曼"},{"name":"阿塞拜疆"},{"name":"巴基斯坦"},{"name":"巴勒斯坦"},{"name":"塞浦路斯"},{"name":"巴林"},{"name":"朝鲜"},{"name":"老挝"},{"name":"不丹"},{"name":"东帝汶"},{"name":"菲律宾"},{"name":"格鲁吉亚"},{"name":"哈萨克斯坦"},{"name":"韩国"},{"name":"吉尔吉斯斯坦"},{"name":"柬埔寨"},{"name":"卡塔尔"},{"name":"科威特"},{"name":"黎巴嫩"},{"name":"马尔代夫"},{"name":"马来西亚"},{"name":"蒙古"},{"name":"孟加拉国"},{"name":"缅甸"},{"name":"尼泊尔"},{"name":"日本"},{"name":"沙特阿拉伯"},{"name":"斯里兰卡"},{"name":"塔吉克斯坦"},{"name":"泰国"},{"name":"土耳其"},{"name":"土库曼斯坦"},{"name":"文莱"},{"name":"乌兹别克斯坦"},{"name":"新加坡"},{"name":"叙利亚"},{"name":"亚美尼亚"},{"name":"也门"},{"name":"伊拉克"},{"name":"伊朗"},{"name":"以色列"},{"name":"印度"},{"name":"印度尼西亚"},{"name":"约旦"},{"name":"越南"}]},{"name":"非洲","sub":[{"name":"阿尔及利亚"},{"name":"埃及"},{"name":"埃塞俄比亚"},{"name":"安哥拉"},{"name":"贝宁"},{"name":"博茨瓦纳"},{"name":"布基纳法索"},{"name":"布隆迪"},{"name":"赤道几内亚"},{"name":"多哥"},{"name":"厄立特里亚"},{"name":"法罗群岛"},{"name":"加那利群岛（西）（拉斯帕尔马斯）"},{"name":"加那利群岛（西）（圣克鲁斯）"},{"name":"佛得角"},{"name":"冈比亚"},{"name":"刚果(布)"},{"name":"刚果(金)"},{"name":"吉布提"},{"name":"几内亚"},{"name":"几内亚比绍"},{"name":"加纳"},{"name":"加蓬"},{"name":"津巴布韦"},{"name":"喀麦隆"},{"name":"科摩罗"},{"name":"科特迪瓦"},{"name":"肯尼亚"},{"name":"莱索托"},{"name":"利比里亚"},{"name":"利比亚"},{"name":"卢旺达"},{"name":"马达加斯加"},{"name":"马里"},{"name":"马拉维"},{"name":"毛里求斯"},{"name":"毛里塔尼亚"},{"name":"摩洛哥"},{"name":"莫桑比克"},{"name":"纳米比亚"},{"name":"迪戈加西亚"},{"name":"南非"},{"name":"南苏丹"},{"name":"尼日尔"},{"name":"尼日利亚"},{"name":"留尼旺岛"},{"name":"塞拉利昂"},{"name":"塞舌尔"},{"name":"塞内加尔"},{"name":"圣多美和普林西比"},{"name":"桑给巴尔"},{"name":"马约特岛"},{"name":"斯威士兰"},{"name":"苏丹"},{"name":"索马里"},{"name":"坦桑尼亚"},{"name":"圣赤勒拿"},{"name":"突尼斯"},{"name":"乌干达"},{"name":"赞比亚"},{"name":"乍得"},{"name":"中非"}]},{"name":"欧洲","sub":[{"name":"阿尔巴尼亚"},{"name":"爱尔兰"},{"name":"芬兰"},{"name":"荷兰"},{"name":"爱沙尼亚"},{"name":"安道尔"},{"name":"奥地利"},{"name":"白俄罗斯"},{"name":"保加利亚"},{"name":"比利时"},{"name":"冰岛"},{"name":"波黑"},{"name":"波兰"},{"name":"丹麦"},{"name":"德国"},{"name":"俄罗斯"},{"name":"法国"},{"name":"梵蒂冈"},{"name":"黑山"},{"name":"捷克"},{"name":"克罗地亚"},{"name":"拉脱维亚"},{"name":"立陶宛"},{"name":"列支敦士登"},{"name":"卢森堡"},{"name":"罗马尼亚"},{"name":"马耳他"},{"name":"马其顿"},{"name":"摩尔多瓦"},{"name":"阿塞拜疆"},{"name":"摩纳哥"},{"name":"挪威"},{"name":"欧盟"},{"name":"葡萄牙"},{"name":"瑞典"},{"name":"瑞士"},{"name":"塞尔维亚"},{"name":"塞浦路斯"},{"name":"圣马力诺"},{"name":"斯洛伐克"},{"name":"斯洛文尼亚"},{"name":"乌克兰"},{"name":"西班牙"},{"name":"希腊"},{"name":"匈牙利"},{"name":"意大利"},{"name":"直布罗陀（英）"},{"name":"英国"}]},{"name":"北美洲","sub":[{"name":"安提瓜和巴布达"},{"name":"安圭拉岛"},{"name":"巴巴多斯"},{"name":"巴哈马"},{"name":"巴拿马"},{"name":"伯利兹"},{"name":"多米尼加"},{"name":"多米尼克"},{"name":"哥斯达黎加"},{"name":"格林纳达"},{"name":"古巴"},{"name":"海地"},{"name":"洪都拉斯"},{"name":"加拿大"},{"name":"美国"},{"name":"美属维尔京群岛"},{"name":"墨西哥"},{"name":"尼加拉瓜"},{"name":"萨尔瓦多"},{"name":"圣基茨和尼维斯"},{"name":"圣卢西亚"},{"name":"阿鲁巴岛"},{"name":"圣文森特和格林纳丁斯"},{"name":"英属维尔京群岛"},{"name":"蒙特塞拉特岛"},{"name":"圣克里斯托弗和尼维斯"},{"name":"特立尼达和多巴哥"},{"name":"马提尼克（法）"},{"name":"危地马拉"},{"name":"牙买加"}]},{"name":"南美洲","sub":[{"name":"阿根廷"},{"name":"巴拉圭"},{"name":"巴西"},{"name":"玻利维亚"},{"name":"厄瓜多尔"},{"name":"哥伦比亚"},{"name":"圭亚那"},{"name":"秘鲁"},{"name":"苏里南"},{"name":"委内瑞拉"},{"name":"法属圭亚那"},{"name":"乌拉圭"},{"name":"智利"}]},{"name":"大洋洲","sub":[{"name":"澳大利亚"},{"name":"巴布亚新几内亚"},{"name":"对诞岛"},{"name":"法属波利尼西亚"},{"name":"斐济"},{"name":"关岛"},{"name":"基里巴斯"},{"name":"科科斯岛"},{"name":"科克群岛"},{"name":"库克群岛"},{"name":"马里亚纳群岛"},{"name":"马绍尔群岛"},{"name":"密克罗尼西亚"},{"name":"瑙鲁"},{"name":"纽埃"},{"name":"诺福克岛"},{"name":"帕劳"},{"name":"东萨摩亚"},{"name":"西萨摩亚"},{"name":"所罗门群岛"},{"name":"汤加"},{"name":"图瓦卢"},{"name":"托克鲁"},{"name":"瓦里斯和富士那群岛"},{"name":"瓦努阿图"},{"name":"夏威夷"},{"name":"威克岛"},{"name":"新喀里多尼亚"},{"name":"新西兰"},{"name":"中途岛"}]}]}];function pt_nps_score(qid){this.mb=$("#"+qid);this.obj={};this.event=function(){var _this=this;$(".nps_grade_text .div_float",_this.mb).off().on({click:function(){_this.select($(this));}});};this.select=function(obj){var Parent=obj.parents('.nps_grade_text');var dx=$(".div_float",Parent);var m=dx.index(obj);Parent.parent().parent().find('.score').text(obj.text());dx.removeClass('back_n');obj.addClass('back_n');};return this.event();}function validate_answer_qNpsScore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var qtip=$("#tip_"+qmodel.qid);var valid=true;var score=qdiv.find(".back_n").length;if(score=="")if("allow_null" in qmodel.question.custom_attr){}else valid=false;if(isNaN(score))valid=false;if(!valid){qtip.text("请为选项打分");scroll_to(qdiv);}else qtip.text("");return valid;}function get_answer_qNpsScore(qmodel){var qid="question_"+qmodel.qid;var qdiv=$("#"+qid);var answer={};qdiv.find(".data_row .score").each(function(){var score=$(this).text();var option_answer=[];var option_id=this.id.replace("option_","");option_answer.push(score);answer[option_id]=option_answer;});return answer;}function bind_event_qNpsScore(qmodel){new pt_nps_score("question_"+qmodel.qid);}function show_luck_draw_ad(selector,rid,adc_time,adc_sign,member_type){var apiUrl="https://dc.wenjuan.com/api";var domainSuffix='';if(site_rspd_url.indexOf('wenjuan.in')!=-1)domainSuffix='in';else domainSuffix='net';var luck_draw_ad_url=apiUrl+"/display/?rid="+rid+"&short_id="+project.short_id+"&channel=wenjuan&source="+domainSuffix+"&adc_time="+adc_time+"&adc_sign="+adc_sign+"&member_type="+member_type;var re=/\?adc_project_id=(\w+)($|&)/;var adc_project_id='';if((x=re.exec(location.search))!=null){adc_project_id=x[1];luck_draw_ad_url+="&project_id="+adc_project_id;}$.ajax({url:luck_draw_ad_url,type:'GET',dataType:'JSONP',jsonp:"callback",jsonpCallback:"success_jsonpCallback",success:function(data){var formatData=(data.replaceAll("'",'"')).replaceAll(': u"',': "');var dataObj=$.parseJSON(formatData);var lottery_data={'prize_ad_name':dataObj.identify,'prize_title':dataObj.award_title,'prize_desc':dataObj.award_sub_head,'prize_url':dataObj.landing_page,'picked':dataObj.picked,'id':dataObj.id,'rid':rid,'apiUrl':apiUrl};_hmt.push(['_trackEvent','/s/luck_draw_ad_'+lottery_data.prize_ad_name,'click','btn-luck-draw']);var lottery_item='<span class="lottery-price"><em>'+dataObj.award_price+'</em>'+dataObj.award_unit+'</span><span class="lottery-text">'+dataObj.award_name+'</span>';$(selector).html('');$(selector).append(get_lottery_html(domainSuffix));var $wj_luck_draw=$(selector);$wj_luck_draw.find('.lottery-item2 label').html(lottery_item);if(dataObj.second_award_name){var lottery_item3='<span class="lottery-price"><em>'+dataObj.second_award_price+'</em>'+dataObj.second_award_unit+'</span><span class="lottery-text">'+dataObj.second_award_name+'</span>';$wj_luck_draw.find('.lottery-item3 label').html(lottery_item3);}$wj_luck_draw.show();_hmt.push(['_trackPageview',"/s/luck_draw_ad_"+lottery_data.prize_ad_name]);$wj_luck_draw.lottery({selector:selector,width:3,height:3,beforeRoll:function(){this.find('.btn-luck-draw').addClass('btn-disabled');$.ajax({url:lottery_data.apiUrl+"/count/?project_id="+lottery_data.id+"&action=draw&rid="+lottery_data.rid+"&short_id="+project.short_id,type:'GET',dataType:'JSONP',jsonp:"callback",jsonpCallback:"success_jsonpCallback",success:function(data){}});},aim:function(){if(lottery_data.picked===1)return 2;else return 0;},afterStop:function(){if(this.options.target==2)luck_draw_result(lottery_data);else luck_draw_result({'prize_ad_name':'谢谢参与','prize_title':'非常抱歉，没有中奖！','prize_desc':'感谢您的参与！'});this.find('a.btn-luck-draw').click(function(){loadMack({off:'on',Limg:0,text:'不能重复参与抽奖',set:1500});});return false;}});}});}function luck_draw_result(option){var result_tit=option.prize_title?'</span>'+option.prize_title:'';var result_desc=option.prize_desc?'<p>'+option.prize_desc+'</p>':'';var result_url=option.prize_url?'<a class="btn-receive-prize">立即领取</a></div>':'';var content='<div class="wj_luck_draw_result"><img src="/static/images/envelope_draw/envelope_draw_sun.png" width="102" /><h3>'+result_tit+'！</h3>'+result_desc+result_url+'</div>';var contentW=650;if(option.prize_ad_name=='谢谢参与'){content='<div class="wj_luck_draw_result no_winning"><img src="/static/images/plugin_center/ml.png" width="102" /><h3>'+result_tit+'</h3>'+result_desc+'</div>';contentW=450;}var luck_draw_popup=new jsbox({onlyid:'wj_luck_draw_result',title:'抽奖结果',content:content,conw:contentW,mack:true}).show();if(option.prize_url)$('.btn-receive-prize').click(function(){$.ajax({url:option.apiUrl+"/count/?project_id="+option.id+"&action=picked&rid="+option.rid+"&short_id="+project.short_id,type:'GET',dataType:'JSONP',jsonp:"callback",jsonpCallback:"success_jsonpCallback",success:function(data){}});_hmt.push(['_trackEvent','/s/luck_draw_ad_'+option.prize_ad_name,'click','btn-receive-prize']);window.open(option.prize_url);});$('.btn_close_result').click(function(){$('.wj_luck_draw_result_bg,#wj_luck_draw_result').remove();});}function get_lottery_html(domainSuffix){var lottery_html='<div class="luck_draw_tit">恭喜您获得1次抽奖机会！</div>'+'<table class="lottery-table" cellpadding="0" cellspacing="0" border="0">'+'<tr class="lottery-group">'+'<td class="lottery-unit"><div class="lottey-item"><label class="thanks">谢谢参与</label></div></td>'+'<td class="lottery-unit"><div class="lottey-item lottery-item2"><label></label></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label class="thanks">谢谢参与</label></div></td>'+'</tr>'+'<tr class="lottery-group">'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>50</em>元</span><span class="lottery-text">京东卡</span></label></div></td>'+'<td class="lottery-unit"><div class="lottey-item lottey-btn"><a href="javascript:;" class="btn-luck-draw"><label>立即<br/>抽奖</label></a></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>50</em>M</span><span class="lottery-text">流量包</span></label></div></td>'+'</tr>'+'<tr class="lottery-group">'+'<td class="lottery-unit"><div class="lottey-item"><label class="thanks">谢谢参与</label></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>10</em>元</span><span class="lottery-text">话费包</span></label></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label class="thanks">谢谢参与</label></div></td>'+'</tr>'+'</table>';var lottery_html_money='<div class="luck_draw_tit">恭喜您获得1次抽奖机会！</div>'+'<table class="lottery-table" cellpadding="0" cellspacing="0" border="0">'+'<tr class="lottery-group">'+'<td class="lottery-unit"><div class="lottey-item"><label class="thanks">谢谢参与</label></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>2</em>元</span><span class="lottery-text">微信红包</span></label></div></td>'+'<td class="lottery-unit"><div class="lottey-item lottery-item2"><label></label></div></td>'+'</tr>'+'<tr class="lottery-group">'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>5</em>元</span><span class="lottery-text">微信红包</span></label></div></td>'+'<td class="lottery-unit"><div class="lottey-item lottey-btn"><a href="javascript:;" class="btn-luck-draw"><label>立即<br/>抽奖</label></a></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>10</em>元</span><span class="lottery-text">微信红包</span></label></div></td>'+'</tr>'+'<tr class="lottery-group">'+'<td class="lottery-unit"><div class="lottey-item lottery-item3"><label class="thanks">谢谢参与</label></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label><span class="lottery-price"><em>1</em>元</span><span class="lottery-text">微信红包</span></label></div></td>'+'<td class="lottery-unit"><div class="lottey-item"><label class="thanks">谢谢参与</label></div></td>'+'</tr>'+'</table>';if(domainSuffix=='in')return lottery_html_money;else return lottery_html;}function getData(){_hmt.push(['_trackEvent','/s/luck_draw_ad_'+new_content.prize_ad_name,'click','btn-receive-prize']);}function luck_draw_flow_distribution(option){var luckDrawAdOption={selector:'#wj_luck_draw',short_id:typeof project=="object"?project.short_id:'',platform:'pc',position:''};$.extend(luckDrawAdOption,option);try{var urlParamObj={'project_bottom_close':'&c=87','not_draw_envelope':'&c=88','project_paused':'&c=108','project_delete':'&c=108','project_finished':'&c=108','answer_repeat':'&c=108','answer_repeat_ip':'&c=108','project_email_answer_only':'&c=108','project_limit_word':'&c=108','answer_finish_filter':'&c=108'};var urlParam=urlParamObj[luckDrawAdOption.position]||'&c=1';var luckDrawAdUrl='https://d1.wenjuan.link/s?z=wenjuan'+urlParam+'&op=1&_sp=3&_site=1&_wj_ad_position='+luckDrawAdOption.position;var $wjLuckDraw=$(luckDrawAdOption.selector);$wjLuckDraw.show().html('<iframe id="wj_luck_draw_iframe" src="'+luckDrawAdUrl+'&_title='+encodeURI(document.title)+'&_wj_short_id='+luckDrawAdOption.short_id+'" frameborder="0" scrolling="no" width="800" height="425" style="margin: 0 -66px;"></iframe>');var wj_luck_draw_iframe=document.getElementById('wj_luck_draw_iframe');wj_luck_draw_iframe.height=window.frames.wj_luck_draw_iframe.contentDocument.body.clientHeight;}catch(e){console.log('luck_draw_ad',e);}}(function($){var defaults={width:4,height:4,initSpeed:300,speed:0,upStep:50,upMax:50,downStep:30,downMax:300,waiting:1000,index:7,target:7};var methods={init:function(options){this.options=$.extend(true,defaults,options);this.index=this.options.index;this.options.speed=this.options.initSpeed;this.count=this.options.width*this.options.height-(this.options.width-2)*(this.options.height-2);for(var i=0;i<this.options.width;++i)this.find('.lottery-group:first .lottery-unit:eq('+i+')').attr('lottery-unit-index',i);for(var i=this.count-this.options.height+1,j=0,len=this.options.width+this.options.height-2;i>=len;--i,++j)this.find('.lottery-group:last .lottery-unit:eq('+j+')').attr('lottery-unit-index',i);for(var i=1,len=this.options.height-2;i<=len;++i){this.find('.lottery-group:eq('+i+') .lottery-unit:first').attr('lottery-unit-index',this.count-i);this.find('.lottery-group:eq('+i+') .lottery-unit:last').attr('lottery-unit-index',this.options.width+i-1);}methods.enable.call(this);},roll:function(){var $this=this;$this.find('[lottery-unit-index='+$this.index+']').removeClass("active");$this.index=++$this.options.index%$this.count;$this.find('[lottery-unit-index='+$this.index+'].lottery-unit').addClass("active");$this.rollerTimer=setTimeout(function(){methods.roll.call($this);},$this.options.speed);if(!$this.isRunning){methods.up.call($this);$this.isRunning=true;}},up:function(){var $this=this;if($this.options.speed<=$this.options.upMax)methods.constant.call($this);else{$this.options.speed-=$this.options.upStep;$this.upTimer=setTimeout(function(){methods.up.call($this);},$this.options.speed);}},constant:function(){var $this=this;clearTimeout($this.upTimer);setTimeout(function(){handlers.beforeDown.call($this);},$this.options.waiting);},down:function(){var $this=this;if($this.options.speed>$this.options.downMax&&$this.options.target==$this.index)methods.stop.call($this);else{$this.options.speed+=$this.options.downStep;$this.downTimer=setTimeout(function(){methods.down.call($this);},$this.options.speed);}},stop:function(){clearTimeout(this.downTimer);clearTimeout(this.rollerTimer);this.options.speed=this.options.initSpeed;this.isRunning=false;handlers.afterStop.call(this);},enable:function(){var $this=this;$this.find('a').one('click',function(){handlers.beforeRoll.call($this);});}};var handlers={beforeRoll:function(){if(this.options.beforeRoll)this.options.beforeRoll.call(this);methods.roll.call(this);},beforeDown:function(){handlers.aim.call(this);if(this.options.beforeDown)this.options.beforeDown.call(this);methods.down.call(this);},afterStop:function(){var targetElement=this.find('[lottery-unit-index='+this.options.target+']');if(this.options.afterStop)if(!this.options.afterStop.call(this,targetElement[0]))return;methods.enable.call(this);},aim:function(){var $this=this;if(this.options.aim)this.options.target=this.options.aim.call(this);else this.options.target=parseInt(parseInt(Math.random()*10)*this.count/10);}};$.fn.lottery=function(options){methods.init.call(this,options);};})(jQuery);